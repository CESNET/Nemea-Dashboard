function config(e,t,o,n){e.when("/login",{controller:"loginController",templateUrl:"views/login.html"}).when("/",{controller:"homeController",templateUrl:"views/home.html"}).when("/user",{controller:"userController",templateUrl:"views/login.html"}).when("/events",{controller:"eventsController",templateUrl:"views/events.html",reloadOnSearch:!1}).when("/events/:id",{controller:"eventController",templateUrl:"views/event.html"}).when("/settings/profile",{controller:"profileController",templateUrl:"views/profile.html"}).when("/settings/users",{controller:"usersController",templateUrl:"views/users.html"}).otherwise({redirectTo:"/login"}),t.theme("default").primaryPalette("light-blue").accentPalette("orange"),t.theme("success-toast"),t.theme("error-toast"),o.interceptors.push("notAllowedInterceptor"),n.setKeyPrefix("nd-")}config.$inject=["$routeProvider","$mdThemingProvider","$httpProvider","$localStorageProvider"];var app=angular.module("gui",["ngMaterial","ngRoute","ngMessages","nvd3","ngStorage","ngMap","gridster"]);app.config(config),app.filter("nospace",function(){return function(e){return e?e.replace(/ /g,""):""}}),app.run(["user","$localStorage","$location","$rootScope","$log",function(e,t,o,n,r){n.$on("$locationChangeStart",function(e){void 0==t.token&&(r.info("no token found, redirecting to /login"),o.path("/login"))})}]),app.factory("notAllowedInterceptor",["$log","$localStorage","$location","$injector","$q",function(e,t,o,n,r){var i={responseError:function(n){return 401==n.status&&(e.error("You are not allowed to access, redirecting to /login"),delete t.token,o.path("/login")),r.reject(n)}};return i}]),app.constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}),app.constant("CATEGORIES",["any","Recon.Scanning","Attempt.Login","Availability.DoS","Availibility.DDoS"]),app.constant("PROTOCOLS",["tcp","dns","udp"]),app.constant("TYPES",["barchart","piechart","top","sum"]),app.constant("PIECHART",{options:{chart:{type:"pieChart",height:375,x:function(e){return e.key[0]},y:function(e){return e.x},showLabels:!0,donut:!0,padAngle:0,cornerRadius:1,transitionDuration:500,labelThreshold:0,legend:{margin:{top:5,right:0,bottom:-15,left:0}},legendPosition:"top",tooltipContent:function(e,t,o,n,r){return console.log(e),console.log(o),console.log(n),console.log(r),"Olalala!"},pie:{dispatch:{elementClick:function(e){var t=new Date;console.log(e),t.setTime(t.getTime()-864e5),t.setHours(0),t.setMinutes(0),window.location="#/events?filter&date="+t.getTime()+"&from="+(new Date).getHours()+":"+(new Date).getMinutes()+"&category="+e.data.key[0]}},labelType:"percent",labelsOutside:!1}}}}),app.value("AREA",{options:{chart:{type:"multiBarChart",height:450,margin:{top:30,right:20,bottom:100,left:65},x:function(e){return e.x},y:function(e){return Number(e.Count)},useVoronoi:!1,clipEdge:!0,duration:100,useInteractiveGuideline:!1,tooltipContent:function(e,t,o,n,r){return"Ha"},xAxis:{showMaxMin:!1,tickFormat:function(e){return d3.time.format("%m/%d %H:%M")(new Date(e))},rotateLabels:-45},yAxis:{showMaxMin:!1,tickFormat:function(e){return d3.format("s")(e)},axisLabel:"Events Count",axisLabelDistance:-20},multibar:{dispatch:{elementClick:function(e){var t=new Date(e.data.x);console.log(e);var o=t.getHours(),n=t.getMinutes();t.setHours(0),t.setMinutes(0),window.location="#/events?filter&date="+t.getTime()+"&from="+("0"+o).slice(-2)+":"+("0"+n).slice(-2)+"&category="+e.data.key+"&dir=1"}}}}}}),app.constant("MENU",[{title:"Events",link:"#/events"},{title:"Settings",items:[{title:"My profile",link:"#/settings/profile"},{title:"Users",link:"#/settings/users"}]}]),app.controller("eventController",["$scope","$routeParams","$http","api",function(e,t,o,n){e.id=t,e.showPlain=!0,e.geo=[],e.back=function(){window.history.back()},n.get("id/"+t.id).success(function(t){e.data=t,void 0!=e.data.Source&&void 0!=e.data.Target&&e.data.Source[0].IP4&&e.data.Target[0].IP4?(o.get("http://freegeoip.net/json/"+e.data.Target[0].IP4[0]).success(function(t){t.type="Target",e.geo.push(t)}),o.get("http://freegeoip.net/json/"+e.data.Source[0].IP4[0]).success(function(t){t.type="Source",e.geo.push(t)})):void 0==e.data.Source||void 0==e.data.Source[0].IP4?o.get("http://freegeoip.net/json/"+e.data.Target[0].IP4[0]).success(function(t){t.type="Target",e.geo.push(t)}):o.get("http://freegeoip.net/json/"+e.data.Source[0].IP4[0]).success(function(t){t.type="Source",e.geo.push(t)})})}]),app.controller("eventsController",["$scope","$http","$location","api","$route",function(e,t,o,n,r){if(e.filter={category:"",src_ip:"",trt_ip:"",desc:"",flows_from:"",flows_to:"",items:100},e.query={from:"12:00",to:"",date:new Date,description:"",category:"",orderby:"DetectTime",dir:-1,dir_raw:!0,limit:100,srcip:"",dstip:""},e.orderBy=["DetectTime","Category","Description","FlowCount"],e.searchText="",e.data=[],e.loadbtn="Load",e.nextButton="Load next 100 items",e.activeFilter=o.search().filter,e.dirVal="Descending",e.reset=function(){o.search({}),r.reload()},e.getQuery=function(t,o){console.log(t);var n=new Date;n.setDate(n.getDate()-7);var r="0"+n.getMinutes(),i="0"+n.getHours(),a={from:i.substr(-2)+":"+r.substr(-2),date:n,limit:100,orderby:"DetectTime",dir:1};"src"==o?a.srcip=t:a.dstip=t,e.loadItems(a)},e.switchDir=function(t){t==-1||t||void 0==t?(e.dirVal="Descending",e.query.dir=-1):(e.dirVal="Ascending",e.query.dir=1)},e.loadNext=function(t){if(e.nextButton="Loading...",o.search().filter){var r=angular.copy(e.query);if(r.from=new Date(t),r.dir=1,r.to){var i=r.to.split(":"),a=new Date(r.date);a.setHours(a.getHours()+i[0]),a.setMinutes(i[1])}else var a=null;r.to=a,n.get("query",r,!0).success(function(t){e.remaining=t.pop();for(item in t)e.data.push(t[item]);e.nextButton="Load next 100 items"}).error(function(t,o){e.nextButton="Load next 100 items"})}else r={to:new Date(t),dir:-1},n.get("query",r,!0).success(function(t){e.remaining=t.pop();for(item in t)e.data.push(t[item]);e.nextButton="Load next 100 items"}).error(function(t,o){e.nextButton="Load next 100 items"})},e.loadItems=function(t){e.loadbtn="Loading...";var r=t.from.split(":"),i=new Date(t.date);i.setHours(r[0]),i.setMinutes(r[1]);var a=angular.copy(t.date);if(o.search("filter",!0),o.search("from",t.from),o.search("date",a.getTime()),o.search("limit",t.limit),o.search("orderby",t.orderby),o.search("dir",t.dir),t.to){var s=t.to.split(":"),c=new Date(t.date);c.setHours(s[0]),c.setMinutes(s[1]),o.search("to",t.to)}else var c=null;""!=t.description?o.search("description",t.description):t.description=null,""!=t.category?o.search("category",t.category):t.category=null,""!=t.srcip?o.search("srcip",t.srcip):(o.search("srcip",null),t.srcip=null),""!=t.dstip?o.search("dstip",t.dstip):(o.search("dstip",null),t.dstip=null);var l={from:i,to:c,category:t.category,description:t.description,limit:t.limit,orderby:t.orderby,dir:t.dir,srcip:t.srcip,dstip:t.dstip};n.get("query",l,!0).success(function(t){e.remaining=t.pop(),e.data=t,e.loadbtn="Load"}).error(function(){e.loadbtn="Load"})},e.events=function(t){var o=[];""!=e.filter.src_ip&&("Source"in t&&"IP4"in t.Source[0]&&t.Source[0].IP4[0].toLowerCase().indexOf(e.filter.src_ip.toLowerCase())>-1?o.push(1):o.push(0)),""!=e.filter.trt_ip&&("Target"in t&&"IP4"in t.Target[0]&&t.Target[0].IP4[0].toLowerCase().indexOf(e.filter.trt_ip.toLowerCase())>-1?o.push(1):o.push(0)),""!=e.filter.category&&(t.Category[0].toLowerCase().indexOf(e.filter.category.toLowerCase())>-1?o.push(1):o.push(0)),""!=e.filter.desc&&(t.Description.toLowerCase().indexOf(e.filter.desc.toLowerCase())>-1?o.push(1):o.push(0)),""!=e.filter.flows_from&&(t.FlowCount>Number(e.filter.flows_from)?o.push(1):o.push(0)),""!=e.filter.flows_to&&(t.FlowCount<Number(e.filter.flows_to)?o.push(1):o.push(0));for(var n=1,r=0;r<o.length;r++)n*=o[r];return 1==n},o.search().filter){e.switchDir(o.search().dir);var i=angular.copy(o.search());i.date=new Date(Number(i.date)),e.query=i,e.loadItems(e.query)}else n.get("100").success(function(t){e.data=t})}]),app.directive("validateHours",function(){var e=[],t=[];return{require:"ngModel",link:function(o,n,r,i){i.$validators.time=function(o,n){return"query.from"==r.ngModel&&n?t=n.split(":"):n&&(e=n.split(":")),2!=e.length&&2!=t.length||!(e[0]<t[0]||e[0]<=t[0]&&e[1]<t[1]||e[0]<0||e[0]>23||e[1]<0||e[1]>59||t[0]<0||t[0]>23||t[1]<0||t[1]>59)}}}}),app.controller("homeController",["$scope","user","$timeout","$interval","$log","$localStorage","$route","$mdDialog","dashboard",function(e,t,o,n,r,i,a,s,c){e.dashboards=c.getAll(),e.dashboardSettings=c.settings(),e.activeGrid=!1,e.refresh_interval=e.dashboardSettings.interval;var l=void 0;e.refresh_enabled=angular.isDefined(l),e.openMenu=function(e,t){originatorEv=t,e(t)},e.addItem=function(){e.$broadcast("addItem")},e.enableGrid=function(){console.log("Enable grid"),e.$broadcast("enableGrid"),e.activeGrid=!e.activeGrid},e.$on("requestRedraw",function(e){e.stopPropagation(),o(function(){window.dispatchEvent(new Event("resize"))},100)}),e.clearCache=function(){r.debug("deleting timestamp"),delete i.timestamp,a.reload()},e.setInterval=function(){angular.isDefined(l)?(n.cancel(l),l=void 0,console.log("broadcast failed")):l=n(function(){console.log("broadcast"),e.$broadcast("refreshData")},1e3*e.refresh_interval),e.refresh_enabled=angular.isDefined(l)},e.selectedDashboard=c.active(),e.editDashboard=function(t,o){e.backupDashboards=angular.copy(e.dashboards),s.show({controller:"editDashboardController",templateUrl:"partials/addDashboard.html",parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0,fullscreen:!0}).then(function(t){c.save(),e.refresh_interval=e.dashboardSettings.interval},function(){e.dashboards=e.backupDashboards,console.log(e.backupDashboards),e.backupDashboards={},console.log("reverting")})},e.$on("switchDashboard",function(t,o){delete i.timestamp,c["switch"](o),e.selectedDashboard=c.active(),e.$broadcast("reloadDashboard")})}]),app.controller("box",["$scope","$log","$mdDialog","PROTOCOLS","TYPES","CATEGORIES","PIECHART","AREA","api","user","$mdMedia","$localStorage","$timeout","dashboard",function(e,t,o,n,r,i,a,s,c,l,u,d,p,h){function g(t){t=angular.isDefined(t)?t:0,e.box.config.begintime=function(){var o=new Date,n=60*(Number(t)+Number(e.box.config.period))*60*1e3,r=o.getTime()-n;return Math.floor(r/1e3)}(),e.box.config.endtime=function(){var e=new Date;return e.setTime(e.getTime()-60*Number(t)*60*1e3),Math.floor(e/1e3)}()}function f(){if(g(e.dashboard.settings.timeshift),"piechart"==e.box.type||"barchart"==e.box.type){if("piechart"==e.box.type&&(e.box.options=a.options),"barchart"==e.box.type&&(e.box.options=angular.copy(s.options),e.box.selector?(e.box.options.chart.yAxis.axisLabel="Flow Count",e.box.options.chart.y=function(e){return Number(e.FlowCount)}):e.box.options.chart.yAxis.axisLabel="Events Count"),e.box.config.type=e.box.type,m>300){var t=angular.copy(e.box.config);"custom"==e.box.config.metric&&(t.metric=t.custom_metric);for(item in t)""==t[item]&&(t[item]=null);c.get("agg",t,!1,!0).success(function(t){e.box.loading=!1,e.box.data=t,e.$emit("requestRedraw")})}}else"top"==e.box.type&&m>300?c.get("top",e.box.config,!1,!0).success(function(t){e.box.loading=!1,e.box.data=t}):"sum"==e.box.type&&m>300&&c.get("count",e.box.config,!1,!0).success(function(t){e.box.loading=!1,e.box.data=t})}g(e.dashboard.settings.timeshift),e.box.loading=!0,e.openMenu=function(e,t){originatorEv=t,e(t)},e.backupModel={},e.protocol=n,e.types=r,e.categories=i,e.edit=function(t){e.editMode=!0,e.backupModel=angular.copy(t)},e.save=function(){h.save(),e.backupModel={},e.box.config.type=e.box.type,e.editMode=!1,m=310,f()},e.cancel=function(t){e.box=angular.copy(e.backupModel),e.backupModel={}},e.top=function(){g(e.box.settings.timeshift),c.get("top",e.box.config,!0).success(function(t){console.log(t),e.box.data=t})};var m=(new Date-new Date(d.timestamp))/1e3;isNaN(m)&&(m=310),m<300?e.box.loading=!1:e.box.loading=!0,e.$on("gridster-item-initialized",function(t){"piechart"!=e.box.type&&"barchart"!=e.box.type||p(function(){e.$emit("requestRedraw")},500)}),f(),e.$on("refreshData",function(){m=310,f()}),e.$on("saveUser",function(){h.save()}),e.$on("gridster-item-resized",function(e){p(function(){console.log("request accepted"),window.dispatchEvent(new Event("resize"))},100)}),e.showEdit=function(t,n){e.backupModel=angular.copy(e.box),o.show({controller:"editBoxController",templateUrl:"partials/edit.html",parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0,fullscreen:!0,locals:{box:e.box}}).then(function(t){e.save()},function(){e.box=angular.copy(e.backupModel),e.backupModel={}})}}]),app.controller("grid",["$scope","$timeout","$log","$route","user","dashboard",function(e,t,o,n,r,i){e.opt={outerMargin:!1,columns:8,pushing:!0,rowHeight:170,colWidth:"auto",floating:!0,swapping:!0,mobileBreakPoint:933,draggable:{enabled:!1},resizable:{enabled:!1,handles:["n","e","s","w","se","sw"],stop:function(t,o,n){e.$emit("requestRedraw")}}},e.dashboard=i.get(),e.items=e.dashboard.items,e.$on("enableGrid",function(){1==e.opt.resizable.enabled&&e.$broadcast("saveUser"),e.opt.resizable.enabled=!e.opt.resizable.enabled,e.opt.draggable.enabled=!e.opt.draggable.enabled}),e.remove=function(t){e.items.splice(e.items.indexOf(t),1);e.$broadcast("saveUser")},e.$on("addItem",function(){var t={title:"New box",loading:!1,sizeX:1,sizeY:1,content:"",config:{period:0}};e.items.push(t)}),e.$on("reloadDashboard",function(){e.dashboard=i.get(),e.items=e.dashboard.items,console.log(e.dashboard),e.$emit("requestRedraw")})}]),app.controller("editBoxController",["$scope","$mdDialog","box","PROTOCOLS","TYPES","CATEGORIES",function(e,t,o,n,r,i){e.box=o,e.backupModel=angular.copy(o),e.categories=i,e.protocols=n,e.types=r,e.saveAndClose=function(){t.hide()},e.answer=function(e){t.hide(e)},e.cancel=function(e){console.log("Cancelling"),t.cancel()},e.changeSelector=function(e){}}]),app.controller("addDashboardController",["$scope","$mdDialog","dashboard",function(e,t,o){e.editDashboard=!1,e.saveAndClose=function(e){t.hide(e)},e.cancel=function(e){console.log("Cancelling"),t.cancel()}}]),app.controller("editDashboardController",["$scope","$rootScope","$mdDialog","dashboard",function(e,t,o,n){e.db=n.settings(),e.editDashboard=!0,e.saveAndClose=function(e){n.update(e),o.hide()},e.deleteDashboard=function(){n["delete"](),t.$broadcast("switchDashboard",0),n.save(),o.hide()},e.cancel=function(e){console.log("Cancelling"),o.cancel()}}]),app.controller("loginController",["$scope","$location","$log","user",function(e,t,o,n){e.title="Login to Nemea Dashboard",e.loginBtn="Login",e.submit=function(o){e.loginBtn="Authenticating...",e.loginBtnDisabled=!0,n.auth(o).success(function(e){t.path("/")}).error(function(t){e.error_mes=t,e.loginBtn="Login",e.loginBtnDisabled=!1})};var r=Trianglify({width:window.innerWidth,height:window.innerHeight,x_colors:"GnBu",y_colors:"GnBu",cell_size:50});console.log(r),document.getElementById("login").appendChild(r.canvas())}]),app.controller("profileController",["$scope","$log","$localStorage","user","dashboard",function(e,t,o,n,r){e.user=n.get(),e.save_btn="Save",e.editUser=function(i){e.save_btn="Processing...",i.settings=r.clean(),n.put(i,!0).success(function(t){o.token=t.jwt,e.err_msg="",e.user=angular.copy(n.get()),e.save_btn="Save"}).error(function(o){e.save_btn="Save",console.log(o),t.error(o.error),e.user.password="",e.err_msg=o.error})}}]),app.controller("usersController",["$scope","api","user","$mdDialog",function(e,t,o,n){o.get(!0).success(function(t){e.people=t}),e.myUsername=function(){var e=o.get();return e.username},e.deleteUser=function(t){console.log(t),o["delete"](t).success(function(t){console.log(t),o.get(!0).success(function(t){e.users=t})})},e.addUser=function(t){e.addUserBox=!0,n.show({controller:"addUserController",templateUrl:"partials/addUser.html",parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0,fullscreen:!0}).then(function(t){console.log(t),o.post(t).success(function(t){console.log(t),o.get(!0).success(function(t){e.users=t})})},function(){})}}]),app.controller("addUserController",["$scope","$mdDialog",function(e,t){e.user={username:"",name:"",surname:"",password:"",settings:[{settings:{title:"Basic",timeshift:"0",interval:"60"},items:[{loading:!1,row:0,config:{period:"24",type:"piechart",metric:"category"},sizeX:4,sizeY:3,col:0,title:"24h shares",type:"piechart",content:"Click the menu icon to select edit"}]}]},e.saveAndClose=function(e){console.log(e),t.hide(e)},e.cancel=function(e){console.log("Cancelling"),t.cancel()}}]),app.directive("gridsterDynamicHeight",["$timeout",function(e){function t(e,t,o){e.$watch(function(){return t[0].scrollHeight},function(t,o){var n=270,r=n*e.item.sizeY;if(t>r){var i=Math.floor(t/n);e.item.sizeY=i}})}var o={scope:{item:"="},link:t,restrict:"A"};return o}]),app.service("api",["$http","$log","$mdToast","$localStorage","PIECHART","CONFIG",function(e,t,o,n,r,i){var a=i.host+":"+i.port+"/"+i.version+"/events/";this.auth=function(){return n.token},this.config=function(){e.get("http://benefizio.liberouter.org:5555/config").success(function(e){this.addr=e.host+":"+e.port+e.events,n.config=e,alert(e)})},this.get=function(r,i,s,c){return e({url:a+r,method:"GET",params:i,headers:{Authorization:this.auth()}}).success(function(e){return s&&o.show(o.simple().textContent("Data successully loaded").position("top right").hideDelay(3e3).theme("success-toast")),c&&(n.timestamp=new Date),e}).error(function(){t.error("Cannot fetch data"),o.show(o.simple().textContent("Cannot load data").position("top right").hideDelay(3e3).theme("error-toast"))})},this.post=function(n,r,i){return e.post(a+n,JSON.stringify(r)).success(function(e){return i&&o.show(o.simple().textContent("Data successfully loaded").position("top right").hideDelay(3e3).theme("success-toast")),e}).error(function(){t.error("Cannot fetch data"),o.show(o.simple().textContent("Cannot fetch data").position("top right").hideDelay(3e3).theme("error-toast"))})},this.put=function(n,r,i){return e.put(a+n,JSON.stringify(r)).success(function(e){return i&&o.show(o.simple().textContent("Data successfully loaded").position("top right").hideDelay(3e3).theme("success-toast")),e}).error(function(){t.error("Cannot fetch data"),o.show(o.simple().textContent("Cannot fetch data").position("top right").hideDelay(3e3).theme("error-toast"))})}}]),app.service("dashboard",["$log","$localStorage","user",function(e,t,o){var n,r=0,i=(t.dashboard,t.dashboard[r]);this.getAll=function(){return t.dashboard},this.get=function(){return t.dashboard[r]},this.settings=function(){return t.dashboard[r].settings},this.active=function(e){return angular.isDefined(e)&&(r=e),r},this.update=function(e){angular.isUndefined(e)?i.settings=0:i.settings=e},this.clean=function(){for(var e=angular.copy(t.dashboard),o=0;o<e.length;o++)for(var n=0;n<e[o].items.length;n++)delete e[o].items[n].data,delete e[o].items[n].options;return e},this.save=function(){var t={settings:this.clean()};return o.put(t).success(function(e){}).error(function(t){e.error(t)})},this.add=function(e){var o={settings:e,items:[{title:"New box",loading:!1,sizeX:1,sizeY:1,content:"Click the menu icon to select edit",config:{period:"0"}}]};return t.dashboard.push(o),t.dashboard.length-1},this["delete"]=function(){return n=t.dashboard.splice(t.dashboard.indexOf(i),1),r=0,n},this["switch"]=function(e){return i=t.dashboard[e],r=e,i},this.reset=function(){r=0,i=t.dashboard[r]}}]),app.directive("sidebarMenu",function(){return{scope:{section:"="},templateUrl:"partials/sidebar-menu.html",controller:["$scope","$mdSidenav","$mdDialog","$location","MENU","user","dashboard",function(e,t,o,n,r,i,a){e.menu=r,e.dashboards=a.getAll(),e.selectedDashboard=a.active(),e.isActive=function(e){return"#"+n.path()==e},e.enable=!0,e.toggleItem=function(){e.toggleBtn="toggled"},e.closeLeft=function(){t("left").toggle()},e.logout=function(){a.reset(),i.logout()},e.addDashboard=function(t){console.log("Adding new dashboard"),o.show({controller:"addDashboardController",templateUrl:"partials/addDashboard.html",parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0,fullscreen:!0}).then(function(t){var o=a.add(t);a.save(),e.$emit("switchDashboard",o),e.selectedDashboard=a.active(o)},function(){})},e.switchDashboard=function(t){e.selectedDashboard=a.active(t),e.$emit("switchDashboard",t)},e.$on("switchDashboard",function(){console.log("switching"),e.selectedDashboard=a.active()})}]}}),app.directive("topbarMenu",function(){return{scope:{section:"="},templateUrl:"partials/topbar-menu.html",controller:["$scope","$mdSidenav",function(e,t){e.toggleLeft=function(){t("left").toggle()}}]}}),app.directive("boxes",function(){return{scope:{section:"="},templateUrl:"partials/boxes.html"}}),app.service("user",["$localStorage","$http","$mdToast","$location","$log","CONFIG",function(e,t,o,n,r,i){var a=i.host+":"+i.port+"/"+i.version+"/users/";this.config=function(){return e.dashboard},this.jwt=function(){var t=e.token,o=t.split(".")[1],n=o.replace("-","+").replace("_","/");return JSON.parse(window.atob(n))},this.auth=function(o){return console.log(a),t.post(a+"auth",angular.toJson(o)).success(function(t){e.token=t.jwt,delete e.dashboard,e.dashboard=t.settings}).error(function(e,t){return console.log(e),console.log(t),e})},this.put=function(n,i){return t({url:a,method:"PUT",data:angular.toJson(n),headers:{Authorization:e.token}}).success(function(e){return i&&o.show(o.simple().textContent("User settings updated").position("top right").hideDelay(3e3).theme("success-toast")),e}).error(function(e,t){return r.error("Something went wrong sending user data"),o.show(o.simple().textContent("Something went wrong").position("top right").hideDelay(3e3).theme("error-toast")),console.log(e),e})},this.logout=function(){e.token;return t({url:a+"logout",method:"DELETE",headers:{Authorization:e.token}}).success(function(t){n.path("/login"),delete e.token,delete e.dashboard,delete e.timestamp,o.show(o.simple().textContent("Logout successfull").position("top right").hideDelay(3e3))}).error(function(t,r){n.path("/login"),delete e.token,delete e.dashboard,delete e.timestamp,o.show(o.simple().textContent("Logout failed on server side, but you are logged out").position("top right").hideDelay(3e3))})},this.get=function(n){var r=e.token;return n?t({url:a,method:"GET",headers:{Authorization:r}}).success(function(e){return console.log(e),e}).error(function(e,t){o.show(o.simplet().textContent("Cannot fetch users from database").position("top right").hideDelay(3e3).theme("error-toast"))}):this.jwt()},this.post=function(n){var r=e.token;return t({url:a,method:"POST",data:angular.toJson(n),headers:{Authorization:r}}).success(function(e){return e}).error(function(e,t){o.show(o.simplet().textContent("Cannot create user").position("top right").hideDelay(3e3).theme("error-toast"))})},this["delete"]=function(n){var r=e.token;return console.log(n),t({url:a,method:"DELETE",params:{userId:n},headers:{Authorization:r}}).success(function(e){return e}).error(function(e,t){o.show(o.simplet().textContent("Cannot delete user").position("top right").hideDelay(3e3).theme("error-toast"))})}}]),app.filter("idea",function(){return function(e){var t={};return angular.forEach(e,function(e,o){"_id"!=o&&(e.$date?(console.log(e.$date),t[o]=new Date(e.$date).toISOString().slice(0,19)+"Z"):t[o]=e)}),t}}),app.filter("json2html",["$sce","$filter",function(e,t){return function(o){var n="";return angular.forEach(o,function(e,o){"_id"!=o&&(n+="<div>","object"==typeof e?("number"!=typeof o&&"$date"!=o&&(n=n+"<em>"+o+"</em>: "),n=n+'<div class="sub">'+t("json2html")(e)+"</div>"):("number"!=typeof o&&"$date"!=o&&(n=n+"<em>"+o+"</em>: "),n=e>1e12?n+"<span>"+t("date")(e,"yyyy/MM/dd H:mm:ss")+"</span>":n+"<span>"+e+"</span>"),n+="</div>")}),e.trustAs("html",n)}}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImpzL2FwcC5taW4uanMiLCJjb25zdGFudHMuanMiLCJjb250cm9sbGVycy9ldmVudENvbnRyb2xsZXIuanMiLCJjb250cm9sbGVycy9ldmVudHNDb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvaG9tZUNvbnRyb2xsZXIuanMiLCJjb250cm9sbGVycy9sb2dpbkNvbnRyb2xsZXIuanMiLCJjb250cm9sbGVycy9wcm9maWxlQ29udHJvbGxlci5qcyIsImNvbnRyb2xsZXJzL3VzZXJzQ29udHJvbGxlci5qcyIsImRpcmVjdGl2ZXMvZ3JpZHN0ZXJEeW5hbWljSGVpZ2h0LmpzIiwic2VydmljZXMvYXBpLmpzIiwic2VydmljZXMvZGFzaGJvYXJkLmpzIiwic2VydmljZXMvbWVudS5qcyIsInNlcnZpY2VzL3VzZXIuanMiLCJmaWx0ZXJzL2lkZWEuanMiLCJmaWx0ZXJzL2pzb24yaHRtbC5qcyJdLCJuYW1lcyI6WyJjb25maWciLCIkcm91dGVQcm92aWRlciIsIiRtZFRoZW1pbmdQcm92aWRlciIsIiRodHRwUHJvdmlkZXIiLCIkbG9jYWxTdG9yYWdlUHJvdmlkZXIiLCJ3aGVuIiwiY29udHJvbGxlciIsInRlbXBsYXRlVXJsIiwicmVsb2FkT25TZWFyY2giLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwidGhlbWUiLCJwcmltYXJ5UGFsZXR0ZSIsImFjY2VudFBhbGV0dGUiLCJpbnRlcmNlcHRvcnMiLCJwdXNoIiwic2V0S2V5UHJlZml4IiwiJGluamVjdCIsImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJmaWx0ZXIiLCJ2YWx1ZSIsInJlcGxhY2UiLCJydW4iLCJ1c2VyIiwiJGxvY2FsU3RvcmFnZSIsIiRsb2NhdGlvbiIsIiRyb290U2NvcGUiLCIkbG9nIiwiJG9uIiwiZXZlbnQiLCJ1bmRlZmluZWQiLCJpbmZvIiwicGF0aCIsImZhY3RvcnkiLCIkaW5qZWN0b3IiLCIkcSIsIm5vdEFsbG93ZWRJbnRlcmNlcHRvciIsInJlc3BvbnNlRXJyb3IiLCJyZXNwb25zZSIsInN0YXR1cyIsImVycm9yIiwicmVqZWN0IiwiY29uc3RhbnQiLCJsb2dpblN1Y2Nlc3MiLCJsb2dpbkZhaWxlZCIsImxvZ291dFN1Y2Nlc3MiLCJzZXNzaW9uVGltZW91dCIsIm5vdEF1dGhlbnRpY2F0ZWQiLCJub3RBdXRob3JpemVkIiwib3B0aW9ucyIsImNoYXJ0IiwidHlwZSIsImhlaWdodCIsIngiLCJkIiwia2V5IiwieSIsInNob3dMYWJlbHMiLCJkb251dCIsInBhZEFuZ2xlIiwiY29ybmVyUmFkaXVzIiwidHJhbnNpdGlvbkR1cmF0aW9uIiwibGFiZWxUaHJlc2hvbGQiLCJsZWdlbmQiLCJtYXJnaW4iLCJ0b3AiLCJyaWdodCIsImJvdHRvbSIsImxlZnQiLCJsZWdlbmRQb3NpdGlvbiIsInRvb2x0aXBDb250ZW50IiwiZSIsImdyYXBoIiwiY29uc29sZSIsImxvZyIsInBpZSIsImRpc3BhdGNoIiwiZWxlbWVudENsaWNrIiwiZGF0ZSIsIkRhdGUiLCJzZXRUaW1lIiwiZ2V0VGltZSIsInNldEhvdXJzIiwic2V0TWludXRlcyIsIndpbmRvdyIsImxvY2F0aW9uIiwiZ2V0SG91cnMiLCJnZXRNaW51dGVzIiwiZGF0YSIsImxhYmVsVHlwZSIsImxhYmVsc091dHNpZGUiLCJOdW1iZXIiLCJDb3VudCIsInVzZVZvcm9ub2kiLCJjbGlwRWRnZSIsImR1cmF0aW9uIiwidXNlSW50ZXJhY3RpdmVHdWlkZWxpbmUiLCJ4QXhpcyIsInNob3dNYXhNaW4iLCJ0aWNrRm9ybWF0IiwiZDMiLCJ0aW1lIiwiZm9ybWF0Iiwicm90YXRlTGFiZWxzIiwieUF4aXMiLCJheGlzTGFiZWwiLCJheGlzTGFiZWxEaXN0YW5jZSIsIm11bHRpYmFyIiwiaG91cnMiLCJtaW51dGVzIiwic2xpY2UiLCJ0aXRsZSIsImxpbmsiLCJpdGVtcyIsIiRzY29wZSIsIiRyb3V0ZVBhcmFtcyIsIiRodHRwIiwiYXBpIiwiaWQiLCJzaG93UGxhaW4iLCJnZW8iLCJiYWNrIiwiaGlzdG9yeSIsImdldCIsInN1Y2Nlc3MiLCJTb3VyY2UiLCJUYXJnZXQiLCJJUDQiLCIkcm91dGUiLCJjYXRlZ29yeSIsInNyY19pcCIsInRydF9pcCIsImRlc2MiLCJmbG93c19mcm9tIiwiZmxvd3NfdG8iLCJxdWVyeSIsImZyb20iLCJ0byIsImRlc2NyaXB0aW9uIiwib3JkZXJieSIsImRpciIsImRpcl9yYXciLCJsaW1pdCIsInNyY2lwIiwiZHN0aXAiLCJvcmRlckJ5Iiwic2VhcmNoVGV4dCIsImxvYWRidG4iLCJuZXh0QnV0dG9uIiwiYWN0aXZlRmlsdGVyIiwic2VhcmNoIiwiZGlyVmFsIiwicmVzZXQiLCJyZWxvYWQiLCJnZXRRdWVyeSIsImlwIiwic2V0RGF0ZSIsImdldERhdGUiLCJzdWJzdHIiLCJsb2FkSXRlbXMiLCJzd2l0Y2hEaXIiLCJ2YWwiLCJsb2FkTmV4dCIsImNvcHkiLCJzcGxpdCIsInRvX2RhdGUiLCJyZW1haW5pbmciLCJwb3AiLCJpdGVtIiwiZXJyIiwibXNnIiwiZnJvbV9kYXRlIiwidW5peF9kYXRlIiwic2VuZCIsImV2ZW50cyIsInJlcyIsInRvTG93ZXJDYXNlIiwiaW5kZXhPZiIsIkNhdGVnb3J5IiwiRGVzY3JpcHRpb24iLCJGbG93Q291bnQiLCJsb2dpY3ZhbHVlIiwiaSIsImxlbmd0aCIsInRtcF9xdWVyeSIsImRpcmVjdGl2ZSIsInJlcXVpcmUiLCJzY29wZSIsImVsZW1lbnQiLCJhdHRycyIsImN0cmwiLCIkdmFsaWRhdG9ycyIsIm1vZGVsVmFsdWUiLCJ2aWV3VmFsdWUiLCJuZ01vZGVsIiwiJHRpbWVvdXQiLCIkaW50ZXJ2YWwiLCIkbWREaWFsb2ciLCJkYXNoYm9hcmQiLCJkYXNoYm9hcmRzIiwiZ2V0QWxsIiwiZGFzaGJvYXJkU2V0dGluZ3MiLCJzZXR0aW5ncyIsImFjdGl2ZUdyaWQiLCJyZWZyZXNoX2ludGVydmFsIiwiaW50ZXJ2YWwiLCJyZWZyZXNoIiwicmVmcmVzaF9lbmFibGVkIiwiaXNEZWZpbmVkIiwib3Blbk1lbnUiLCIkbWRPcGVuTWVudSIsImV2Iiwib3JpZ2luYXRvckV2IiwiYWRkSXRlbSIsIiRicm9hZGNhc3QiLCJlbmFibGVHcmlkIiwic3RvcFByb3BhZ2F0aW9uIiwiZGlzcGF0Y2hFdmVudCIsIkV2ZW50IiwiY2xlYXJDYWNoZSIsImRlYnVnIiwic2V0SW50ZXJ2YWwiLCJjYW5jZWwiLCJzZWxlY3RlZERhc2hib2FyZCIsImFjdGl2ZSIsImVkaXREYXNoYm9hcmQiLCJpbmRleCIsImJhY2t1cERhc2hib2FyZHMiLCJzaG93IiwicGFyZW50IiwiZG9jdW1lbnQiLCJib2R5IiwidGFyZ2V0RXZlbnQiLCJjbGlja091dHNpZGVUb0Nsb3NlIiwiZnVsbHNjcmVlbiIsInRoZW4iLCJhbnN3ZXIiLCJzYXZlIiwiUFJPVE9DT0xTIiwiVFlQRVMiLCJDQVRFR09SSUVTIiwiUElFQ0hBUlQiLCJBUkVBIiwiJG1kTWVkaWEiLCJ0aW1lU2hpZnQiLCJvZmZzZXQiLCJib3giLCJiZWdpbnRpbWUiLCJub3ciLCJzaGlmdF90aW1lIiwicGVyaW9kIiwic2hpZnRlZCIsIk1hdGgiLCJmbG9vciIsImVuZHRpbWUiLCJnZXREYXRhIiwidGltZXNoaWZ0Iiwic2VsZWN0b3IiLCJjYWNoZV90aW1lIiwibWV0cmljIiwiY3VzdG9tX21ldHJpYyIsImxvYWRpbmciLCIkZW1pdCIsImJhY2t1cE1vZGVsIiwicHJvdG9jb2wiLCJ0eXBlcyIsImNhdGVnb3JpZXMiLCJlZGl0IiwiZWRpdE1vZGUiLCJpc05hTiIsImdyaWRzdGVyIiwic2hvd0VkaXQiLCJsb2NhbHMiLCJvcHQiLCJvdXRlck1hcmdpbiIsImNvbHVtbnMiLCJwdXNoaW5nIiwicm93SGVpZ2h0IiwiY29sV2lkdGgiLCJmbG9hdGluZyIsInN3YXBwaW5nIiwibW9iaWxlQnJlYWtQb2ludCIsImRyYWdnYWJsZSIsImVuYWJsZWQiLCJyZXNpemFibGUiLCJoYW5kbGVzIiwic3RvcCIsIiRlbGVtZW50Iiwid2lkZ2V0IiwicmVtb3ZlIiwic3BsaWNlIiwic2l6ZVgiLCJzaXplWSIsImNvbnRlbnQiLCJwcm90b2NvbHMiLCJzYXZlQW5kQ2xvc2UiLCJoaWRlIiwiY2hhbmdlU2VsZWN0b3IiLCJzZWwiLCJkYiIsInVwZGF0ZSIsImRlbGV0ZURhc2hib2FyZCIsImxvZ2luQnRuIiwic3VibWl0IiwiY3JlZCIsImxvZ2luQnRuRGlzYWJsZWQiLCJhdXRoIiwiZXJyb3JfbWVzIiwicGF0dGVybiIsIlRyaWFuZ2xpZnkiLCJ3aWR0aCIsImlubmVyV2lkdGgiLCJpbm5lckhlaWdodCIsInhfY29sb3JzIiwieV9jb2xvcnMiLCJjZWxsX3NpemUiLCJnZXRFbGVtZW50QnlJZCIsImFwcGVuZENoaWxkIiwiY2FudmFzIiwic2F2ZV9idG4iLCJlZGl0VXNlciIsInVzZXJfZGF0YSIsImNsZWFuIiwicHV0IiwiZXJyX21zZyIsInBhc3N3b3JkIiwicGVvcGxlIiwibXlVc2VybmFtZSIsInRtcCIsImRlbGV0ZVVzZXIiLCJ1c2VyX2lkIiwidXNlcnMiLCJhZGRVc2VyIiwiYWRkVXNlckJveCIsInBvc3QiLCJ1c2VybmFtZSIsIm5hbWUiLCJzdXJuYW1lIiwicm93IiwiY29sIiwiJHdhdGNoIiwic2Nyb2xsSGVpZ2h0IiwibmV3VmFsIiwib2xkVmFsIiwicm93SGVpZ2h0T3B0aW9uIiwiZGl2IiwicmVzdHJpY3QiLCJzZXJ2aWNlIiwiJG1kVG9hc3QiLCJDT05GSUciLCJhZGRyIiwidGhpcyIsImhvc3QiLCJwb3J0IiwiYWxlcnQiLCJ1cmwiLCJwYXJhbXMiLCJjYWNoZSIsIm1ldGhvZCIsImhlYWRlcnMiLCJBdXRob3JpemF0aW9uIiwic2ltcGxlIiwidGV4dENvbnRlbnQiLCJwb3NpdGlvbiIsImhpZGVEZWxheSIsIkpTT04iLCJzdHJpbmdpZnkiLCJiYWNrdXAiLCJ1cGRhdGVkRGFzaGJvYXJkIiwiaXNVbmRlZmluZWQiLCJqIiwiYWRkIiwibmV3RGFzaGJvYXJkIiwidG1wRGFzaGJvYXJkIiwic2VjdGlvbiIsIiRtZFNpZGVuYXYiLCJNRU5VIiwibWVudSIsImlzQWN0aXZlIiwiY3VycmVudCIsImVuYWJsZSIsInRvZ2dsZUl0ZW0iLCJ0b2dnbGVCdG4iLCJjbG9zZUxlZnQiLCJ0b2dnbGUiLCJsb2dvdXQiLCJhZGREYXNoYm9hcmQiLCJuZXdJbmRleCIsInN3aXRjaERhc2hib2FyZCIsInRvZ2dsZUxlZnQiLCJqd3QiLCJ0b2tlbiIsImJhc2U2NFVybCIsImJhc2U2NCIsInBhcnNlIiwiYXRvYiIsInRvSnNvbiIsImFsbHVzZXJzIiwiZGF0YV9yYXciLCJzaW1wbGV0IiwidXNlckRhdGEiLCJ1c2VySWQiLCJpbnB1dCIsImZvckVhY2giLCJ0b0lTT1N0cmluZyIsIiRzY2UiLCIkZmlsdGVyIiwiaHRtbCIsInRydXN0QXMiXSwibWFwcGluZ3MiOiJBQUlBLFFBQUFBLFFBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBQ0FILEVBQ0FJLEtBQUEsVUFDQUMsV0FBQSxrQkFDQUMsWUFBQSxxQkFFQUYsS0FBQSxLQUNBQyxXQUFBLGlCQUNBQyxZQUFBLG9CQUVBRixLQUFBLFNBQ0FDLFdBQUEsaUJBQ0FDLFlBQUEscUJBRUFGLEtBQUEsV0FDQUMsV0FBQSxtQkFDQUMsWUFBQSxvQkFDQUMsZ0JBQUEsSUFFQUgsS0FBQSxlQUNBQyxXQUFBLGtCQUNBQyxZQUFBLHFCQUVBRixLQUFBLHFCQUNBQyxXQUFBLG9CQUNBQyxZQUFBLHVCQUVBRixLQUFBLG1CQUNBQyxXQUFBLGtCQUNBQyxZQUFBLHFCQUVBRSxXQUNBQyxXQUFBLFdBR0FSLEVBQUFTLE1BQUEsV0FBQUMsZUFBQSxjQUFBQyxjQUFBLFVBRUFYLEVBQUFTLE1BQUEsaUJBQ0FULEVBQUFTLE1BQUEsZUFFQVIsRUFBQVcsYUFBQUMsS0FBQSx5QkFDQVgsRUFDQVksYUFBQSxPQzdDQWhCLE9BQU9pQixTQUFXLGlCQUFrQixxQkFBc0IsZ0JBQWlCLHdCREQzRSxJQUFBQyxLQUFBQyxRQUFBQyxPQUFBLE9BQUEsYUFBQSxVQUFBLGFBQUEsT0FBQSxZQUFBLFFBQUEsWUFFQUYsS0FBQWxCLE9BQUFBLFFBeURBa0IsSUFBQUcsT0FBQSxVQUFBLFdBQ0EsTUFBQSxVQUFBQyxHQUNBLE1BQUFBLEdBQUFBLEVBQUFD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cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdndWknLCBbJ25nTWF0ZXJpYWwnLCAnbmdSb3V0ZScsICduZ01lc3NhZ2VzJywgJ252ZDMnLCAnbmdTdG9yYWdlJywgJ25nTWFwJywgJ2dyaWRzdGVyJ10pO1xuXG5hcHAuY29uZmlnKGNvbmZpZyk7XG5cbmZ1bmN0aW9uIGNvbmZpZygkcm91dGVQcm92aWRlciwgJG1kVGhlbWluZ1Byb3ZpZGVyLCAkaHR0cFByb3ZpZGVyLCAkbG9jYWxTdG9yYWdlUHJvdmlkZXIpIHtcblx0JHJvdXRlUHJvdmlkZXJcblx0XHQud2hlbignL2xvZ2luJywge1xuXHRcdFx0Y29udHJvbGxlcjogJ2xvZ2luQ29udHJvbGxlcicsXG5cdFx0XHR0ZW1wbGF0ZVVybDogJ3ZpZXdzL2xvZ2luLmh0bWwnLFxuXHRcdH0pXG5cdFx0LndoZW4oJy8nLCB7XG5cdFx0XHRjb250cm9sbGVyOiAnaG9tZUNvbnRyb2xsZXInLFxuXHRcdFx0dGVtcGxhdGVVcmw6ICd2aWV3cy9ob21lLmh0bWwnLFxuXHRcdH0pXG5cdFx0LndoZW4oJy91c2VyJywge1xuXHRcdFx0Y29udHJvbGxlcjogJ3VzZXJDb250cm9sbGVyJyxcblx0XHRcdHRlbXBsYXRlVXJsOiAndmlld3MvbG9naW4uaHRtbCcsXG5cdFx0fSlcbiAgICAgICAgLndoZW4oJy9ldmVudHMnLCB7XG4gICAgICAgICAgICBjb250cm9sbGVyIDogJ2V2ZW50c0NvbnRyb2xsZXInLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmwgOiAndmlld3MvZXZlbnRzLmh0bWwnLFxuICAgICAgICAgICAgcmVsb2FkT25TZWFyY2ggOiBmYWxzZVxuICAgICAgICB9KVxuICAgICAgICAud2hlbignL2V2ZW50cy86aWQnLCB7XG4gICAgICAgICAgICBjb250cm9sbGVyOiAnZXZlbnRDb250cm9sbGVyJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsIDogJ3ZpZXdzL2V2ZW50Lmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgIC53aGVuKCcvc2V0dGluZ3MvcHJvZmlsZScsIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIgOiAncHJvZmlsZUNvbnRyb2xsZXInLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmwgOiAndmlld3MvcHJvZmlsZS5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAud2hlbignL3NldHRpbmdzL3VzZXJzJywge1xuICAgICAgICAgICAgY29udHJvbGxlciA6ICd1c2Vyc0NvbnRyb2xsZXInLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmwgOiAndmlld3MvdXNlcnMuaHRtbCdcbiAgICAgICAgfSlcblx0XHQub3RoZXJ3aXNlKHtcblx0XHRcdHJlZGlyZWN0VG86ICcvbG9naW4nXG5cdFx0fSk7XG5cbiAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKS5wcmltYXJ5UGFsZXR0ZSgnbGlnaHQtYmx1ZScpLmFjY2VudFBhbGV0dGUoJ29yYW5nZScpO1xuXG4gICAgJG1kVGhlbWluZ1Byb3ZpZGVyLnRoZW1lKCdzdWNjZXNzLXRvYXN0Jyk7XG4gICAgJG1kVGhlbWluZ1Byb3ZpZGVyLnRoZW1lKCdlcnJvci10b2FzdCcpO1xuXG4gICAgJGh0dHBQcm92aWRlci5pbnRlcmNlcHRvcnMucHVzaCgnbm90QWxsb3dlZEludGVyY2VwdG9yJyk7XG4gICAgJGxvY2FsU3RvcmFnZVByb3ZpZGVyXG4gICAgICAgIC5zZXRLZXlQcmVmaXgoJ25kLScpO1xuXHQvLyBsb2NhbFN0b3JhZ2VTZXJ2aWNlUHJvdmlkZXJcblx0Ly8gXHQuc2V0UHJlZml4KCduZW1lYS1kYXNoYm9hcmQnKVxuXHQvLyBcdC8vUFJPRFVDVElPTlxuXHQvLyBcdC8vLnNldFN0b3JhZ2VDb29raWVEb21haW4od2luZG93LmxvY2F0aW9uKVxuXHQvLyBcdC8vREVWXG5cdC8vIFx0LnNldFN0b3JhZ2VDb29raWVEb21haW4oJycpXG5cdC8vIFx0O1xuXG4vL1x0JGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xufTtcblxuLy90YWtlIGFsbCB3aGl0ZXNwYWNlIG91dCBvZiBzdHJpbmdcbmFwcC5maWx0ZXIoJ25vc3BhY2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiAoIXZhbHVlKSA/ICcnIDogdmFsdWUucmVwbGFjZSgvIC9nLCAnJyk7XG4gICAgICB9O1xuICAgIH0pO1xuXG4vLyBBbHdheXMgY2hlY2sgZm9yIGEgSldUXG5hcHAucnVuKGZ1bmN0aW9uKHVzZXIsICRsb2NhbFN0b3JhZ2UsICRsb2NhdGlvbiwgJHJvb3RTY29wZSwgJGxvZykge1xuXHQkcm9vdFNjb3BlLiRvbihcIiRsb2NhdGlvbkNoYW5nZVN0YXJ0XCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIGlmICgkbG9jYWxTdG9yYWdlW1widG9rZW5cIl0gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAkbG9nLmluZm8oXCJubyB0b2tlbiBmb3VuZCwgcmVkaXJlY3RpbmcgdG8gL2xvZ2luXCIpXG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9sb2dpblwiKTtcbiAgICAgICAgfVxuICAgIH0pXG59KVxuXG4vLyBIVFRQIGludGVyY2VwdG9yIGluamVjdGVkIGluIGNvbmZpZ1xuYXBwLmZhY3RvcnkoJ25vdEFsbG93ZWRJbnRlcmNlcHRvcicsIGZ1bmN0aW9uKCRsb2csICRsb2NhbFN0b3JhZ2UsICRsb2NhdGlvbiwgJGluamVjdG9yLCAkcSkge1xuICAgIHZhciBub3RBbGxvd2VkSW50ZXJjZXB0b3IgPSB7XG4gICAgICAgIC8vIEludGVyY2VwdCAkaHR0cCBlcnJvcnNcbiAgICAgICAgcmVzcG9uc2VFcnJvciA6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAvLyBDaGVjayBmb3IgNDAxIGVycm9yXG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09IDQwMSkge1xuICAgICAgICAgICAgICAgICRsb2cuZXJyb3IoJ1lvdSBhcmUgbm90IGFsbG93ZWQgdG8gYWNjZXNzLCByZWRpcmVjdGluZyB0byAvbG9naW4nKTtcbiAgICAgICAgICAgICAgICAvLyBEZWxldGUgZXhpc2l0aW5nIEpXVCBmcm9tIGxvY2FsU3RvcmFnZSBcbiAgICAgICAgICAgICAgICBkZWxldGUgJGxvY2FsU3RvcmFnZVtcInRva2VuXCJdO1xuICAgICAgICAgICAgICAgIC8vIFJlZGlyZWN0IHRvIGxvZ2luXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9sb2dpbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gUmV0dXJuIHByb21pc2Ugc28gd2UgY2FuIGhhbmRsZSB0aGUgZXJyb3IgZnVydGhlclxuICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5vdEFsbG93ZWRJbnRlcmNlcHRvcjtcbn0pXG4iLCJcbmNvbmZpZy4kaW5qZWN0ID0gW1wiJHJvdXRlUHJvdmlkZXJcIiwgXCIkbWRUaGVtaW5nUHJvdmlkZXJcIiwgXCIkaHR0cFByb3ZpZGVyXCIsIFwiJGxvY2FsU3RvcmFnZVByb3ZpZGVyXCJdO3ZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnZ3VpJywgWyduZ01hdGVyaWFsJywgJ25nUm91dGUnLCAnbmdNZXNzYWdlcycsICdudmQzJywgJ25nU3RvcmFnZScsICduZ01hcCcsICdncmlkc3RlciddKTtcblxuYXBwLmNvbmZpZyhjb25maWcpO1xuXG5mdW5jdGlvbiBjb25maWcoJHJvdXRlUHJvdmlkZXIsICRtZFRoZW1pbmdQcm92aWRlciwgJGh0dHBQcm92aWRlciwgJGxvY2FsU3RvcmFnZVByb3ZpZGVyKSB7XG5cdCRyb3V0ZVByb3ZpZGVyXG5cdFx0LndoZW4oJy9sb2dpbicsIHtcblx0XHRcdGNvbnRyb2xsZXI6ICdsb2dpbkNvbnRyb2xsZXInLFxuXHRcdFx0dGVtcGxhdGVVcmw6ICd2aWV3cy9sb2dpbi5odG1sJyxcblx0XHR9KVxuXHRcdC53aGVuKCcvJywge1xuXHRcdFx0Y29udHJvbGxlcjogJ2hvbWVDb250cm9sbGVyJyxcblx0XHRcdHRlbXBsYXRlVXJsOiAndmlld3MvaG9tZS5odG1sJyxcblx0XHR9KVxuXHRcdC53aGVuKCcvdXNlcicsIHtcblx0XHRcdGNvbnRyb2xsZXI6ICd1c2VyQ29udHJvbGxlcicsXG5cdFx0XHR0ZW1wbGF0ZVVybDogJ3ZpZXdzL2xvZ2luLmh0bWwnLFxuXHRcdH0pXG4gICAgICAgIC53aGVuKCcvZXZlbnRzJywge1xuICAgICAgICAgICAgY29udHJvbGxlciA6ICdldmVudHNDb250cm9sbGVyJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsIDogJ3ZpZXdzL2V2ZW50cy5odG1sJyxcbiAgICAgICAgICAgIHJlbG9hZE9uU2VhcmNoIDogZmFsc2VcbiAgICAgICAgfSlcbiAgICAgICAgLndoZW4oJy9ldmVudHMvOmlkJywge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ2V2ZW50Q29udHJvbGxlcicsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybCA6ICd2aWV3cy9ldmVudC5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAud2hlbignL3NldHRpbmdzL3Byb2ZpbGUnLCB7XG4gICAgICAgICAgICBjb250cm9sbGVyIDogJ3Byb2ZpbGVDb250cm9sbGVyJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsIDogJ3ZpZXdzL3Byb2ZpbGUuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgLndoZW4oJy9zZXR0aW5ncy91c2VycycsIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIgOiAndXNlcnNDb250cm9sbGVyJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsIDogJ3ZpZXdzL3VzZXJzLmh0bWwnXG4gICAgICAgIH0pXG5cdFx0Lm90aGVyd2lzZSh7XG5cdFx0XHRyZWRpcmVjdFRvOiAnL2xvZ2luJ1xuXHRcdH0pO1xuXG4gICAgJG1kVGhlbWluZ1Byb3ZpZGVyLnRoZW1lKCdkZWZhdWx0JykucHJpbWFyeVBhbGV0dGUoJ2xpZ2h0LWJsdWUnKS5hY2NlbnRQYWxldHRlKCdvcmFuZ2UnKTtcblxuICAgICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnc3VjY2Vzcy10b2FzdCcpO1xuICAgICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnZXJyb3ItdG9hc3QnKTtcblxuICAgICRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ25vdEFsbG93ZWRJbnRlcmNlcHRvcicpO1xuICAgICRsb2NhbFN0b3JhZ2VQcm92aWRlclxuICAgICAgICAuc2V0S2V5UHJlZml4KCduZC0nKTtcblx0Ly8gbG9jYWxTdG9yYWdlU2VydmljZVByb3ZpZGVyXG5cdC8vIFx0LnNldFByZWZpeCgnbmVtZWEtZGFzaGJvYXJkJylcblx0Ly8gXHQvL1BST0RVQ1RJT05cblx0Ly8gXHQvLy5zZXRTdG9yYWdlQ29va2llRG9tYWluKHdpbmRvdy5sb2NhdGlvbilcblx0Ly8gXHQvL0RFVlxuXHQvLyBcdC5zZXRTdG9yYWdlQ29va2llRG9tYWluKCcnKVxuXHQvLyBcdDtcblxuLy9cdCRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcbn07XG5cbi8vdGFrZSBhbGwgd2hpdGVzcGFjZSBvdXQgb2Ygc3RyaW5nXG5hcHAuZmlsdGVyKCdub3NwYWNlJywgZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gKCF2YWx1ZSkgPyAnJyA6IHZhbHVlLnJlcGxhY2UoLyAvZywgJycpO1xuICAgICAgfTtcbiAgICB9KTtcblxuLy8gQWx3YXlzIGNoZWNrIGZvciBhIEpXVFxuYXBwLnJ1bihbXCJ1c2VyXCIsIFwiJGxvY2FsU3RvcmFnZVwiLCBcIiRsb2NhdGlvblwiLCBcIiRyb290U2NvcGVcIiwgXCIkbG9nXCIsIGZ1bmN0aW9uKHVzZXIsICRsb2NhbFN0b3JhZ2UsICRsb2NhdGlvbiwgJHJvb3RTY29wZSwgJGxvZykge1xuXHQkcm9vdFNjb3BlLiRvbihcIiRsb2NhdGlvbkNoYW5nZVN0YXJ0XCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIGlmICgkbG9jYWxTdG9yYWdlW1widG9rZW5cIl0gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAkbG9nLmluZm8oXCJubyB0b2tlbiBmb3VuZCwgcmVkaXJlY3RpbmcgdG8gL2xvZ2luXCIpXG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9sb2dpblwiKTtcbiAgICAgICAgfVxuICAgIH0pXG59XSlcblxuLy8gSFRUUCBpbnRlcmNlcHRvciBpbmplY3RlZCBpbiBjb25maWdcbmFwcC5mYWN0b3J5KCdub3RBbGxvd2VkSW50ZXJjZXB0b3InLCBbXCIkbG9nXCIsIFwiJGxvY2FsU3RvcmFnZVwiLCBcIiRsb2NhdGlvblwiLCBcIiRpbmplY3RvclwiLCBcIiRxXCIsIGZ1bmN0aW9uKCRsb2csICRsb2NhbFN0b3JhZ2UsICRsb2NhdGlvbiwgJGluamVjdG9yLCAkcSkge1xuICAgIHZhciBub3RBbGxvd2VkSW50ZXJjZXB0b3IgPSB7XG4gICAgICAgIC8vIEludGVyY2VwdCAkaHR0cCBlcnJvcnNcbiAgICAgICAgcmVzcG9uc2VFcnJvciA6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAvLyBDaGVjayBmb3IgNDAxIGVycm9yXG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09IDQwMSkge1xuICAgICAgICAgICAgICAgICRsb2cuZXJyb3IoJ1lvdSBhcmUgbm90IGFsbG93ZWQgdG8gYWNjZXNzLCByZWRpcmVjdGluZyB0byAvbG9naW4nKTtcbiAgICAgICAgICAgICAgICAvLyBEZWxldGUgZXhpc2l0aW5nIEpXVCBmcm9tIGxvY2FsU3RvcmFnZSBcbiAgICAgICAgICAgICAgICBkZWxldGUgJGxvY2FsU3RvcmFnZVtcInRva2VuXCJdO1xuICAgICAgICAgICAgICAgIC8vIFJlZGlyZWN0IHRvIGxvZ2luXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9sb2dpbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gUmV0dXJuIHByb21pc2Ugc28gd2UgY2FuIGhhbmRsZSB0aGUgZXJyb3IgZnVydGhlclxuICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5vdEFsbG93ZWRJbnRlcmNlcHRvcjtcbn1dKVxuXG5hcHAuY29uc3RhbnQoJ0FVVEhfRVZFTlRTJywge1xuICBsb2dpblN1Y2Nlc3M6ICdhdXRoLWxvZ2luLXN1Y2Nlc3MnLFxuICBsb2dpbkZhaWxlZDogJ2F1dGgtbG9naW4tZmFpbGVkJyxcbiAgbG9nb3V0U3VjY2VzczogJ2F1dGgtbG9nb3V0LXN1Y2Nlc3MnLFxuICBzZXNzaW9uVGltZW91dDogJ2F1dGgtc2Vzc2lvbi10aW1lb3V0JyxcbiAgbm90QXV0aGVudGljYXRlZDogJ2F1dGgtbm90LWF1dGhlbnRpY2F0ZWQnLFxuICBub3RBdXRob3JpemVkOiAnYXV0aC1ub3QtYXV0aG9yaXplZCdcbn0pO1xuXG5hcHAuY29uc3RhbnQoJ0NBVEVHT1JJRVMnLCBbIFwiYW55XCIsIFwiUmVjb24uU2Nhbm5pbmdcIiwgXCJBdHRlbXB0LkxvZ2luXCIsIFwiQXZhaWxhYmlsaXR5LkRvU1wiLCBcIkF2YWlsaWJpbGl0eS5ERG9TXCJdKTtcbmFwcC5jb25zdGFudCgnUFJPVE9DT0xTJywgWyBcInRjcFwiLCBcImRuc1wiLCBcInVkcFwiIF0pO1xuYXBwLmNvbnN0YW50KCdUWVBFUycsIFtcImJhcmNoYXJ0XCIsIFwicGllY2hhcnRcIiwgXCJ0b3BcIiwgXCJzdW1cIl0pXG5cbmFwcC5jb25zdGFudCgnUElFQ0hBUlQnLCB7IFxuICAgIG9wdGlvbnM6IHtcbiAgICAgICAgY2hhcnQ6IHtcbiAgICAgICAgICAgIHR5cGU6ICdwaWVDaGFydCcsXG4gICAgICAgICAgICBoZWlnaHQ6IDM3NSxcbiAgICAgICAgICAgIC8vaGVpZ2h0OiBmdW5jdGlvbigpIHsgY29uc29sZS5sb2coZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ252ZDMnKS5vZmZzZXRIZWlnaHQpOyByZXR1cm4gTnVtYmVyKDQyNSl9LFxuICAgICAgICAgICAgeDogZnVuY3Rpb24oZCl7cmV0dXJuIGQua2V5WzBdO30sXG4gICAgICAgICAgICB5OiBmdW5jdGlvbihkKXtyZXR1cm4gZC54O30sXG4gICAgICAgICAgICBzaG93TGFiZWxzOiB0cnVlLFxuICAgICAgICAgICAgZG9udXQgOiB0cnVlLFxuICAgICAgICAgICAgcGFkQW5nbGUgOiAwLjAwLFxuICAgICAgICAgICAgY29ybmVyUmFkaXVzIDogMSxcbiAgICAgICAgICAgIHRyYW5zaXRpb25EdXJhdGlvbjogNTAwLFxuICAgICAgICAgICAgbGFiZWxUaHJlc2hvbGQ6IDAsXG4gICAgICAgICAgICAvL2NvbG9yOiBbJ2JsdWUnLCAnZ3JlZW4nLCAneWVsbG93J10sXG4gICAgICAgICAgICAvL2NvbG9yOiBbXCIjNGFjNGYzXCIsIFwiIzk2ZDZiZFwiLCBcIiMwYTU5OWRcIiwgXCIjOGJhMmMwXCIsIFwiI2Y3ZmNmZFwiLFwiI2U1ZjVmOVwiLFwiI2NjZWNlNlwiLFwiIzk5ZDhjOVwiLFwiIzY2YzJhNFwiLFwiIzQxYWU3NlwiLFwiIzIzOGI0NVwiLFwiIzAwNmQyY1wiLFwiIzAwNDQxYlwiXSxcbiAgICAgICAgICAgIC8vY29sb3I6IFtcIiMyMTk2RjNcIiwgXCIjMDA5Njg4XCIsICBcIiM2NzNBQjdcIiwgIFwiI0ZGOTgwMFwiXSwgXG4gICAgICAgICAgICBsZWdlbmQ6IHtcbiAgICAgICAgICAgICAgICBtYXJnaW46IHtcbiAgICAgICAgICAgICAgICAgICAgdG9wOiA1LFxuICAgICAgICAgICAgICAgICAgICByaWdodDogMCxcbiAgICAgICAgICAgICAgICAgICAgYm90dG9tOiAtMTUsXG4gICAgICAgICAgICAgICAgICAgIGxlZnQ6IDBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGVnZW5kUG9zaXRpb24gOiBcInRvcFwiLFxuICAgICAgICAgICAgdG9vbHRpcENvbnRlbnQgOiBmdW5jdGlvbihrZXksIHgsIHksIGUsIGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGtleSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZ3JhcGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ09sYWxhbGEhJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHBpZSA6IHtcbiAgICAgICAgICAgICAgICBkaXNwYXRjaDoge1xuICAgICAgICAgICAgICAgICAgICAvL2NoYXJ0Q2xpY2s6IGZ1bmN0aW9uKGUpIHtjb25zb2xlLmxvZyhlKX0sXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnRDbGljazogZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGUuc2V0VGltZShkYXRlLmdldFRpbWUoKSAtIDEwMDAqNjAqNjAqMjQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZS5zZXRIb3VycygwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGUuc2V0TWludXRlcygwKVxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uID0gJyMvZXZlbnRzP2ZpbHRlciZkYXRlPScgKyBkYXRlLmdldFRpbWUoKSArICcmZnJvbT0nICsgbmV3IERhdGUoKS5nZXRIb3VycygpICsgJzonICsgbmV3IERhdGUoKS5nZXRNaW51dGVzKCkgKyAnJmNhdGVnb3J5PScgKyBlLmRhdGEua2V5WzBdfSxcbiAgICAgICAgICAgICAgICAgICAgLy9lbGVtZW50RGJsQ2xpY2s6IGZ1bmN0aW9uKGUpIHtjb25zb2xlLmxvZyhcImVsZW1lbnQgZG91YmxlIGNsaWNrXCIpfSxcbiAgICAgICAgICAgICAgICAgICAgLy9lbGVtZW50TW91c2VvdmVyOiBmdW5jdGlvbihlKSB7Y29uc29sZS5sb2coXCJlbGVtZW50IG1vdXNlb3ZlclwiKX0sXG4gICAgICAgICAgICAgICAgICAgIC8vZWxlbWVudE1vdXNlb3V0OiBmdW5jdGlvbihlKSB7Y29uc29sZS5sb2coXCJlbGVtZW50IG1vdXNlIG91dFwiKX0gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGxhYmVsVHlwZSA6IFwicGVyY2VudFwiLFxuICAgICAgICAgICAgICAgIGxhYmVsc091dHNpZGUgOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAvL3N0YXJ0QW5nbGUgOiBmdW5jdGlvbihkKSB7IHJldHVybiBkLnN0YXJ0QW5nbGUvMiAtTWF0aC5QSS8yIH0sXG4gICAgICAgICAgICAgICAgLy9lbmRBbmdsZSA6IGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuZW5kQW5nbGUvMiAtTWF0aC5QSS8yIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0pO1xuXG5cbmFwcC52YWx1ZSgnQVJFQScsIHtcbiAgICBvcHRpb25zIDoge1xuICAgICAgICBjaGFydDoge1xuICAgICAgICAgICAgdHlwZTogJ211bHRpQmFyQ2hhcnQnLFxuICAgICAgICAgICAgaGVpZ2h0OiA0NTAsXG4gICAgICAgICAgICBtYXJnaW4gOiB7XG4gICAgICAgICAgICAgICAgdG9wOiAzMCxcbiAgICAgICAgICAgICAgICByaWdodDogMjAsXG4gICAgICAgICAgICAgICAgYm90dG9tOiAxMDAsXG4gICAgICAgICAgICAgICAgbGVmdDogNjVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB4OiBmdW5jdGlvbihkKSB7IHJldHVybiBkLnggfSxcbiAgICAgICAgICAgIHk6IGZ1bmN0aW9uKGQpIHsgcmV0dXJuIE51bWJlcihkLkNvdW50KSB9LFxuICAgICAgICAgICAgdXNlVm9yb25vaTogZmFsc2UsXG4gICAgICAgICAgICBjbGlwRWRnZTogdHJ1ZSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAxMDAsXG4gICAgICAgICAgICB1c2VJbnRlcmFjdGl2ZUd1aWRlbGluZTogZmFsc2UsXG4gICAgICAgICAgICB0b29sdGlwQ29udGVudCA6IGZ1bmN0aW9uKGtleSwgeCwgeSwgZSwgZ3JhcGgpIHtyZXR1cm4oXCJIYVwiKTt9LFxuICAgICAgICAgICAgeEF4aXM6IHtcbiAgICAgICAgICAgICAgICBzaG93TWF4TWluOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB0aWNrRm9ybWF0OiBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkMy50aW1lLmZvcm1hdCgnJW0vJWQgJUg6JU0nKShuZXcgRGF0ZShkKSlcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHJvdGF0ZUxhYmVscyA6IC00NSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB5QXhpczoge1xuICAgICAgICAgICAgICAgIHNob3dNYXhNaW46IGZhbHNlLFxuICAgICAgICAgICAgICAgIHRpY2tGb3JtYXQ6IGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZDMuZm9ybWF0KCdzJykoZCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBheGlzTGFiZWwgOiBcIkV2ZW50cyBDb3VudFwiLFxuICAgICAgICAgICAgICAgIGF4aXNMYWJlbERpc3RhbmNlIDogLTIwXG4gICAgICAgICAgICB9LCAgXG4gICAgICAgICAgICBtdWx0aWJhcjoge1xuICAgICAgICAgICAgICAgIGRpc3BhdGNoIDoge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50Q2xpY2s6IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoZS5kYXRhLngpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBob3VycyA9IGRhdGUuZ2V0SG91cnMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtaW51dGVzID0gZGF0ZS5nZXRNaW51dGVzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlLnNldEhvdXJzKDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZS5zZXRNaW51dGVzKDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uID0gJyMvZXZlbnRzP2ZpbHRlciZkYXRlPScgKyBkYXRlLmdldFRpbWUoKSArICcmZnJvbT0nICsgKFwiMFwiICsgaG91cnMpLnNsaWNlKC0yKSArICc6JyArIChcIjBcIiArIG1pbnV0ZXMpLnNsaWNlKC0yKSArICcmY2F0ZWdvcnk9JyArIGUuZGF0YS5rZXkgKyAnJmRpcj0xJztcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuXG5cbmFwcC5jb25zdGFudChcIk1FTlVcIiwgW1xuXHQvKntcblx0XHRcInRpdGxlXCIgOiBcIkRhc2hib2FyZFwiLFxuICAgICAgICBcImxpbmtcIiA6IFwiIy9cIlxuXHRcdFwiaXRlbXNcIiA6IFtcblx0XHRcdHtcblx0XHRcdFx0XCJ0aXRsZVwiIDogXCJVc2Vyc1wiLFxuXHRcdFx0XHRcImxpbmtcIlx0OiBcInVzZXJcIlxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0XCJ0aXRsZVwiIDogXCJNeSBwcm9maWxlXCJcblx0XHRcdH1cblx0XHRdXG5cdH0sKi9cblx0e1xuXHRcdFwidGl0bGVcIiA6IFwiRXZlbnRzXCIsXG5cdFx0XCJsaW5rXCIgXHQ6IFwiIy9ldmVudHNcIlxuXHR9LFxuXHQvKntcblx0XHRcInRpdGxlXCIgOiBcIkFuYWx5dGljczIzXCIsXG5cdFx0XCJpdGVtc1wiIDogW1xuXHRcdFx0e1xuXHRcdFx0XHRcInRpdGxlXCIgOiBcIlVzZXJzXCIsXG5cdFx0XHRcdFwibGlua1wiIFx0OiBcInNldHRpbmdzXCJcblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdFwidGl0bGVcIiA6IFwiTXkgcHJvZmlsZVwiLFxuXHRcdFx0XHRcImxpbmtcIlx0OiBcInByb2ZpbGVcIlxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0XCJ0aXRsZVwiIDogXCJNeSBwcm9maWxlXCIsXG5cdFx0XHRcdFwibGlua1wiXHQ6IFwicHJvZmlsZVwiXG5cdFx0XHR9XG5cdFx0XVxuXG5cdH0sXG5cdHtcblx0XHRcInRpdGxlXCIgOiBcIkFuYWx5dGljczEyM1wiLFxuXHRcdFwibGlua1wiIFx0OiBcImxvZ2luXCJcblx0fSwqL1xuXHR7XG5cdFx0XCJ0aXRsZVwiIDogXCJTZXR0aW5nc1wiLFxuXHRcdFwiaXRlbXNcIiA6IFtcbiAgICAgICAgICAgIHtcblx0XHRcdFx0XCJ0aXRsZVwiIDogXCJNeSBwcm9maWxlXCIsXG5cdFx0XHRcdFwibGlua1wiXHQ6IFwiIy9zZXR0aW5ncy9wcm9maWxlXCJcblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdFwidGl0bGVcIiA6IFwiVXNlcnNcIixcblx0XHRcdFx0XCJsaW5rXCIgXHQ6IFwiIy9zZXR0aW5ncy91c2Vyc1wiXG5cdFx0XHR9LFxuXHRcdF1cblx0fVxuXSk7XG5cbmFwcC5jb250cm9sbGVyKCdldmVudENvbnRyb2xsZXInLCBbXCIkc2NvcGVcIiwgXCIkcm91dGVQYXJhbXNcIiwgXCIkaHR0cFwiLCBcImFwaVwiLCBmdW5jdGlvbigkc2NvcGUsICRyb3V0ZVBhcmFtcywgJGh0dHAsIGFwaSkge1xuXG4gICAgICAgICRzY29wZS5pZCA9ICRyb3V0ZVBhcmFtcztcbiAgICAgICAgJHNjb3BlLnNob3dQbGFpbiA9IHRydWU7XG5cbiAgICAgICAgJHNjb3BlLmdlbyA9IFtdO1xuXG4gICAgICAgICRzY29wZS5iYWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB3aW5kb3cuaGlzdG9yeS5iYWNrKClcbiAgICAgICAgfVxuXG4gICAgICAgIGFwaS5nZXQoJ2lkLycgKyAkcm91dGVQYXJhbXNbJ2lkJ10pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSBkYXRhO1xuXG4gICAgICAgICAgICAvL3ZhciBib3VuZHMgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nQm91bmRzKCk7XG5cbiAgICAgICAgICAgIGlmICgoJHNjb3BlLmRhdGEuU291cmNlICE9IHVuZGVmaW5lZCAmJiAkc2NvcGUuZGF0YS5UYXJnZXQgIT0gdW5kZWZpbmVkKSAmJiBcbiAgICAgICAgICAgICAgICAoJHNjb3BlLmRhdGEuU291cmNlWzBdLklQNCAmJiAkc2NvcGUuZGF0YS5UYXJnZXRbMF0uSVA0KSkge1xuICAgICAgICAgICAgICAgICRodHRwLmdldCgnaHR0cDovL2ZyZWVnZW9pcC5uZXQvanNvbi8nICsgJHNjb3BlLmRhdGEuVGFyZ2V0WzBdLklQNFswXSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBkYXRhWyd0eXBlJ10gPSBcIlRhcmdldFwiO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2VvLnB1c2goZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIC8vdmFyIGxhdGxuZyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoZGF0YS5sYXRpdHVkZSwgZGF0YS5sb25naXR1ZGUpO1xuICAgICAgICAgICAgICAgICAgICAvL2JvdW5kcy5leHRlbmQobGF0bG5nKTtcblxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KCdodHRwOi8vZnJlZWdlb2lwLm5ldC9qc29uLycgKyAkc2NvcGUuZGF0YS5Tb3VyY2VbMF0uSVA0WzBdKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YVsndHlwZSddID0gXCJTb3VyY2VcIjtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdlby5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAvL3ZhciBsYXRsbmcgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGRhdGEubGF0aXR1ZGUsIGRhdGEubG9uZ2l0dWRlKTtcbiAgICAgICAgICAgICAgICAgICAgLy9ib3VuZHMuZXh0ZW5kKGxhdGxuZyk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKCRzY29wZS5kYXRhLlNvdXJjZSA9PSB1bmRlZmluZWQgfHwgJHNjb3BlLmRhdGEuU291cmNlWzBdLklQNCA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQoJ2h0dHA6Ly9mcmVlZ2VvaXAubmV0L2pzb24vJyArICRzY29wZS5kYXRhLlRhcmdldFswXS5JUDRbMF0pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBkYXRhWyd0eXBlJ10gPSBcIlRhcmdldFwiO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2VvLnB1c2goZGF0YSk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KCdodHRwOi8vZnJlZWdlb2lwLm5ldC9qc29uLycgKyAkc2NvcGUuZGF0YS5Tb3VyY2VbMF0uSVA0WzBdKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YVsndHlwZSddID0gXCJTb3VyY2VcIjtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdlby5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIFxuXG59XSk7XG5cbmFwcC5jb250cm9sbGVyKCdldmVudHNDb250cm9sbGVyJywgW1wiJHNjb3BlXCIsIFwiJGh0dHBcIiwgXCIkbG9jYXRpb25cIiwgXCJhcGlcIiwgXCIkcm91dGVcIiwgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJGxvY2F0aW9uLCBhcGksICRyb3V0ZSkge1xuICAgICRzY29wZS5maWx0ZXIgPSB7XG4gICAgICAgIFwiY2F0ZWdvcnlcIiA6IFwiXCIsICAgIC8vIENhdGVnb3J5XG4gICAgICAgIFwic3JjX2lwXCIgOiBcIlwiLCAgICAgIC8vIFNvdXJjZSBJUFxuICAgICAgICBcInRydF9pcFwiIDogXCJcIiwgICAgICAvLyBUYXJnZXQgSVBcbiAgICAgICAgXCJkZXNjXCIgOiBcIlwiLCAgICAgICAgLy8gRGVzY3JpcHRpb25cbiAgICAgICAgXCJmbG93c19mcm9tXCIgOiBcIlwiLCAgLy8gRmxvd0NvdW50XG4gICAgICAgIFwiZmxvd3NfdG9cIiA6IFwiXCIsICAgIC8vIEZsb3dDb3VudFxuICAgICAgICBcIml0ZW1zXCIgOiAxMDAsICAgICAgLy8gTGltaXQgbnVtYmVyIG9mIGRpc3BsYXllZCBpdGVtc1xuICAgIH07XG4gICAgJHNjb3BlLnF1ZXJ5ID0ge1xuICAgICAgICBcImZyb21cIiA6IFwiMTI6MDBcIixcbiAgICAgICAgXCJ0b1wiIDogXCJcIixcbiAgICAgICAgXCJkYXRlXCIgOiBuZXcgRGF0ZSgpLFxuICAgICAgICBcImRlc2NyaXB0aW9uXCIgOiBcIlwiLFxuICAgICAgICBcImNhdGVnb3J5XCIgOiBcIlwiLFxuICAgICAgICBcIm9yZGVyYnlcIiA6IFwiRGV0ZWN0VGltZVwiLFxuICAgICAgICBcImRpclwiIDogLTEsXG5cdFx0XCJkaXJfcmF3XCIgOiB0cnVlLFxuICAgICAgICBcImxpbWl0XCIgOiAxMDAsXG4gICAgICAgIFwic3JjaXBcIiA6IFwiXCIsXG4gICAgICAgIFwiZHN0aXBcIiA6IFwiXCJcbiAgICB9XG5cbiAgICAkc2NvcGUub3JkZXJCeSA9IFtcIkRldGVjdFRpbWVcIiwgXCJDYXRlZ29yeVwiLCBcIkRlc2NyaXB0aW9uXCIsIFwiRmxvd0NvdW50XCJdO1xuICAgICRzY29wZS5zZWFyY2hUZXh0ID0gXCJcIjtcblxuICAgICRzY29wZS5kYXRhID0gW107XG4gICAgJHNjb3BlLmxvYWRidG4gPSBcIkxvYWRcIjtcbiAgICAkc2NvcGUubmV4dEJ1dHRvbiA9IFwiTG9hZCBuZXh0IDEwMCBpdGVtc1wiO1xuICAgICRzY29wZS5hY3RpdmVGaWx0ZXIgPSAkbG9jYXRpb24uc2VhcmNoKCkuZmlsdGVyO1xuXHQkc2NvcGUuZGlyVmFsID0gXCJEZXNjZW5kaW5nXCI7XG5cbiAgICAvLyBSRVNFVCBldmVyeXRoaW5nIGluY2x1ZGluZyBVUkwgcGFyYW1ldGVycyBhbmQgcmVsb2FkXG4gICAgJHNjb3BlLnJlc2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICRsb2NhdGlvbi5zZWFyY2goe30pO1xuICAgICAgICAkcm91dGUucmVsb2FkKCk7XG4gICAgfVxuXG4gICAgJHNjb3BlLmdldFF1ZXJ5ID0gZnVuY3Rpb24oaXAsIHBhdGgpIHtcbiAgICAgICAgY29uc29sZS5sb2coaXApO1xuICAgICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGRhdGUuc2V0RGF0ZShkYXRlLmdldERhdGUoKSAtIDcpO1xuICAgICAgICB2YXIgbWludXRlcyA9IFwiMFwiICsgZGF0ZS5nZXRNaW51dGVzKCk7XG4gICAgICAgIHZhciBob3VycyA9IFwiMFwiICsgZGF0ZS5nZXRIb3VycygpO1xuXG4gICAgICAgIHZhciBxdWVyeSA9IHtcbiAgICAgICAgICAgICAgICBmcm9tIDogaG91cnMuc3Vic3RyKC0yKSArICc6JyArIG1pbnV0ZXMuc3Vic3RyKC0yKSwgXG4gICAgICAgICAgICAgICAgZGF0ZSA6IGRhdGUsXG4gICAgICAgICAgICAgICAgbGltaXQgOiAxMDAsXG4gICAgICAgICAgICAgICAgb3JkZXJieSA6IFwiRGV0ZWN0VGltZVwiLFxuICAgICAgICAgICAgICAgIGRpciA6IDFcbiAgICAgICAgICAgIH07XG4gICAgICAgIGlmIChwYXRoID09IFwic3JjXCIpIHtcbiAgICAgICAgICAgcXVlcnlbXCJzcmNpcFwiXSA9IGlwOyBcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHF1ZXJ5W1wiZHN0aXBcIl0gPSBpcDtcbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5sb2FkSXRlbXMocXVlcnkpO1xuICAgIH1cblxuICAgICRzY29wZS5zd2l0Y2hEaXIgPSBmdW5jdGlvbih2YWwpIHtcbiAgICAgICAgaWYgKHZhbCA9PSAtMSB8fCB2YWwgfHwgdmFsID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgJHNjb3BlLmRpclZhbCA9IFwiRGVzY2VuZGluZ1wiO1xuICAgICAgICAgICAgJHNjb3BlLnF1ZXJ5LmRpciA9IC0xO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHNjb3BlLmRpclZhbCA9IFwiQXNjZW5kaW5nXCI7XG4gICAgICAgICAgICAkc2NvcGUucXVlcnkuZGlyID0gMTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgICRzY29wZS5sb2FkTmV4dCA9IGZ1bmN0aW9uKHRpbWUpIHtcbiAgICAgICAgJHNjb3BlLm5leHRCdXR0b24gPSBcIkxvYWRpbmcuLi5cIjtcblxuICAgICAgICBpZiAoJGxvY2F0aW9uLnNlYXJjaCgpLmZpbHRlcikge1xuICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gYW5ndWxhci5jb3B5KCRzY29wZS5xdWVyeSk7XG4gICAgICAgICAgICBxdWVyeS5mcm9tID0gbmV3IERhdGUodGltZSk7XG4gICAgICAgICAgICBxdWVyeS5kaXIgPSAxO1xuXG4gICAgICAgICAgICBpZiAocXVlcnkudG8pIHtcbiAgICAgICAgICAgICAgICB2YXIgdG8gPSBxdWVyeS50by5zcGxpdCgnOicpO1xuICAgICAgICAgICAgICAgIHZhciB0b19kYXRlID0gbmV3IERhdGUocXVlcnkuZGF0ZSk7XG4gICAgICAgICAgICAgICAgdG9fZGF0ZS5zZXRIb3Vycyh0b19kYXRlLmdldEhvdXJzKCkgKyB0b1swXSk7XG4gICAgICAgICAgICAgICAgdG9fZGF0ZS5zZXRNaW51dGVzKHRvWzFdKTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgdG9fZGF0ZSA9IG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHF1ZXJ5LnRvID0gdG9fZGF0ZTtcblxuXG4gICAgICAgICAgICBhcGkuZ2V0KCdxdWVyeScsIHF1ZXJ5LCB0cnVlKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUucmVtYWluaW5nID0gZGF0YS5wb3AoKTtcblxuICAgICAgICAgICAgICAgIGZvcihpdGVtIGluIGRhdGEpIHsgICAgXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kYXRhLnB1c2goZGF0YVtpdGVtXSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJHNjb3BlLm5leHRCdXR0b24gPSBcIkxvYWQgbmV4dCAxMDAgaXRlbXNcIjtcbiAgICAgICAgICAgIH0pLmVycm9yKGZ1bmN0aW9uKGVyciwgbXNnKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAkc2NvcGUubmV4dEJ1dHRvbiA9IFwiTG9hZCBuZXh0IDEwMCBpdGVtc1wiO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBxdWVyeSA9IHtcbiAgICAgICAgICAgICAgICBcInRvXCIgOiBuZXcgRGF0ZSh0aW1lKSxcbiAgICAgICAgICAgICAgICBcImRpclwiIDogLTFcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYXBpLmdldCgncXVlcnknLCBxdWVyeSwgdHJ1ZSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlbWFpbmluZyA9IGRhdGEucG9wKCk7XG4gICAgICAgICAgICAgICAgZm9yKGl0ZW0gaW4gZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5wdXNoKGRhdGFbaXRlbV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAkc2NvcGUubmV4dEJ1dHRvbiA9IFwiTG9hZCBuZXh0IDEwMCBpdGVtc1wiO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihlcnIsIG1zZykge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgJHNjb3BlLm5leHRCdXR0b24gPSBcIkxvYWQgbmV4dCAxMDAgaXRlbXNcIjtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAkc2NvcGUubG9hZEl0ZW1zID0gZnVuY3Rpb24ocXVlcnkpIHtcbiAgICAgICAgJHNjb3BlLmxvYWRidG4gPSBcIkxvYWRpbmcuLi5cIjtcbiAgICAgICAgdmFyIGZyb20gPSBxdWVyeS5mcm9tLnNwbGl0KCc6Jyk7XG4gICAgICAgIHZhciBmcm9tX2RhdGUgPSBuZXcgRGF0ZShxdWVyeS5kYXRlKTtcblxuICAgICAgICBmcm9tX2RhdGUuc2V0SG91cnMoZnJvbVswXSk7XG4gICAgICAgIGZyb21fZGF0ZS5zZXRNaW51dGVzKGZyb21bMV0pO1xuXG4gICAgICAgIHZhciB1bml4X2RhdGUgPSBhbmd1bGFyLmNvcHkocXVlcnkuZGF0ZSk7XG5cbiAgICAgICAgJGxvY2F0aW9uLnNlYXJjaCgnZmlsdGVyJywgdHJ1ZSk7XG4gICAgICAgICRsb2NhdGlvbi5zZWFyY2goJ2Zyb20nLCBxdWVyeS5mcm9tKTtcbiAgICAgICAgJGxvY2F0aW9uLnNlYXJjaCgnZGF0ZScsIHVuaXhfZGF0ZS5nZXRUaW1lKCkpO1xuICAgICAgICAkbG9jYXRpb24uc2VhcmNoKCdsaW1pdCcsIHF1ZXJ5LmxpbWl0KTtcbiAgICAgICAgJGxvY2F0aW9uLnNlYXJjaCgnb3JkZXJieScsIHF1ZXJ5Lm9yZGVyYnkpO1xuICAgICAgICAkbG9jYXRpb24uc2VhcmNoKCdkaXInLCBxdWVyeS5kaXIpO1xuXG4gICAgICAgIGlmIChxdWVyeS50bykge1xuICAgICAgICAgICAgdmFyIHRvID0gcXVlcnkudG8uc3BsaXQoJzonKTtcbiAgICAgICAgICAgIHZhciB0b19kYXRlID0gbmV3IERhdGUocXVlcnkuZGF0ZSk7XG4gICAgICAgICAgICB0b19kYXRlLnNldEhvdXJzKHRvWzBdKTtcbiAgICAgICAgICAgIHRvX2RhdGUuc2V0TWludXRlcyh0b1sxXSk7XG4gICAgICAgICAgICAkbG9jYXRpb24uc2VhcmNoKCd0bycsIHF1ZXJ5LnRvKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciB0b19kYXRlID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChxdWVyeS5kZXNjcmlwdGlvbiAhPSBcIlwiKSB7XG4gICAgICAgICAgICAkbG9jYXRpb24uc2VhcmNoKCdkZXNjcmlwdGlvbicsIHF1ZXJ5LmRlc2NyaXB0aW9uKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHF1ZXJ5LmRlc2NyaXB0aW9uID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChxdWVyeS5jYXRlZ29yeSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAkbG9jYXRpb24uc2VhcmNoKCdjYXRlZ29yeScsIHF1ZXJ5LmNhdGVnb3J5KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHF1ZXJ5LmNhdGVnb3J5ID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChxdWVyeS5zcmNpcCAhPSBcIlwiKSB7XG4gICAgICAgICAgICAkbG9jYXRpb24uc2VhcmNoKCdzcmNpcCcsIHF1ZXJ5LnNyY2lwKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRsb2NhdGlvbi5zZWFyY2goXCJzcmNpcFwiLCBudWxsKTtcbiAgICAgICAgICAgIHF1ZXJ5LnNyY2lwID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChxdWVyeS5kc3RpcCAhPSBcIlwiKSB7XG4gICAgICAgICAgICAkbG9jYXRpb24uc2VhcmNoKCdkc3RpcCcsIHF1ZXJ5LmRzdGlwKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRsb2NhdGlvbi5zZWFyY2goXCJkc3RpcFwiLCBudWxsKTtcbiAgICAgICAgICAgIHF1ZXJ5LmRzdGlwID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzZW5kID0ge1xuICAgICAgICAgICAgXCJmcm9tXCIgOiBmcm9tX2RhdGUsXG4gICAgICAgICAgICBcInRvXCIgOiB0b19kYXRlLFxuICAgICAgICAgICAgXCJjYXRlZ29yeVwiIDogcXVlcnkuY2F0ZWdvcnksXG4gICAgICAgICAgICBcImRlc2NyaXB0aW9uXCIgOiBxdWVyeS5kZXNjcmlwdGlvbixcbiAgICAgICAgICAgIFwibGltaXRcIiA6IHF1ZXJ5LmxpbWl0LFxuICAgICAgICAgICAgXCJvcmRlcmJ5XCIgOiBxdWVyeS5vcmRlcmJ5LFxuICAgICAgICAgICAgXCJkaXJcIiA6IHF1ZXJ5LmRpcixcbiAgICAgICAgICAgIFwic3JjaXBcIiA6IHF1ZXJ5LnNyY2lwLFxuICAgICAgICAgICAgXCJkc3RpcFwiIDogcXVlcnkuZHN0aXBcbiAgICAgICAgfVxuICAgICAgICBhcGkuZ2V0KCdxdWVyeScsIHNlbmQsIHRydWUpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuXHRcdFx0JHNjb3BlLnJlbWFpbmluZyA9IGRhdGEucG9wKCk7Ly9bZGF0YS5sZW5ndGggLSAxXSlcblx0XHRcdCRzY29wZS5kYXRhID0gZGF0YTtcbiAgICAgICAgICAgICRzY29wZS5sb2FkYnRuID0gXCJMb2FkXCJcblx0ICAgIH0pLmVycm9yKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJHNjb3BlLmxvYWRidG4gPSBcIkxvYWRcIjtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgJHNjb3BlLmV2ZW50cyA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgdmFyIHJlcyA9IFtdO1xuICAgICAgICBpZiAoJHNjb3BlLmZpbHRlci5zcmNfaXAgIT0gXCJcIil7XG4gICAgICAgICAgICBpZiAoXCJTb3VyY2VcIiBpbiBpdGVtKSB7XG4gICAgICAgICAgICAgICAgaWYgKFwiSVA0XCIgaW4gaXRlbS5Tb3VyY2VbMF0gJiZcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5Tb3VyY2VbMF0uSVA0WzBdLnRvTG93ZXJDYXNlKCkuaW5kZXhPZigkc2NvcGUuZmlsdGVyLnNyY19pcC50b0xvd2VyQ2FzZSgpKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlcy5wdXNoKDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHJlcy5wdXNoKDApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXMucHVzaCgwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICgkc2NvcGUuZmlsdGVyLnRydF9pcCAhPSBcIlwiKXtcbiAgICAgICAgICAgIGlmIChcIlRhcmdldFwiIGluIGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBpZiAoXCJJUDRcIiBpbiBpdGVtLlRhcmdldFswXSAmJlxuICAgICAgICAgICAgICAgICAgICBpdGVtLlRhcmdldFswXS5JUDRbMF0udG9Mb3dlckNhc2UoKS5pbmRleE9mKCRzY29wZS5maWx0ZXIudHJ0X2lwLnRvTG93ZXJDYXNlKCkpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzLnB1c2goMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgcmVzLnB1c2goMCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlcy5wdXNoKDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICgkc2NvcGUuZmlsdGVyLmNhdGVnb3J5ICE9IFwiXCIpIHtcbiAgICAgICAgICAgIGlmIChpdGVtLkNhdGVnb3J5WzBdLnRvTG93ZXJDYXNlKCkuaW5kZXhPZigkc2NvcGUuZmlsdGVyLmNhdGVnb3J5LnRvTG93ZXJDYXNlKCkpID4gLTEpIHtcbiAgICAgICAgICAgICAgICByZXMucHVzaCgxKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzLnB1c2goMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoJHNjb3BlLmZpbHRlci5kZXNjICE9IFwiXCIpIHtcbiAgICAgICAgICAgIGlmIChpdGVtLkRlc2NyaXB0aW9uLnRvTG93ZXJDYXNlKCkuaW5kZXhPZigkc2NvcGUuZmlsdGVyLmRlc2MudG9Mb3dlckNhc2UoKSkgPiAtMSlcbiAgICAgICAgICAgICAgICByZXMucHVzaCgxKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICByZXMucHVzaCgwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICgkc2NvcGUuZmlsdGVyLmZsb3dzX2Zyb20gIT0gXCJcIikge1xuICAgICAgICAgICAgaWYgKGl0ZW0uRmxvd0NvdW50ID4gTnVtYmVyKCRzY29wZS5maWx0ZXIuZmxvd3NfZnJvbSkpXG4gICAgICAgICAgICAgICAgcmVzLnB1c2goMSk7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgcmVzLnB1c2goMCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoJHNjb3BlLmZpbHRlci5mbG93c190byAhPSBcIlwiKSB7XG4gICAgICAgICAgICBpZiAoaXRlbS5GbG93Q291bnQgPCBOdW1iZXIoJHNjb3BlLmZpbHRlci5mbG93c190bykpXG4gICAgICAgICAgICAgICAgcmVzLnB1c2goMSk7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgcmVzLnB1c2goMCk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgbG9naWN2YWx1ZSA9IDE7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBsb2dpY3ZhbHVlID0gbG9naWN2YWx1ZSAqIHJlc1tpXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbG9naWN2YWx1ZSA9PSAxID8gdHJ1ZSA6IGZhbHNlO1xuXG4gICAgfVxuXG5cdC8qXG5cdCAqIElOSVQgcHJvY2VkdXJlXG5cdCAqL1xuXG4gICAgLy8gQ2hlY2sgZm9yIEZpbHRlciBpbiBVUkwgcGFyYW1zXG5cdGlmICgkbG9jYXRpb24uc2VhcmNoKCkuZmlsdGVyKSB7XG5cdFx0JHNjb3BlLnN3aXRjaERpcigkbG9jYXRpb24uc2VhcmNoKCkuZGlyKTtcblxuXHRcdC8vIFF1ZXJ5IGZpbHRlciBpcyBzZXQsIGFwcGx5IGl0XG4gICAgICAgIHZhciB0bXBfcXVlcnkgPSBhbmd1bGFyLmNvcHkoJGxvY2F0aW9uLnNlYXJjaCgpKTtcblxuICAgICAgICAvLyBGaXJzdCBjb252ZXJ0IFVOSVggVGltZXN0YW1wIHRvIERhdGVcbiAgICAgICAgdG1wX3F1ZXJ5WydkYXRlJ10gPSBuZXcgRGF0ZShOdW1iZXIodG1wX3F1ZXJ5WydkYXRlJ10pKTtcbiAgICAgICAgJHNjb3BlLnF1ZXJ5ID0gdG1wX3F1ZXJ5O1xuXG4gICAgICAgIC8vIEZldGNoIGl0ZW1zXG4gICAgICAgICRzY29wZS5sb2FkSXRlbXMoJHNjb3BlLnF1ZXJ5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBGZXRjaCAxMDAgbW9zdCByZWNlbnQgZXZlbnRzXG4gICAgICAgIGFwaS5nZXQoXCIxMDBcIikuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YSA9IGRhdGE7XG4gICAgICAgIH0pO1xuICAgIH1cbn1dKTtcblxuYXBwLmRpcmVjdGl2ZSgndmFsaWRhdGVIb3VycycsIGZ1bmN0aW9uKCkge1xuICAgIHZhciB0byA9IFtdO1xuICAgIHZhciBmcm9tID0gW107XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxuICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMsIGN0cmwpIHtcbiAgICAgICAgICAgIGN0cmwuJHZhbGlkYXRvcnMudGltZSA9IGZ1bmN0aW9uKG1vZGVsVmFsdWUsIHZpZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmIChhdHRycy5uZ01vZGVsID09IFwicXVlcnkuZnJvbVwiICYmIHZpZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBmcm9tID0gdmlld1ZhbHVlLnNwbGl0KCc6Jyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2aWV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdG8gPSB2aWV3VmFsdWUuc3BsaXQoJzonKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodG8ubGVuZ3RoID09IDIgfHwgZnJvbS5sZW5ndGggPT0gMikge1xuICAgICAgICAgICAgICAgIGlmICh0b1swXSA8IGZyb21bMF0gfHwgKHRvWzBdIDw9IGZyb21bMF0gJiYgdG9bMV0gPCBmcm9tWzFdKSB8fFxuICAgICAgICAgICAgICAgICAgICB0b1swXSA8IDAgfHwgdG9bMF0gPiAyMyB8fCB0b1sxXSA8IDAgfHwgdG9bMV0gPiA1OSB8fCBmcm9tWzBdIDwgMCB8fCBmcm9tWzBdID4gMjMgfHwgZnJvbVsxXSA8IDAgfHwgZnJvbVsxXSA+IDU5XG4gICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSk7XG5cbmFwcC5jb250cm9sbGVyKCdob21lQ29udHJvbGxlcicsIFtcIiRzY29wZVwiLCBcInVzZXJcIiwgXCIkdGltZW91dFwiLCBcIiRpbnRlcnZhbFwiLCBcIiRsb2dcIiwgXCIkbG9jYWxTdG9yYWdlXCIsIFwiJHJvdXRlXCIsIFwiJG1kRGlhbG9nXCIsIFwiZGFzaGJvYXJkXCIsIGZ1bmN0aW9uKCRzY29wZSwgdXNlciwgJHRpbWVvdXQsICRpbnRlcnZhbCwgJGxvZywgJGxvY2FsU3RvcmFnZSwgJHJvdXRlLCAkbWREaWFsb2csIGRhc2hib2FyZCkge1xuICAgIFxuICAgICRzY29wZS5kYXNoYm9hcmRzID0gZGFzaGJvYXJkLmdldEFsbCgpO1xuICAgICRzY29wZS5kYXNoYm9hcmRTZXR0aW5ncyA9IGRhc2hib2FyZC5zZXR0aW5ncygpO1xuXG4gICAgJHNjb3BlLmFjdGl2ZUdyaWQgPSBmYWxzZTtcbiAgICAkc2NvcGUucmVmcmVzaF9pbnRlcnZhbCA9ICRzY29wZS5kYXNoYm9hcmRTZXR0aW5ncy5pbnRlcnZhbDtcbiAgICBcbiAgICAvLyBTdG9yZSBpbnRlcnZhbCBJRFxuICAgIHZhciByZWZyZXNoID0gdW5kZWZpbmVkO1xuICAgICRzY29wZS5yZWZyZXNoX2VuYWJsZWQgPSBhbmd1bGFyLmlzRGVmaW5lZChyZWZyZXNoKTtcblxuICAgICRzY29wZS5vcGVuTWVudSA9IGZ1bmN0aW9uKCRtZE9wZW5NZW51LCBldikge1xuICAgICAgICBvcmlnaW5hdG9yRXYgPSBldjtcbiAgICAgICAgJG1kT3Blbk1lbnUoZXYpO1xuICAgIH07XG5cbiAgICAkc2NvcGUuYWRkSXRlbSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAkc2NvcGUuJGJyb2FkY2FzdCgnYWRkSXRlbScpO1xuICAgIH1cblxuICAgICRzY29wZS5lbmFibGVHcmlkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdFbmFibGUgZ3JpZCcpXG4gICAgICAgICRzY29wZS4kYnJvYWRjYXN0KCdlbmFibGVHcmlkJyk7XG4gICAgICAgICRzY29wZS5hY3RpdmVHcmlkID0gISRzY29wZS5hY3RpdmVHcmlkO1xuICAgIH1cbiAgICAkc2NvcGUuJG9uKCdyZXF1ZXN0UmVkcmF3JywgZnVuY3Rpb24oZSkge1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgncmVzaXplJykpO1xuICAgICAgICB9LCAxMDApO1xuICAgIH0pO1xuXG4gICAgJHNjb3BlLmNsZWFyQ2FjaGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgJGxvZy5kZWJ1ZyhcImRlbGV0aW5nIHRpbWVzdGFtcFwiKVxuICAgICAgICBkZWxldGUgJGxvY2FsU3RvcmFnZVsndGltZXN0YW1wJ107XG4gICAgICAgICRyb3V0ZS5yZWxvYWQoKTtcbiAgICB9XG5cbiAgICAkc2NvcGUuc2V0SW50ZXJ2YWwgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKHJlZnJlc2gpKSB7XG4gICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKHJlZnJlc2gpO1xuICAgICAgICAgICAgcmVmcmVzaCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdicm9hZGNhc3QgZmFpbGVkJylcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlZnJlc2ggPSAkaW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Jyb2FkY2FzdCcpXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRicm9hZGNhc3QoJ3JlZnJlc2hEYXRhJyk7XG4gICAgICAgICAgICB9LCAkc2NvcGUucmVmcmVzaF9pbnRlcnZhbCoxMDAwKTtcbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5yZWZyZXNoX2VuYWJsZWQgPSBhbmd1bGFyLmlzRGVmaW5lZChyZWZyZXNoKVxuXG4gICAgfVxuXG4gICAgXG5cbiAgICAkc2NvcGUuc2VsZWN0ZWREYXNoYm9hcmQgPSBkYXNoYm9hcmQuYWN0aXZlKCk7XG5cbiAgICAkc2NvcGUuZWRpdERhc2hib2FyZCA9IGZ1bmN0aW9uKGV2LCBpbmRleCkge1xuICAgICAgICAvLyBNYWtlIGEgYmFja3VwIGNvcHkgb2YgY3VycmVudCBkYXNoYm9hcmRzXG4gICAgICAgICRzY29wZS5iYWNrdXBEYXNoYm9hcmRzID0gYW5ndWxhci5jb3B5KCRzY29wZS5kYXNoYm9hcmRzKTtcblxuICAgICAgICAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgICBjb250cm9sbGVyOiBcImVkaXREYXNoYm9hcmRDb250cm9sbGVyXCIsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3BhcnRpYWxzL2FkZERhc2hib2FyZC5odG1sJyxcbiAgICAgICAgICAgIHBhcmVudDogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpLFxuICAgICAgICAgICAgdGFyZ2V0RXZlbnQ6IGV2LFxuICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTogdHJ1ZSxcbiAgICAgICAgICAgIGZ1bGxzY3JlZW46IHRydWUsXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKGFuc3dlcikge1xuICAgICAgICAgICAgZGFzaGJvYXJkLnNhdmUoKTtcbiAgICAgICAgICAgICRzY29wZS5yZWZyZXNoX2ludGVydmFsID0gJHNjb3BlLmRhc2hib2FyZFNldHRpbmdzLmludGVydmFsO1xuICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRzY29wZS5kYXNoYm9hcmRzID0gJHNjb3BlLmJhY2t1cERhc2hib2FyZHM7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUuYmFja3VwRGFzaGJvYXJkcyk7XG4gICAgICAgICAgICAkc2NvcGUuYmFja3VwRGFzaGJvYXJkcyA9IHt9O1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJyZXZlcnRpbmdcIik7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgICRzY29wZS4kb24oJ3N3aXRjaERhc2hib2FyZCcsIGZ1bmN0aW9uKGV2LCBpbmRleCkge1xuICAgICAgICBkZWxldGUgJGxvY2FsU3RvcmFnZVsndGltZXN0YW1wJ107XG4gICAgICAgIGRhc2hib2FyZC5zd2l0Y2goaW5kZXgpXG4gICAgICAgICRzY29wZS5zZWxlY3RlZERhc2hib2FyZCA9IGRhc2hib2FyZC5hY3RpdmUoKTtcbiAgICAgICAgLy9jb25zb2xlLmxvZygpXG4gICAgICAgICRzY29wZS4kYnJvYWRjYXN0KCdyZWxvYWREYXNoYm9hcmQnKTtcbiAgICB9KTtcbiAgICBcblxuXG59XSk7XG5cbmFwcC5jb250cm9sbGVyKCdib3gnLCBbXCIkc2NvcGVcIiwgXCIkbG9nXCIsIFwiJG1kRGlhbG9nXCIsIFwiUFJPVE9DT0xTXCIsIFwiVFlQRVNcIiwgXCJDQVRFR09SSUVTXCIsIFwiUElFQ0hBUlRcIiwgXCJBUkVBXCIsIFwiYXBpXCIsIFwidXNlclwiLCBcIiRtZE1lZGlhXCIsIFwiJGxvY2FsU3RvcmFnZVwiLCBcIiR0aW1lb3V0XCIsIFwiZGFzaGJvYXJkXCIsIGZ1bmN0aW9uKCRzY29wZSwgJGxvZywgJG1kRGlhbG9nLCBQUk9UT0NPTFMsIFRZUEVTLCBDQVRFR09SSUVTLCBQSUVDSEFSVCwgQVJFQSwgYXBpLCB1c2VyLCAkbWRNZWRpYSwgJGxvY2FsU3RvcmFnZSwgJHRpbWVvdXQsIGRhc2hib2FyZCl7XG4gICAgXG4gICAgZnVuY3Rpb24gdGltZVNoaWZ0KG9mZnNldCkge1xuICAgICAgICAvL2NvbnNvbGUubG9nKG9mZnNldClcbiAgICAgICAgb2Zmc2V0ID0gYW5ndWxhci5pc0RlZmluZWQob2Zmc2V0KSA/IG9mZnNldCA6IDA7XG4gICAgICAgICRzY29wZS5ib3guY29uZmlnLmJlZ2ludGltZSA9IChmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgdmFyIG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBzaGlmdF90aW1lID0gKE51bWJlcihvZmZzZXQpICsgTnVtYmVyKCRzY29wZS5ib3guY29uZmlnLnBlcmlvZCkpKjYwKjYwKjEwMDA7XG4gICAgICAgICAgICB2YXIgc2hpZnRlZCA9IG5vdy5nZXRUaW1lKCkgLSBzaGlmdF90aW1lO1xuICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3Ioc2hpZnRlZC8xMDAwKTtcbiAgICAgICAgfSkoKTtcblxuICAgICAgICAkc2NvcGUuYm94LmNvbmZpZy5lbmR0aW1lID0gKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIG5vdyA9IG5ldyBEYXRlKCk7XG5cbiAgICAgICAgICAgIG5vdy5zZXRUaW1lKG5vdy5nZXRUaW1lKCkgLSBOdW1iZXIob2Zmc2V0KSo2MCo2MCoxMDAwKTtcbiAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKG5vdy8xMDAwKTtcbiAgICAgICAgfSkoKTtcbiAgICB9XG5cbiAgICB0aW1lU2hpZnQoJHNjb3BlLmRhc2hib2FyZC5zZXR0aW5ncy50aW1lc2hpZnQpO1xuXG4gICAgJHNjb3BlLmJveC5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgXG4gICAgJHNjb3BlLm9wZW5NZW51ID0gZnVuY3Rpb24oJG1kT3Blbk1lbnUsIGV2KSB7XG4gICAgICAgIG9yaWdpbmF0b3JFdiA9IGV2O1xuICAgICAgICAkbWRPcGVuTWVudShldik7XG4gICAgfTtcblxuICAgICRzY29wZS5iYWNrdXBNb2RlbCA9IHt9O1xuXG4gICAgJHNjb3BlLnByb3RvY29sID0gUFJPVE9DT0xTO1xuICAgICRzY29wZS50eXBlcyA9IFRZUEVTO1xuICAgICRzY29wZS5jYXRlZ29yaWVzID0gQ0FURUdPUklFUztcbiAgICBcbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgLy8gRWRpdCBtb2RlIGhhbmRsaW5nXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgLy8gVHJpZ2dlciBlZGl0aW5nIG1vZGUgYW5kIHNhdmUgY3VycmVudCBzdGF0ZVxuICAgICRzY29wZS5lZGl0ID0gZnVuY3Rpb24oYm94KSB7XG4gICAgICAgICRzY29wZS5lZGl0TW9kZSA9IHRydWU7XG4gICAgICAgICRzY29wZS5iYWNrdXBNb2RlbCA9IGFuZ3VsYXIuY29weShib3gpO1xuICAgIH1cblxuICAgIC8vIFNhdmUgY2hhbmdlcyBhbmQgZGlzYWJsZSBlZGl0IG1vZGVcbiAgICAkc2NvcGUuc2F2ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBkYXNoYm9hcmQuc2F2ZSgpOyBcblxuICAgICAgICAkc2NvcGUuYmFja3VwTW9kZWwgPSB7fTtcblxuICAgICAgICAkc2NvcGUuYm94LmNvbmZpZy50eXBlID0gJHNjb3BlLmJveC50eXBlO1xuICAgICAgICBcbiAgICAgICAgLy8gRGlzYWJsZSBlZGl0IG1vZGVcbiAgICAgICAgJHNjb3BlLmVkaXRNb2RlID0gZmFsc2U7XG5cbiAgICAgICAgY2FjaGVfdGltZSA9IDMwMCArIDEwO1xuXG4gICAgICAgIC8vIEdldCByZXF1aXJlZCBkYXRhXG4gICAgICAgIGdldERhdGEoKTtcbiAgICB9XG5cbiAgICAvLyBSZXZlcnQgdG8gb3JpZ2luYWwgYW5kIGRpc2FibGUgZWRpdCBtb2RlXG4gICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uKGJveCkge1xuICAgICAgICAkc2NvcGUuYm94ID0gYW5ndWxhci5jb3B5KCRzY29wZS5iYWNrdXBNb2RlbCk7XG4gICAgICAgICRzY29wZS5iYWNrdXBNb2RlbCA9IHt9O1xuICAgIH1cbiAgICBcbiAgICAkc2NvcGUudG9wID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRpbWVTaGlmdCgkc2NvcGUuYm94LnNldHRpbmdzLnRpbWVzaGlmdClcbiAgICAgICAgYXBpLmdldCgndG9wJywgJHNjb3BlLmJveC5jb25maWcsIHRydWUpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAkc2NvcGUuYm94LmRhdGEgPSBkYXRhO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIHZhciBjYWNoZV90aW1lID0gKG5ldyBEYXRlKCkgLSBuZXcgRGF0ZSgkbG9jYWxTdG9yYWdlWyd0aW1lc3RhbXAnXSkpLzEwMDA7XG4gICAgaWYgKGlzTmFOKGNhY2hlX3RpbWUpKVxuICAgICAgICBjYWNoZV90aW1lID0gMzAwICsgMTA7XG5cbiAgICAvLyBTaG93IGxvYWRpbmcgaW5kaWNhdG9yXG4gICAgaWYgKGNhY2hlX3RpbWUgPCAzMDApIHtcbiAgICAgICAgJHNjb3BlLmJveC5sb2FkaW5nID0gZmFsc2U7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICAkc2NvcGUuYm94LmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAvL2NvbnNvbGUubG9nKCdEYXRhIGlzIG5vdCBjYWNoZWQsIHJlZHJhdycpXG4gICAgfVxuXG4gICAgJHNjb3BlLiRvbignZ3JpZHN0ZXItaXRlbS1pbml0aWFsaXplZCcsIGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgaWYgKCRzY29wZS5ib3gudHlwZSA9PSAncGllY2hhcnQnIHx8ICRzY29wZS5ib3gudHlwZSA9PSAnYmFyY2hhcnQnKSB7XG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHsgJHNjb3BlLiRlbWl0KCdyZXF1ZXN0UmVkcmF3Jyk7fSwgNTAwKTtcbiAgICAgICAgfVxuICAgIH0pXG5cbiAgICBmdW5jdGlvbiBnZXREYXRhKCkge1xuICAgICAgICB0aW1lU2hpZnQoJHNjb3BlLmRhc2hib2FyZC5zZXR0aW5ncy50aW1lc2hpZnQpO1xuICAgICAgICBpZiAoJHNjb3BlLmJveC50eXBlID09IFwicGllY2hhcnRcIiB8fCAkc2NvcGUuYm94LnR5cGUgPT0gXCJiYXJjaGFydFwiKSB7XG4gICAgICAgICAgICAvLyBUaGUgYm94IGlzIGEgY2hhcnRcbiAgICAgICAgICAgIGlmICgkc2NvcGUuYm94LnR5cGUgPT0gJ3BpZWNoYXJ0Jykge1xuICAgICAgICAgICAgICAgICRzY29wZS5ib3gub3B0aW9ucyA9IFBJRUNIQVJULm9wdGlvbnM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoJHNjb3BlLmJveC50eXBlID09ICdiYXJjaGFydCcpIHtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCRzY29wZS5ib3gudGl0bGUgKyBcIjogXCIgKyAkc2NvcGUuYm94LnNlbGVjdG9yKVxuICAgICAgICAgICAgICAgICRzY29wZS5ib3gub3B0aW9ucyA9IGFuZ3VsYXIuY29weShBUkVBLm9wdGlvbnMpO1xuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuYm94LnNlbGVjdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5ib3gub3B0aW9ucy5jaGFydC55QXhpcy5heGlzTGFiZWwgPSBcIkZsb3cgQ291bnRcIjtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmJveC5vcHRpb25zLmNoYXJ0LnkgPSBmdW5jdGlvbihkKSB7IHJldHVybiBOdW1iZXIoZC5GbG93Q291bnQpfSBcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYm94Lm9wdGlvbnMuY2hhcnQueUF4aXMuYXhpc0xhYmVsID0gXCJFdmVudHMgQ291bnRcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgIFxuICAgICAgICAgICAgJHNjb3BlLmJveC5jb25maWcudHlwZSA9ICRzY29wZS5ib3gudHlwZTtcblxuICAgICAgICAgICAgaWYgKGNhY2hlX3RpbWUgPiAzMDApIHtcblxuICAgICAgICAgICAgICAgIHZhciBxdWVyeSA9IGFuZ3VsYXIuY29weSgkc2NvcGUuYm94LmNvbmZpZyk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5ib3guY29uZmlnLm1ldHJpYyA9PSBcImN1c3RvbVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5Lm1ldHJpYyA9IHF1ZXJ5LmN1c3RvbV9tZXRyaWM7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZm9yKGl0ZW0gaW4gcXVlcnkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgaWYocXVlcnlbaXRlbV0gPT0gXCJcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5W2l0ZW1dID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhxdWVyeSlcbiAgICAgICAgICAgICAgICBhcGkuZ2V0KCdhZ2cnLCBxdWVyeSwgZmFsc2UsIHRydWUpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYm94LmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmJveC5kYXRhID0gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRlbWl0KCdyZXF1ZXN0UmVkcmF3Jyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoJHNjb3BlLmJveC50eXBlID09ICd0b3AnICYmIGNhY2hlX3RpbWUgPiAzMDApIHtcbiAgICAgICAgICAgIGFwaS5nZXQoJ3RvcCcsICRzY29wZS5ib3guY29uZmlnLCBmYWxzZSwgdHJ1ZSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmJveC5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmJveC5kYXRhID0gZGF0YTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSBpZiAoJHNjb3BlLmJveC50eXBlID09ICdzdW0nICYmIGNhY2hlX3RpbWUgPiAzMDApIHtcbiAgICAgICAgICAgIGFwaS5nZXQoJ2NvdW50JywgJHNjb3BlLmJveC5jb25maWcsIGZhbHNlLCB0cnVlKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYm94LmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYm94LmRhdGEgPSBkYXRhO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBnZXREYXRhKCk7XG5cblxuICAgICRzY29wZS4kb24oJ3JlZnJlc2hEYXRhJywgZnVuY3Rpb24oKSB7IFxuICAgICAgICAvL2NvbnNvbGUubG9nKCdyZWZyZXNoaW5nJyk7IFxuICAgICAgICBjYWNoZV90aW1lID0gMzAwKzEwOyBcbiAgICAgICAgZ2V0RGF0YSgpO1xuICAgIH0pXG4gXG4gICAgJHNjb3BlLiRvbignc2F2ZVVzZXInLCBmdW5jdGlvbigpIHtcbiAgICAgICAgZGFzaGJvYXJkLnNhdmUoKTsgXG4gICAgfSk7XG5cbiAgICAkc2NvcGUuJG9uKCdncmlkc3Rlci1pdGVtLXJlc2l6ZWQnLCBmdW5jdGlvbihncmlkc3Rlcikge1xuICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcInJlcXVlc3QgYWNjZXB0ZWRcIik7XG4gICAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdyZXNpemUnKSk7XG4gICAgICAgIH0sIDEwMCk7XG4gICAgfSlcblxuXG4gICAgJHNjb3BlLnNob3dFZGl0ID0gZnVuY3Rpb24oZXYsIGJveCkge1xuICAgICAgICAkc2NvcGUuYmFja3VwTW9kZWwgPSBhbmd1bGFyLmNvcHkoJHNjb3BlLmJveCk7XG5cbiAgICAgICAgJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ2VkaXRCb3hDb250cm9sbGVyJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncGFydGlhbHMvZWRpdC5odG1sJyxcbiAgICAgICAgICAgIHBhcmVudDogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpLFxuICAgICAgICAgICAgdGFyZ2V0RXZlbnQ6IGV2LFxuICAgICAgICAgICAgY2xpY2tPdXRzaWRlVG9DbG9zZTp0cnVlLFxuICAgICAgICAgICAgZnVsbHNjcmVlbjogdHJ1ZSxcbiAgICAgICAgICAgIGxvY2Fsczoge1xuICAgICAgICAgICAgICAgIGJveDogJHNjb3BlLmJveFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24oYW5zd2VyKSB7XG4gICAgICAgICAgICAkc2NvcGUuc2F2ZSgpO1xuICAgICAgICB9LCBmdW5jdGlvbigpIHsgLy8gY2FuY2VsXG4gICAgICAgICAgICAkc2NvcGUuYm94ID0gYW5ndWxhci5jb3B5KCRzY29wZS5iYWNrdXBNb2RlbCk7XG4gICAgICAgICAgICAkc2NvcGUuYmFja3VwTW9kZWwgPSB7fTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICB9O1xuXG4gIFxufV0pO1xuXG5hcHAuY29udHJvbGxlcignZ3JpZCcsIFtcIiRzY29wZVwiLCBcIiR0aW1lb3V0XCIsIFwiJGxvZ1wiLCBcIiRyb3V0ZVwiLCBcInVzZXJcIiwgXCJkYXNoYm9hcmRcIiwgZnVuY3Rpb24oJHNjb3BlLCAkdGltZW91dCwgJGxvZywgJHJvdXRlLCB1c2VyLCBkYXNoYm9hcmQpIHtcbiAgICAkc2NvcGUub3B0ID0ge1xuICAgICAgICBvdXRlck1hcmdpbjogZmFsc2UsXG4gICAgICAgIGNvbHVtbnM6IDgsXG4gICAgICAgIHB1c2hpbmc6IHRydWUsXG4gICAgICAgIHJvd0hlaWdodDogMTcwLFxuICAgICAgICBjb2xXaWR0aCA6ICdhdXRvJyxcbiAgICAgICAgZmxvYXRpbmc6IHRydWUsXG4gICAgICAgIHN3YXBwaW5nOiB0cnVlLFxuICAgICAgICBtb2JpbGVCcmVha1BvaW50OiA5MzMsXG4gICAgICAgIGRyYWdnYWJsZToge1xuICAgICAgICAgICAgZW5hYmxlZDogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICAgIHJlc2l6YWJsZToge1xuICAgICAgICAgICAgZW5hYmxlZDogZmFsc2UsXG4gICAgICAgICAgICBoYW5kbGVzOiBbJ24nLCAnZScsICdzJywgJ3cnLCAnc2UnLCAnc3cnXSxcbiAgICAgICAgICAgIHN0b3A6IGZ1bmN0aW9uKGV2ZW50LCAkZWxlbWVudCwgd2lkZ2V0KSB7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcInJlc2l6ZSBlbmRcIik7XG4gICAgICAgICAgICAgICAgJHNjb3BlLiRlbWl0KCdyZXF1ZXN0UmVkcmF3Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAkc2NvcGUuZGFzaGJvYXJkID0gZGFzaGJvYXJkLmdldCgpO1xuICAgICRzY29wZS5pdGVtcyA9ICRzY29wZS5kYXNoYm9hcmQuaXRlbXM7XG4gICAgLy9jb25zb2xlLmxvZygkc2NvcGUuaXRlbXMpO1xuXG4gICAgJHNjb3BlLiRvbignZW5hYmxlR3JpZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoJHNjb3BlLm9wdC5yZXNpemFibGUuZW5hYmxlZCA9PSB0cnVlKSB7XG4gICAgICAgICAgICAkc2NvcGUuJGJyb2FkY2FzdCgnc2F2ZVVzZXInKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgJHNjb3BlLm9wdC5yZXNpemFibGUuZW5hYmxlZCA9ICEkc2NvcGUub3B0LnJlc2l6YWJsZS5lbmFibGVkOyBcbiAgICAgICAgJHNjb3BlLm9wdC5kcmFnZ2FibGUuZW5hYmxlZCA9ICEkc2NvcGUub3B0LmRyYWdnYWJsZS5lbmFibGVkOyBcbiAgICB9KVxuXG4gICAgJHNjb3BlLnJlbW92ZSA9IGZ1bmN0aW9uKGJveCkge1xuICAgICAgICB2YXIgdG1wID0gJHNjb3BlLml0ZW1zLnNwbGljZSgkc2NvcGUuaXRlbXMuaW5kZXhPZihib3gpLCAxKTtcbiAgICAgICAgJHNjb3BlLiRicm9hZGNhc3QoJ3NhdmVVc2VyJyk7XG4gICAgfTtcblxuICAgICRzY29wZS4kb24oJ2FkZEl0ZW0nLCBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGl0ZW0gPSB7XG4gICAgICAgICAgICBcInRpdGxlXCIgOiBcIk5ldyBib3hcIixcbiAgICAgICAgICAgIFwibG9hZGluZ1wiIDogZmFsc2UsXG4gICAgICAgICAgICBzaXplWDogMSxcbiAgICAgICAgICAgIHNpemVZOiAxLFxuICAgICAgICAgICAgY29udGVudDogXCJcIixcbiAgICAgICAgICAgIGNvbmZpZyA6IHtcbiAgICAgICAgICAgICAgICBwZXJpb2QgOiAwXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL3JvdyA6IHJvdyxcbiAgICAgICAgICAgIC8vY29sIDogY29sXG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUuaXRlbXMucHVzaChpdGVtKVxuICAgIH0pO1xuXG4gICAgXG5cbiAgICAkc2NvcGUuJG9uKCdyZWxvYWREYXNoYm9hcmQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgJHNjb3BlLmRhc2hib2FyZCA9IGRhc2hib2FyZC5nZXQoKTtcbiAgICAgICAgJHNjb3BlLml0ZW1zID0gJHNjb3BlLmRhc2hib2FyZC5pdGVtcztcbiAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLmRhc2hib2FyZCk7XG4gICAgICAgICRzY29wZS4kZW1pdCgncmVxdWVzdFJlZHJhdycpXG4gICAgfSlcblxuXG5cblxufV0pXG5cblxuYXBwLmNvbnRyb2xsZXIoJ2VkaXRCb3hDb250cm9sbGVyJywgW1wiJHNjb3BlXCIsIFwiJG1kRGlhbG9nXCIsIFwiYm94XCIsIFwiUFJPVE9DT0xTXCIsIFwiVFlQRVNcIiwgXCJDQVRFR09SSUVTXCIsIGZ1bmN0aW9uKCRzY29wZSwgJG1kRGlhbG9nLCBib3gsIFBST1RPQ09MUywgVFlQRVMsIENBVEVHT1JJRVMpIHtcbiAgICBcbiAgICAkc2NvcGUuYm94ID0gYm94O1xuICAgIFxuICAgICRzY29wZS5iYWNrdXBNb2RlbCA9IGFuZ3VsYXIuY29weShib3gpO1xuXG4gICAgJHNjb3BlLmNhdGVnb3JpZXMgPSBDQVRFR09SSUVTO1xuICAgICRzY29wZS5wcm90b2NvbHMgPSBQUk9UT0NPTFM7XG4gICAgJHNjb3BlLnR5cGVzID0gVFlQRVM7XG5cbiAgICAkc2NvcGUuc2F2ZUFuZENsb3NlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4gICAgfTtcbiAgICAkc2NvcGUuYW5zd2VyID0gZnVuY3Rpb24oYW5zd2VyKSB7XG4gICAgICAgICRtZERpYWxvZy5oaWRlKGFuc3dlcik7XG4gICAgfTtcblxuXG4gICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uKGJveCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIkNhbmNlbGxpbmdcIik7XG4gICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbiAgICB9XG5cbiAgICAkc2NvcGUuY2hhbmdlU2VsZWN0b3IgPSBmdW5jdGlvbihzZWwpIHtcbiAgICAgICAgLy9hbmd1bGFyLmZvckVhY2goJHNjb3BlLmJveC5kYXRhLCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgICAgIC8vICAgIGFuZ3VsYXIuZm9yRWFjaCh2YWx1ZS52YWx1ZXMsIGZ1bmN0aW9uKHZhbCwgaykge1xuICAgICAgICAvLyAgICAgICAgdmFsWydzZWxlY3RvciddID0gc2VsO1xuICAgICAgICAvLyAgICB9KVxuICAgICAgICAvL30pXG4gICAgICAgIC8vJHNjb3BlLiRlbWl0KCdyZXF1ZXN0UmVkcmF3JylcblxuICAgIH1cblxuXG59XSk7XG5cbmFwcC5jb250cm9sbGVyKCdhZGREYXNoYm9hcmRDb250cm9sbGVyJywgW1wiJHNjb3BlXCIsIFwiJG1kRGlhbG9nXCIsIFwiZGFzaGJvYXJkXCIsIGZ1bmN0aW9uKCRzY29wZSwgJG1kRGlhbG9nLCBkYXNoYm9hcmQpIHtcbiAgICBcbiAgICAkc2NvcGUuZWRpdERhc2hib2FyZCA9IGZhbHNlO1xuICAgIFxuICAgICRzY29wZS5zYXZlQW5kQ2xvc2UgPSBmdW5jdGlvbihhbnN3ZXIpIHtcbiAgICAgICAgLy92YXIgbmV3SW5kZXggPSBkYXNoYm9hcmQuYWRkKGFuc3dlcik7XG4gICAgICAgIC8vZGFzaGJvYXJkLnNhdmUoKTtcbiAgICAgICAgJG1kRGlhbG9nLmhpZGUoYW5zd2VyKTtcbiAgICB9O1xuXG5cbiAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24oYm94KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiQ2FuY2VsbGluZ1wiKTtcbiAgICAgICAgJG1kRGlhbG9nLmNhbmNlbCgpO1xuICAgIH1cblxufV0pO1xuXG5cbmFwcC5jb250cm9sbGVyKCdlZGl0RGFzaGJvYXJkQ29udHJvbGxlcicsIFtcIiRzY29wZVwiLCBcIiRyb290U2NvcGVcIiwgXCIkbWREaWFsb2dcIiwgXCJkYXNoYm9hcmRcIiwgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCAkbWREaWFsb2csIGRhc2hib2FyZCkge1xuICAgIFxuICAgIC8vIExvYWQgZGFzaGJvYXJkIHNldHRpbmdzXG4gICAgJHNjb3BlLmRiID0gZGFzaGJvYXJkLnNldHRpbmdzKCk7XG5cbiAgICAvLyBWYXJpYmxlIHRvIGRpZmZlcmVudGlhdGUgYmV0d2VlbiBlZGl0aW5nIGFuZCBhZGRpbmcgYSBkYXNoYm9hcmRcbiAgICAvLyBXZSBhcmUgdXNpbmcgdGhlIHNhbWUgcGFydGlhbCB0byBkaXNwbGF5IHdpdGhpbiBkaWFsb2dcbiAgICAkc2NvcGUuZWRpdERhc2hib2FyZCA9IHRydWU7XG5cbiBcbiAgICAkc2NvcGUuc2F2ZUFuZENsb3NlID0gZnVuY3Rpb24oYW5zd2VyKSB7XG4gICAgICAgIGRhc2hib2FyZC51cGRhdGUoYW5zd2VyKTtcbiAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLmRlbGV0ZURhc2hib2FyZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBkYXNoYm9hcmQuZGVsZXRlKCk7XG4gICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnc3dpdGNoRGFzaGJvYXJkJywgMCk7XG4gICAgICAgIGRhc2hib2FyZC5zYXZlKCk7XG4gICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4gICAgfVxuXG5cbiAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24oYm94KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiQ2FuY2VsbGluZ1wiKTtcbiAgICAgICAgJG1kRGlhbG9nLmNhbmNlbCgpO1xuICAgIH1cblxufV0pO1xuXG5hcHAuY29udHJvbGxlcignbG9naW5Db250cm9sbGVyJywgW1wiJHNjb3BlXCIsIFwiJGxvY2F0aW9uXCIsIFwiJGxvZ1wiLCBcInVzZXJcIiwgZnVuY3Rpb24oJHNjb3BlLCAkbG9jYXRpb24sICRsb2csIHVzZXIpIHtcblx0JHNjb3BlLnRpdGxlID0gXCJMb2dpbiB0byBOZW1lYSBEYXNoYm9hcmRcIjtcblx0JHNjb3BlLmxvZ2luQnRuID0gXCJMb2dpblwiO1xuICAgIFxuICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbihjcmVkKSB7XG5cdFx0JHNjb3BlLmxvZ2luQnRuID0gXCJBdXRoZW50aWNhdGluZy4uLlwiO1xuICAgICAgICAkc2NvcGUubG9naW5CdG5EaXNhYmxlZCA9IHRydWU7XG5cbiAgICAgICAgdXNlci5hdXRoKGNyZWQpXG4gICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7ICAgIFxuICAgICAgICB9KVxuICAgICAgICAuZXJyb3IoZnVuY3Rpb24obXNnKSB7XG4gICAgICAgICAgICAkc2NvcGUuZXJyb3JfbWVzID0gbXNnO1xuICAgICAgICAgICAgJHNjb3BlLmxvZ2luQnRuID0gXCJMb2dpblwiXG4gICAgICAgICAgICAkc2NvcGUubG9naW5CdG5EaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICB9KVxuICAgIH1cblxuXG4gICAgdmFyIHBhdHRlcm4gPSBUcmlhbmdsaWZ5KHtcbiAgICAgICAgd2lkdGg6IHdpbmRvdy5pbm5lcldpZHRoLFxuICAgICAgICBoZWlnaHQ6IHdpbmRvdy5pbm5lckhlaWdodCxcbiAgICAgICAgeF9jb2xvcnM6ICdHbkJ1JyxcbiAgICAgICAgeV9jb2xvcnM6ICdHbkJ1JyxcbiAgICAgICAgY2VsbF9zaXplOiA1MFxuXG4gICAgfSk7XG5cbiAgICBjb25zb2xlLmxvZyhwYXR0ZXJuKTtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvZ2luXCIpLmFwcGVuZENoaWxkKHBhdHRlcm4uY2FudmFzKCkpXG5cblxuXHRcdFxuXHRcdC8qbG9naW5BdXRoLmZldGNoVXNlcih1c2VyKVxuXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcblxuXHRcdFx0JGxvZy5pbmZvKGRhdGEpO1xuXG5cdFx0XHRpZiAoZGF0YVtcInN1Y2Nlc3NcIl0gPT0gdHJ1ZSkge1xuXHRcdFx0XHQvLyRsb2cuaW5mbyhkYXRhKTtcdFxuXHRcdFx0XHQkc2NvcGUubG9naW5CdG4gPSBcIlN1Y2Nlc3NcIjtcblx0XHRcdFx0JGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuXHRcdFx0XHRsb2NhbFN0b3JhZ2VTZXJ2aWNlLnNldCgnbG9nZ2VkSW4nLCB0cnVlKTtcblx0XHRcdFx0bG9jYWxTdG9yYWdlU2VydmljZS5zZXQoJ2xvZ2dlZEluLnB3Jywgc2hhMjU2X2RpZ2VzdChkYXRhLnBhc3N3b3JkKSk7XHRcblx0XHRcdH1cblx0XHRcdGVsc2Uge1xuXHRcdFx0XHQkbG9nLmVycm9yKFwiZXJyb3IgLSBiYWQgcGFzc3dvcmRcIik7XG5cdFx0XHRcdCRzY29wZS5lcnJvcl9tZXMgPSBcIkJhZCBwYXNzd29yZFwiO1xuXHRcdFx0XHQkc2NvcGUubG9naW5CdG4gPSBcIkxvZ2luXCI7XG5cdFx0XHRcdGxvZ2luQ29ycmVjdCA9IGZhbHNlO1xuXHRcdFx0XHRsb2NhbFN0b3JhZ2VTZXJ2aWNlLnNldCgnbG9nZ2VkSW4nLCBmYWxzZSk7XHRcblx0XHRcdH1cblx0XHR9KTsqL1xufV0pO1xuXG5cblxuYXBwLmNvbnRyb2xsZXIoJ3Byb2ZpbGVDb250cm9sbGVyJywgW1wiJHNjb3BlXCIsIFwiJGxvZ1wiLCBcIiRsb2NhbFN0b3JhZ2VcIiwgXCJ1c2VyXCIsIFwiZGFzaGJvYXJkXCIsIGZ1bmN0aW9uKCRzY29wZSwgJGxvZywgJGxvY2FsU3RvcmFnZSwgdXNlciwgZGFzaGJvYXJkKSB7XG4gICAgJHNjb3BlLnVzZXIgPSB1c2VyLmdldCgpO1xuXG4gICAgJHNjb3BlLnNhdmVfYnRuID0gXCJTYXZlXCI7XG5cbiAgICAkc2NvcGUuZWRpdFVzZXIgPSBmdW5jdGlvbih1c2VyX2RhdGEpIHtcbiAgICAgICAgJHNjb3BlLnNhdmVfYnRuID0gXCJQcm9jZXNzaW5nLi4uXCI7XG5cbiAgICAgICAgdXNlcl9kYXRhW1wic2V0dGluZ3NcIl0gPSBkYXNoYm9hcmQuY2xlYW4oKTtcblxuICAgICAgICB1c2VyLnB1dCh1c2VyX2RhdGEsIHRydWUpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgJGxvY2FsU3RvcmFnZVtcInRva2VuXCJdID0gZGF0YVtcImp3dFwiXTtcbiAgICAgICAgICAgICRzY29wZS5lcnJfbXNnID0gXCJcIjtcbiAgICAgICAgICAgICRzY29wZS51c2VyID0gYW5ndWxhci5jb3B5KHVzZXIuZ2V0KCkpO1xuICAgICAgICAgICAgJHNjb3BlLnNhdmVfYnRuID0gXCJTYXZlXCI7XG4gICAgICAgIH0pXG4gICAgICAgIC5lcnJvcihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAkc2NvcGUuc2F2ZV9idG4gPSBcIlNhdmVcIjtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgJGxvZy5lcnJvcihkYXRhW1wiZXJyb3JcIl0pO1xuICAgICAgICAgICAgJHNjb3BlLnVzZXIucGFzc3dvcmQgPSBcIlwiO1xuICAgICAgICAgICAgJHNjb3BlLmVycl9tc2cgPSBkYXRhW1wiZXJyb3JcIl07XG4gICAgICAgIH0pXG4gICAgfVxufV0pXG5cbmFwcC5jb250cm9sbGVyKCd1c2Vyc0NvbnRyb2xsZXInLCBbXCIkc2NvcGVcIiwgXCJhcGlcIiwgXCJ1c2VyXCIsIFwiJG1kRGlhbG9nXCIsIGZ1bmN0aW9uKCRzY29wZSwgYXBpLCB1c2VyLCAkbWREaWFsb2cpIHtcbiAgICBcbiAgICB1c2VyLmdldCh0cnVlKS5zdWNjZXNzKGZ1bmN0aW9uKGQpIHskc2NvcGUucGVvcGxlID0gZH0pO1xuXG4gICAgLy8kc2NvcGUudXNlcnMgPSB1c2VycztcbiAgICAvKi5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgY29uc29sZS5sb2coZGF0YSlcbiAgICAgICAgJHNjb3BlLnVzZXJzID0gZGF0YTtcbiAgICB9KTsqL1xuXG5cbiAgICAkc2NvcGUubXlVc2VybmFtZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdG1wID0gdXNlci5nZXQoKTtcbiAgICAgICAgcmV0dXJuIHRtcFsndXNlcm5hbWUnXTtcbiAgICB9XG5cbiAgICAkc2NvcGUuZGVsZXRlVXNlciA9IGZ1bmN0aW9uKHVzZXJfaWQpIHtcbiAgICAgICAgY29uc29sZS5sb2codXNlcl9pZCk7XG4gICAgICAgIHVzZXIuZGVsZXRlKHVzZXJfaWQpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICB1c2VyLmdldCh0cnVlKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUudXNlcnMgPSBkYXRhO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgJHNjb3BlLmFkZFVzZXIgPSBmdW5jdGlvbihldikge1xuICAgICAgICAkc2NvcGUuYWRkVXNlckJveCA9IHRydWU7XG4gICAgICAgICRtZERpYWxvZy5zaG93KHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdhZGRVc2VyQ29udHJvbGxlcicsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3BhcnRpYWxzL2FkZFVzZXIuaHRtbCcsXG4gICAgICAgICAgICBwYXJlbnQ6IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcbiAgICAgICAgICAgIHRhcmdldEV2ZW50OiBldixcbiAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6dHJ1ZSxcbiAgICAgICAgICAgIGZ1bGxzY3JlZW46IHRydWUsXG4gICAgICAgICAgICAvKmxvY2Fsczoge1xuICAgICAgICAgICAgICAgIGJveDogJHNjb3BlLmJveFxuICAgICAgICAgICAgfSwqL1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbihhbnN3ZXIpIHtcbiAgICAgICAgICAgIC8vJHNjb3BlLnNhdmUoKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGFuc3dlcilcbiAgICAgICAgICAgIHVzZXIucG9zdChhbnN3ZXIpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuXG4gICAgICAgICAgICAgICAgdXNlci5nZXQodHJ1ZSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS51c2VycyA9IGRhdGE7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9LCBmdW5jdGlvbigpIHsgLy8gY2FuY2VsXG4gICAgICAgICAgICAvLyRzY29wZS5ib3ggPSBhbmd1bGFyLmNvcHkoJHNjb3BlLmJhY2t1cE1vZGVsKTtcbiAgICAgICAgICAgIC8vJHNjb3BlLmJhY2t1cE1vZGVsID0ge307XG4gICAgICAgIH0pO1xuXG4gICAgfVxufV0pO1xuXG5hcHAuY29udHJvbGxlcignYWRkVXNlckNvbnRyb2xsZXInLCBbXCIkc2NvcGVcIiwgXCIkbWREaWFsb2dcIiwgZnVuY3Rpb24oJHNjb3BlLCAkbWREaWFsb2cpIHtcblxuICAgICRzY29wZS51c2VyID0ge1xuICAgICAgICB1c2VybmFtZSA6ICcnLFxuICAgICAgICBuYW1lIDogJycsXG4gICAgICAgIHN1cm5hbWUgOiAnJyxcbiAgICAgICAgcGFzc3dvcmQgOiAnJyxcbiAgICAgICAgc2V0dGluZ3MgOltcblx0XHR7XG5cdFx0XHRcInNldHRpbmdzXCIgOiB7XG5cdFx0XHRcdFwidGl0bGVcIiA6IFwiQmFzaWNcIixcblx0XHRcdFx0XCJ0aW1lc2hpZnRcIiA6IFwiMFwiLFxuXHRcdFx0XHRcImludGVydmFsXCIgOiBcIjYwXCJcblx0XHRcdH0sXG5cdFx0XHRcIml0ZW1zXCIgOiBbXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRcImxvYWRpbmdcIiA6IGZhbHNlLFxuXHRcdFx0XHRcdFwicm93XCIgOiAwLFxuXHRcdFx0XHRcdFwiY29uZmlnXCIgOiB7XG5cdFx0XHRcdFx0XHRcInBlcmlvZFwiIDogXCIyNFwiLFxuXHRcdFx0XHRcdFx0XCJ0eXBlXCIgOiBcInBpZWNoYXJ0XCIsXG5cdFx0XHRcdFx0XHRcIm1ldHJpY1wiIDogXCJjYXRlZ29yeVwiXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRcInNpemVYXCIgOiA0LFxuXHRcdFx0XHRcdFwic2l6ZVlcIiA6IDMsXG5cdFx0XHRcdFx0XCJjb2xcIiA6IDAsXG5cdFx0XHRcdFx0XCJ0aXRsZVwiIDogXCIyNGggc2hhcmVzXCIsXG5cdFx0XHRcdFx0XCJ0eXBlXCIgOiBcInBpZWNoYXJ0XCIsXG5cdFx0XHRcdFx0XCJjb250ZW50XCIgOiBcIkNsaWNrIHRoZSBtZW51IGljb24gdG8gc2VsZWN0IGVkaXRcIlxuXHRcdFx0XHR9XG5cdFx0XHRdXG5cdFx0fVxuXHRdXG5cdH1cbiAgICAkc2NvcGUuc2F2ZUFuZENsb3NlID0gZnVuY3Rpb24odXNlcikge1xuICAgICAgICBjb25zb2xlLmxvZyh1c2VyKVxuICAgICAgICAkbWREaWFsb2cuaGlkZSh1c2VyKTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uKGJveCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIkNhbmNlbGxpbmdcIik7XG4gICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbiAgICB9XG59XSlcblxuYXBwLmRpcmVjdGl2ZSgnZ3JpZHN0ZXJEeW5hbWljSGVpZ2h0JywgW1wiJHRpbWVvdXRcIiwgZnVuY3Rpb24gKCR0aW1lb3V0KSB7XG5cbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgaXRlbTogXCI9XCIgLy9ncmlkc3RlciBpdGVtXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGxpbmssXG4gICAgICAgIHJlc3RyaWN0OiAnQSdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG5cbiAgICBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICBzY29wZS4kd2F0Y2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudFswXS5zY3JvbGxIZWlnaHQ7XG4gICAgICAgIH0sXG4gICAgICAgIGZ1bmN0aW9uKG5ld1ZhbCwgb2xkVmFsKSB7IFxuICAgICAgICAgICAgdmFyIHJvd0hlaWdodE9wdGlvbiA9IDI3MDsgLy8gQ2hhbmdlIHRoaXMgdmFsdWUgd2l0aCB5b3VyIG93biByb3dIZWlnaHQgb3B0aW9uXG4gICAgICAgICAgICB2YXIgaGVpZ2h0ID0gcm93SGVpZ2h0T3B0aW9uICogc2NvcGUuaXRlbS5zaXplWTtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coc2NvcGUuaXRlbS50aXRsZSk7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwibmV3VmFsOiBcIiArIG5ld1ZhbCArIFwiICAgICBoZWlnaHQ6IFwiICsgaGVpZ2h0KVxuICAgICAgICAgICAgaWYobmV3VmFsID4gaGVpZ2h0KXtcbiAgICAgICAgICAgICAgICB2YXIgZGl2ID0gTWF0aC5mbG9vcihuZXdWYWwgLyByb3dIZWlnaHRPcHRpb24pO1xuICAgICAgICAgICAgICAgIC8vZGl2Kys7XG4gICAgICAgICAgICAgICAgc2NvcGUuaXRlbS5zaXplWSA9IGRpdjsgXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgfVxufV0pO1xuXG5hcHAuc2VydmljZSgnYXBpJywgW1wiJGh0dHBcIiwgXCIkbG9nXCIsIFwiJG1kVG9hc3RcIiwgXCIkbG9jYWxTdG9yYWdlXCIsIFwiUElFQ0hBUlRcIiwgXCJDT05GSUdcIiwgZnVuY3Rpb24oJGh0dHAsICRsb2csICRtZFRvYXN0LCAkbG9jYWxTdG9yYWdlLCBQSUVDSEFSVCwgQ09ORklHKSB7XG5cblx0dmFyIGFkZHIgPSBDT05GSUdbXCJob3N0XCJdICsgXCI6XCIgKyBDT05GSUdbXCJwb3J0XCJdICsgXCIvXCIgKyBDT05GSUdbXCJ2ZXJzaW9uXCJdICsgXCIvZXZlbnRzL1wiO1xuXG4gICAgdGhpcy5hdXRoID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAkbG9jYWxTdG9yYWdlW1widG9rZW5cIl07XG4gICAgfVxuXG4gICAgdGhpcy5jb25maWcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgJGh0dHAuZ2V0KCdodHRwOi8vYmVuZWZpemlvLmxpYmVyb3V0ZXIub3JnOjU1NTUvY29uZmlnJykuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICB0aGlzLmFkZHIgPSBkYXRhLmhvc3QgKyAnOicgKyBkYXRhLnBvcnQgKyBkYXRhLmV2ZW50cztcbiAgICAgICAgICAgICRsb2NhbFN0b3JhZ2VbJ2NvbmZpZyddID0gZGF0YTtcbiAgICAgICAgICAgIGFsZXJ0KGRhdGEpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICB0aGlzLmdldCA9IGZ1bmN0aW9uKHVybCwgcGFyYW1zLCBpbmZvLCBjYWNoZSkge1xuXHRcdHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICB1cmwgOiBhZGRyICsgdXJsLFxuICAgICAgICAgICAgbWV0aG9kIDogXCJHRVRcIixcbiAgICAgICAgICAgIHBhcmFtcyA6IHBhcmFtcyxcbiAgICAgICAgICAgIGhlYWRlcnMgOiB7XG4gICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nIDogdGhpcy5hdXRoKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgaWYgKGluZm8pIHtcbiAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxuICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdFxuICAgICAgICAgICAgICAgICAgICAgICAgLnNpbXBsZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQoJ0RhdGEgc3VjY2Vzc3VsbHkgbG9hZGVkJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wb3NpdGlvbihcInRvcCByaWdodFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmhpZGVEZWxheSgzMDAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW1lKFwic3VjY2Vzcy10b2FzdFwiKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjYWNoZSlcbiAgICAgICAgICAgICAgICAkbG9jYWxTdG9yYWdlWyd0aW1lc3RhbXAnXSA9IG5ldyBEYXRlKCk7XG5cbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICB9KVxuICAgICAgICAuZXJyb3IoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkbG9nLmVycm9yKCdDYW5ub3QgZmV0Y2ggZGF0YScpO1xuICAgICAgICAgICAgJG1kVG9hc3Quc2hvdyhcbiAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaW1wbGUoKVxuICAgICAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQoJ0Nhbm5vdCBsb2FkIGRhdGEnKVxuICAgICAgICAgICAgICAgICAgICAucG9zaXRpb24oXCJ0b3AgcmlnaHRcIilcbiAgICAgICAgICAgICAgICAgICAgLmhpZGVEZWxheSgzMDAwKVxuICAgICAgICAgICAgICAgICAgICAudGhlbWUoXCJlcnJvci10b2FzdFwiKVxuICAgICAgICAgICAgKTtcblxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICB0aGlzLnBvc3QgPSBmdW5jdGlvbih1cmwsIGRhdGEsIGluZm8pIHtcbiAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoYWRkciArIHVybCwgSlNPTi5zdHJpbmdpZnkoZGF0YSkpXG4gICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKGluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgJG1kVG9hc3Quc2hvdyhcbiAgICAgICAgICAgICAgICAgICAgICAgICRtZFRvYXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNpbXBsZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRleHRDb250ZW50KCdEYXRhIHN1Y2Nlc3NmdWxseSBsb2FkZWQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5wb3NpdGlvbihcInRvcCByaWdodFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoMzAwMClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbWUoXCJzdWNjZXNzLXRvYXN0XCIpXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhOyAgICAgICAgXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgXHQkbG9nLmVycm9yKCdDYW5ub3QgZmV0Y2ggZGF0YScpO1xuICAgICAgICAgICAgICAgICRtZFRvYXN0LnNob3coXG4gICAgICAgICAgICAgICAgICAgICRtZFRvYXN0LnNpbXBsZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQoJ0Nhbm5vdCBmZXRjaCBkYXRhJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wb3NpdGlvbihcInRvcCByaWdodFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmhpZGVEZWxheSgzMDAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW1lKFwiZXJyb3ItdG9hc3RcIilcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSlcbiAgICB9XG5cbiAgICB0aGlzLnB1dCA9IGZ1bmN0aW9uKHVybCwgZGF0YSwgaW5mbykge1xuICAgICAgICByZXR1cm4gJGh0dHAucHV0KGFkZHIgKyB1cmwsIEpTT04uc3RyaW5naWZ5KGRhdGEpKVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmIChpbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgICRtZFRvYXN0LnNob3coXG4gICAgICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zaW1wbGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0Q29udGVudCgnRGF0YSBzdWNjZXNzZnVsbHkgbG9hZGVkJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucG9zaXRpb24oXCJ0b3AgcmlnaHRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaGlkZURlbGF5KDMwMDApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW1lKFwic3VjY2Vzcy10b2FzdFwiKVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTsgICAgICAgIFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIFx0JGxvZy5lcnJvcignQ2Fubm90IGZldGNoIGRhdGEnKTtcbiAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxuICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaW1wbGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRleHRDb250ZW50KCdDYW5ub3QgZmV0Y2ggZGF0YScpXG4gICAgICAgICAgICAgICAgICAgICAgICAucG9zaXRpb24oXCJ0b3AgcmlnaHRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoMzAwMClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVtZShcImVycm9yLXRvYXN0XCIpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pXG4gICAgfVxuXG5cbn1dKTtcblxuXG5cbmFwcC5zZXJ2aWNlKCdkYXNoYm9hcmQnLCBbXCIkbG9nXCIsIFwiJGxvY2FsU3RvcmFnZVwiLCBcInVzZXJcIiwgZnVuY3Rpb24oJGxvZywgJGxvY2FsU3RvcmFnZSwgdXNlcikge1xuXG4gICAgdmFyIHNlbGVjdGVkRGFzaGJvYXJkID0gMDtcbiAgICB2YXIgZGFzaGJvYXJkcyA9ICRsb2NhbFN0b3JhZ2VbJ2Rhc2hib2FyZCddO1xuICAgIHZhciBhY3RpdmUgPSAkbG9jYWxTdG9yYWdlWydkYXNoYm9hcmQnXVtzZWxlY3RlZERhc2hib2FyZF07XG4gICAgdmFyIGJhY2t1cDtcblxuICAgIHRoaXMuZ2V0QWxsID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAkbG9jYWxTdG9yYWdlWydkYXNoYm9hcmQnXTtcbiAgICB9XG5cbiAgICB0aGlzLmdldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gICRsb2NhbFN0b3JhZ2VbJ2Rhc2hib2FyZCddW3NlbGVjdGVkRGFzaGJvYXJkXTtcbiAgICB9XG5cbiAgICB0aGlzLnNldHRpbmdzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAgJGxvY2FsU3RvcmFnZVsnZGFzaGJvYXJkJ11bc2VsZWN0ZWREYXNoYm9hcmRdLnNldHRpbmdzO1xuICAgIH1cblxuICAgIHRoaXMuYWN0aXZlID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKGluZGV4KSkge1xuICAgICAgICAgICAgc2VsZWN0ZWREYXNoYm9hcmQgPSBpbmRleFxuICAgICAgICB9XG5cbiAgICAgICAgLy9hY3RpdmUgPSAkbG9jYWxTdG9yYWdlWydkYXNoYm9hcmQnXVtzZWxlY3RlZERhc2hib2FyZF07XG5cbiAgICAgICAgcmV0dXJuIHNlbGVjdGVkRGFzaGJvYXJkO1xuICAgIH1cblxuICAgIHRoaXMudXBkYXRlID0gZnVuY3Rpb24odXBkYXRlZERhc2hib2FyZCkge1xuICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZCh1cGRhdGVkRGFzaGJvYXJkKSlcbiAgICAgICAgICAgIGFjdGl2ZS5zZXR0aW5ncyA9IDA7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGFjdGl2ZS5zZXR0aW5ncyA9IHVwZGF0ZWREYXNoYm9hcmQ7XG5cbiAgICAgICAgLy9kYXNoYm9hcmRzID0gJGxvY2FsU3RvcmFnZVsnZGFzaGJvYXJkJ107XG4gICAgfVxuXG4gICAgdGhpcy5jbGVhbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgdmFyIHNldHRpbmdzID0gYW5ndWxhci5jb3B5KCRsb2NhbFN0b3JhZ2VbJ2Rhc2hib2FyZCddKTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhzZXR0aW5ncylcbiAgICAgICAgXG4gICAgICAgIC8vIFJlbW92ZSBkYXRhIGFuZCBncmFwaCBvcHRpb25zXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2V0dGluZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coc2V0dGluZ3NbaV0pO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhzZXR0aW5nc1tpXS5pdGVtcy5sZW5ndGgpXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNldHRpbmdzW2ldLml0ZW1zLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHNldHRpbmdzW2ldLml0ZW1zW2pdW1wiZGF0YVwiXTtcbiAgICAgICAgICAgICAgICBkZWxldGUgc2V0dGluZ3NbaV0uaXRlbXNbal1bXCJvcHRpb25zXCJdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNldHRpbmdzO1xuICAgIH1cblxuICAgIHRoaXMuc2F2ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgIFxuICAgICAgICB2YXIgcXVlcnkgPSB7XG4gICAgICAgICAgICBcInNldHRpbmdzXCIgOiB0aGlzLmNsZWFuKClcbiAgICAgICAgfVxuXG4gICAgICAgIC8vY29uc29sZS5sb2cocXVlcnkpXG5cbiAgICAgICAgLy8kbG9nLmluZm8ocXVlcnkpXG4gICAgICAgIHJldHVybiB1c2VyLnB1dChxdWVyeSlcbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAkbG9nLmVycm9yKGRhdGEpXG4gICAgICAgICAgICB9KVxuICAgIH1cblxuICAgIHRoaXMuYWRkID0gZnVuY3Rpb24obmV3RGFzaGJvYXJkKSB7XG4gICAgICAgIC8vIFdlIG5lZWQgdG8gc2V0IHVwIGZpcnN0IGl0ZW0gaW4gZGFzaGJvYXJkIFxuICAgICAgICB2YXIgdG1wRGFzaGJvYXJkID0ge1xuICAgICAgICAgICAgc2V0dGluZ3MgOiBuZXdEYXNoYm9hcmQsXG4gICAgICAgICAgICBpdGVtcyA6IFt7XG4gICAgICAgICAgICAgICAgXCJ0aXRsZVwiIDogXCJOZXcgYm94XCIsXG4gICAgICAgICAgICAgICAgXCJsb2FkaW5nXCIgOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBzaXplWDogMSxcbiAgICAgICAgICAgICAgICBzaXplWTogMSxcbiAgICAgICAgICAgICAgICBjb250ZW50OiBcIkNsaWNrIHRoZSBtZW51IGljb24gdG8gc2VsZWN0IGVkaXRcIixcbiAgICAgICAgICAgICAgICBjb25maWcgOiB7XG4gICAgICAgICAgICAgICAgICAgIHBlcmlvZCA6IFwiMFwiXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XVxuICAgICAgICB9XG5cbiAgICAgICAgJGxvY2FsU3RvcmFnZVsnZGFzaGJvYXJkJ10ucHVzaCh0bXBEYXNoYm9hcmQpO1xuICAgICAgICAvL2NvbnNvbGUubG9nKCAkbG9jYWxTdG9yYWdlWydkYXNoYm9hcmQnXS5sZW5ndGggLSAxKTtcblxuICAgICAgICByZXR1cm4gKCAkbG9jYWxTdG9yYWdlWydkYXNoYm9hcmQnXS5sZW5ndGggLSAxKTtcblxuICAgIH1cblxuICAgIHRoaXMuZGVsZXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGJhY2t1cCA9ICAkbG9jYWxTdG9yYWdlWydkYXNoYm9hcmQnXS5zcGxpY2UoICRsb2NhbFN0b3JhZ2VbJ2Rhc2hib2FyZCddLmluZGV4T2YoYWN0aXZlKSwgMSk7XG4gICAgICAgIHNlbGVjdGVkRGFzaGJvYXJkID0gMDtcblxuICAgICAgICByZXR1cm4gYmFja3VwO1xuICAgIFxuICAgIH1cblxuICAgIHRoaXMuc3dpdGNoID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgYWN0aXZlID0gJGxvY2FsU3RvcmFnZVsnZGFzaGJvYXJkJ11baW5kZXhdO1xuICAgICAgICBzZWxlY3RlZERhc2hib2FyZCA9IGluZGV4O1xuICAgICAgICByZXR1cm4gYWN0aXZlO1xuICAgIH1cblxuICAgIHRoaXMucmVzZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgc2VsZWN0ZWREYXNoYm9hcmQgPSAwO1xuICAgICAgICBhY3RpdmUgPSAkbG9jYWxTdG9yYWdlWydkYXNoYm9hcmQnXVtzZWxlY3RlZERhc2hib2FyZF1cbiAgICB9XG4gICAgICAgIFxufV0pO1xuXG5hcHAuZGlyZWN0aXZlKFwic2lkZWJhck1lbnVcIiwgZnVuY3Rpb24oKSB7XG5cdHJldHVybiB7XG4gICAgICAgIHNjb3BlOiB7XG5cdFx0XHRzZWN0aW9uOiAnPSdcblx0XHR9LFxuXHRcdHRlbXBsYXRlVXJsOiAncGFydGlhbHMvc2lkZWJhci1tZW51Lmh0bWwnLFxuICAgICAgICBjb250cm9sbGVyOiBbXCIkc2NvcGVcIiwgXCIkbWRTaWRlbmF2XCIsIFwiJG1kRGlhbG9nXCIsIFwiJGxvY2F0aW9uXCIsIFwiTUVOVVwiLCBcInVzZXJcIiwgXCJkYXNoYm9hcmRcIiwgZnVuY3Rpb24oJHNjb3BlLCAkbWRTaWRlbmF2LCAkbWREaWFsb2csICRsb2NhdGlvbiwgTUVOVSwgdXNlciwgZGFzaGJvYXJkKSB7XG4gICAgICAgICAgICAkc2NvcGUubWVudSA9IE1FTlU7XG5cbiAgICAgICAgICAgICRzY29wZS5kYXNoYm9hcmRzID0gZGFzaGJvYXJkLmdldEFsbCgpO1xuICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkRGFzaGJvYXJkID0gZGFzaGJvYXJkLmFjdGl2ZSgpO1xuXG4gICAgICAgICAgICAkc2NvcGUuaXNBY3RpdmUgPSBmdW5jdGlvbihjdXJyZW50KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuKCcjJyArICRsb2NhdGlvbi5wYXRoKCkgPT0gY3VycmVudCk7XG4gICAgICAgICAgICB9ICAgXG5cbiAgICAgICAgICAgICRzY29wZS5lbmFibGUgPSB0cnVlO1xuXG4gICAgICAgICAgICAkc2NvcGUudG9nZ2xlSXRlbSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS50b2dnbGVCdG4gPSBcInRvZ2dsZWRcIjtcbiAgICAgICAgICAgIH07XG5cblxuICAgICAgICAgICAgJHNjb3BlLmNsb3NlTGVmdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICRtZFNpZGVuYXYoJ2xlZnQnKS50b2dnbGUoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICRzY29wZS5sb2dvdXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBkYXNoYm9hcmQucmVzZXQoKTtcbiAgICAgICAgICAgICAgICB1c2VyLmxvZ291dCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuYWRkRGFzaGJvYXJkID0gZnVuY3Rpb24oZXYpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkFkZGluZyBuZXcgZGFzaGJvYXJkXCIpO1xuXG4gICAgICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnYWRkRGFzaGJvYXJkQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncGFydGlhbHMvYWRkRGFzaGJvYXJkLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0RXZlbnQ6IGV2LFxuICAgICAgICAgICAgICAgICAgICBjbGlja091dHNpZGVUb0Nsb3NlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBmdWxsc2NyZWVuOiB0cnVlLFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oYW5zd2VyKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdJbmRleCA9IGRhc2hib2FyZC5hZGQoYW5zd2VyKTtcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhuZXdJbmRleClcbiAgICAgICAgICAgICAgICAgICAgZGFzaGJvYXJkLnNhdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRlbWl0KCdzd2l0Y2hEYXNoYm9hcmQnLCBuZXdJbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZERhc2hib2FyZCA9IGRhc2hib2FyZC5hY3RpdmUobmV3SW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICAvKmRhc2hib2FyZC5zd2l0Y2gobmV3SW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWREYXNoYm9hcmQgPSBuZXdJbmRleDtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRicm9hZGNhc3QoJ3JlbG9hZERhc2hib2FyZCcpOyAqL1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKCkgeyAvLyBjYW5jZWxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIC8qZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgLy8kc2NvcGUuJGVtaXQoJ2FkZERhc2hib2FyZCcpO1xuICAgICAgICAgICAgfSovXG5cbiAgICAgICAgICAgICRzY29wZS5zd2l0Y2hEYXNoYm9hcmQgPSBmdW5jdGlvbihpbmRleCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZERhc2hib2FyZCA9IGRhc2hib2FyZC5hY3RpdmUoaW5kZXgpO1xuICAgICAgICAgICAgICAgICRzY29wZS4kZW1pdCgnc3dpdGNoRGFzaGJvYXJkJywgaW5kZXgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuJG9uKCdzd2l0Y2hEYXNoYm9hcmQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInN3aXRjaGluZ1wiKTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWREYXNoYm9hcmQgPSBkYXNoYm9hcmQuYWN0aXZlKCk7XG4gICAgICAgICAgICB9KVxuICAgIFxuIFxuICAgICAgICB9XVxuXHR9O1xufSk7XG5cbmFwcC5kaXJlY3RpdmUoXCJ0b3BiYXJNZW51XCIsIGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4ge1xuXHRcdHNjb3BlOiB7XG5cdFx0XHRzZWN0aW9uOiAnPSdcblx0XHR9LFxuXHRcdHRlbXBsYXRlVXJsOiAncGFydGlhbHMvdG9wYmFyLW1lbnUuaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXIgOiBbXCIkc2NvcGVcIiwgXCIkbWRTaWRlbmF2XCIsIGZ1bmN0aW9uKCRzY29wZSwgJG1kU2lkZW5hdikge1xuICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZUxlZnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkbWRTaWRlbmF2KCdsZWZ0JykudG9nZ2xlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1dXG5cdH07XG59KTtcblxuXG5hcHAuZGlyZWN0aXZlKFwiYm94ZXNcIiwgZnVuY3Rpb24oKSB7XG5cdHJldHVybiB7XG5cdFx0c2NvcGU6IHtcblx0XHRcdHNlY3Rpb246ICc9J1xuXHRcdH0sXG5cdFx0dGVtcGxhdGVVcmw6ICdwYXJ0aWFscy9ib3hlcy5odG1sJ1xuXHR9O1xufSk7XG5cblxuXG5hcHAuc2VydmljZSgndXNlcicsIFtcIiRsb2NhbFN0b3JhZ2VcIiwgXCIkaHR0cFwiLCBcIiRtZFRvYXN0XCIsIFwiJGxvY2F0aW9uXCIsIFwiJGxvZ1wiLCBcIkNPTkZJR1wiLCBmdW5jdGlvbigkbG9jYWxTdG9yYWdlLCAkaHR0cCwgJG1kVG9hc3QsICRsb2NhdGlvbiwgJGxvZywgQ09ORklHKXtcbiAgICB2YXIgY2FjaGUgPSBudWxsO1xuXG4gICAgdmFyIGRhc2hib2FyZCA9IFtdO1xuXG5cdHZhciBhZGRyID0gQ09ORklHW1wiaG9zdFwiXSArIFwiOlwiICsgQ09ORklHW1wicG9ydFwiXSArIFwiL1wiICsgQ09ORklHW1widmVyc2lvblwiXSArIFwiL3VzZXJzL1wiO1xuXG4gICAgdGhpcy5jb25maWcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICRsb2NhbFN0b3JhZ2VbXCJkYXNoYm9hcmRcIl07XG4gICAgfVxuXG4gICAgdGhpcy5qd3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHRva2VuID0gJGxvY2FsU3RvcmFnZVsndG9rZW4nXTtcbiAgICAgICAgdmFyIGJhc2U2NFVybCA9IHRva2VuLnNwbGl0KCcuJylbMV07XG4gICAgICAgIHZhciBiYXNlNjQgPSBiYXNlNjRVcmwucmVwbGFjZSgnLScsICcrJykucmVwbGFjZSgnXycsICcvJyk7XG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKHdpbmRvdy5hdG9iKGJhc2U2NCkpO1xuICAgIH1cblxuICAgIHRoaXMuYXV0aCA9IGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgY29uc29sZS5sb2coYWRkcik7XG4gICAgICAgIHJldHVybiAkaHR0cC5wb3N0KGFkZHIgKyBcImF1dGhcIiwgYW5ndWxhci50b0pzb24odXNlcikpXG4gICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICRsb2NhbFN0b3JhZ2VbXCJ0b2tlblwiXSA9IGRhdGFbXCJqd3RcIl07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFRPRE86IGRpZmZlcmVudGlhdGUgYmV0d2VlbiBjb25maWcgYW5kIGp3dCA+PiBkdXBsaWNpdHlcbiAgICAgICAgICAgIGRlbGV0ZSAkbG9jYWxTdG9yYWdlW1wiZGFzaGJvYXJkXCJdO1xuICAgICAgICAgICAgJGxvY2FsU3RvcmFnZVtcImRhc2hib2FyZFwiXSA9IGRhdGFbXCJzZXR0aW5nc1wiXTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSlcbiAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGVycm9yLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHN0YXR1cylcbiAgICAgICAgICAgIC8vIExldCBpdCBiZSBoYW5kbGVkIGJ5IGNvbnRyb2xsZXJcbiAgICAgICAgICAgIHJldHVybiBlcnJvcjtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICB0aGlzLnB1dCA9IGZ1bmN0aW9uKGRhdGEsIGluZm8pIHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIHVybCA6IGFkZHIsIFxuICAgICAgICAgICAgbWV0aG9kIDogXCJQVVRcIixcbiAgICAgICAgICAgIGRhdGEgOiBhbmd1bGFyLnRvSnNvbihkYXRhKSxcbiAgICAgICAgICAgIGhlYWRlcnMgOiB7XG4gICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nIDogJGxvY2FsU3RvcmFnZVtcInRva2VuXCJdXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmIChpbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgICRtZFRvYXN0LnNob3coXG4gICAgICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zaW1wbGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0Q29udGVudCgnVXNlciBzZXR0aW5ncyB1cGRhdGVkJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucG9zaXRpb24oXCJ0b3AgcmlnaHRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaGlkZURlbGF5KDMwMDApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW1lKFwic3VjY2Vzcy10b2FzdFwiKVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTsgICAgICAgIFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihtc2csIHN0YXR1cykge1xuICAgICAgICAgICAgXHQkbG9nLmVycm9yKCdTb21ldGhpbmcgd2VudCB3cm9uZyBzZW5kaW5nIHVzZXIgZGF0YScpO1xuICAgICAgICAgICAgICAgICRtZFRvYXN0LnNob3coXG4gICAgICAgICAgICAgICAgICAgICRtZFRvYXN0LnNpbXBsZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQoJ1NvbWV0aGluZyB3ZW50IHdyb25nJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wb3NpdGlvbihcInRvcCByaWdodFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmhpZGVEZWxheSgzMDAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW1lKFwiZXJyb3ItdG9hc3RcIilcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKG1zZyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1zZztcbiAgICAgICAgICAgIH0pXG4gICAgfVxuICAgIFxuICAgIC8vIExvZ291dCB1c2VyXG4gICAgLy8gUmVtb3ZlIEpXVCBmcm9tIGxvY2FsU3RvcmFnZSBhbmQgZGVsZXRlIHNlc3Npb24gb24gc2VydmVyXG4gICAgdGhpcy5sb2dvdXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHVzZXIgPSAkbG9jYWxTdG9yYWdlW1widG9rZW5cIl07XG5cbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIHVybCA6IGFkZHIgKyBcImxvZ291dFwiLFxuICAgICAgICAgICAgbWV0aG9kIDogXCJERUxFVEVcIixcbiAgICAgICAgICAgIGhlYWRlcnMgOiB7XG4gICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nIDogJGxvY2FsU3RvcmFnZVtcInRva2VuXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9sb2dpblwiKTtcbiAgICAgICAgICAgICAgICBkZWxldGUgJGxvY2FsU3RvcmFnZVtcInRva2VuXCJdO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSAkbG9jYWxTdG9yYWdlW1wiZGFzaGJvYXJkXCJdO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSAkbG9jYWxTdG9yYWdlW1widGltZXN0YW1wXCJdO1xuICAgICAgICAgICAgICAgICRtZFRvYXN0LnNob3coXG4gICAgICAgICAgICAgICAgICAgICRtZFRvYXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAuc2ltcGxlKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0Q29udGVudCgnTG9nb3V0IHN1Y2Nlc3NmdWxsJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wb3NpdGlvbihcInRvcCByaWdodFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmhpZGVEZWxheSgzMDAwKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgcmV0dXJuOyAgICAgICAgXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGVycm9yLCBtc2cpIHtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9sb2dpblwiKTtcbiAgICAgICAgICAgICAgICBkZWxldGUgJGxvY2FsU3RvcmFnZVtcInRva2VuXCJdO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSAkbG9jYWxTdG9yYWdlW1wiZGFzaGJvYXJkXCJdO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSAkbG9jYWxTdG9yYWdlW1widGltZXN0YW1wXCJdO1xuICAgICAgICAgICAgICAgICRtZFRvYXN0LnNob3coXG4gICAgICAgICAgICAgICAgICAgICRtZFRvYXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAuc2ltcGxlKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0Q29udGVudCgnTG9nb3V0IGZhaWxlZCBvbiBzZXJ2ZXIgc2lkZSwgYnV0IHlvdSBhcmUgbG9nZ2VkIG91dCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAucG9zaXRpb24oXCJ0b3AgcmlnaHRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoMzAwMClcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgdGhpcy5nZXQgPSBmdW5jdGlvbihhbGx1c2Vycykge1xuICAgICAgICB2YXIgdXNlciA9ICRsb2NhbFN0b3JhZ2VbXCJ0b2tlblwiXTtcbiAgICAgICAgXG4gICAgICAgIGlmIChhbGx1c2Vycykge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgICAgICB1cmwgOiBhZGRyLFxuICAgICAgICAgICAgICAgIG1ldGhvZCA6IFwiR0VUXCIsXG4gICAgICAgICAgICAgICAgaGVhZGVycyA6IHtcbiAgICAgICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nIDogdXNlclxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhX3Jhdykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGFfcmF3KVxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhX3JhdztcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZXJyb3IsIG1zZykge1xuICAgICAgICAgICAgICAgICRtZFRvYXN0LnNob3coXG4gICAgICAgICAgICAgICAgICAgICRtZFRvYXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAuc2ltcGxldCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQoXCJDYW5ub3QgZmV0Y2ggdXNlcnMgZnJvbSBkYXRhYmFzZVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnBvc2l0aW9uKFwidG9wIHJpZ2h0XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuaGlkZURlbGF5KDMwMDApXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbWUoXCJlcnJvci10b2FzdFwiKVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuand0KCk7XG4gICAgfVxuXG5cbiAgICB0aGlzLnBvc3QgPSBmdW5jdGlvbih1c2VyRGF0YSkge1xuICAgICAgICB2YXIgdXNlciA9ICRsb2NhbFN0b3JhZ2VbXCJ0b2tlblwiXTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICB1cmwgOiBhZGRyLFxuICAgICAgICAgICAgbWV0aG9kIDogXCJQT1NUXCIsXG4gICAgICAgICAgICBkYXRhIDogYW5ndWxhci50b0pzb24odXNlckRhdGEpLFxuICAgICAgICAgICAgaGVhZGVycyA6IHtcbiAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbicgOiB1c2VyXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICB9KVxuICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZXJyb3IsIG1zZykge1xuICAgICAgICAgICAgJG1kVG9hc3Quc2hvdyhcbiAgICAgICAgICAgICAgICAkbWRUb2FzdFxuICAgICAgICAgICAgICAgICAgICAuc2ltcGxldCgpXG4gICAgICAgICAgICAgICAgICAgIC50ZXh0Q29udGVudChcIkNhbm5vdCBjcmVhdGUgdXNlclwiKVxuICAgICAgICAgICAgICAgICAgICAucG9zaXRpb24oXCJ0b3AgcmlnaHRcIilcbiAgICAgICAgICAgICAgICAgICAgLmhpZGVEZWxheSgzMDAwKVxuICAgICAgICAgICAgICAgICAgICAudGhlbWUoXCJlcnJvci10b2FzdFwiKVxuICAgICAgICAgICAgKVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAgdGhpcy5kZWxldGUgPSBmdW5jdGlvbih1c2VySWQpIHtcbiAgICAgICAgdmFyIHVzZXIgPSAkbG9jYWxTdG9yYWdlW1widG9rZW5cIl07XG4gICAgICAgIGNvbnNvbGUubG9nKHVzZXJJZClcbiAgICAgICAgXG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICB1cmwgOiBhZGRyLFxuICAgICAgICAgICAgbWV0aG9kIDogXCJERUxFVEVcIixcbiAgICAgICAgICAgIHBhcmFtcyA6IHtcInVzZXJJZFwiIDogdXNlcklkfSxcbiAgICAgICAgICAgIGhlYWRlcnMgOiB7XG4gICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nIDogdXNlclxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgfSlcbiAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGVycm9yLCBtc2cpIHtcbiAgICAgICAgICAgICRtZFRvYXN0LnNob3coXG4gICAgICAgICAgICAgICAgJG1kVG9hc3RcbiAgICAgICAgICAgICAgICAgICAgLnNpbXBsZXQoKVxuICAgICAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQoXCJDYW5ub3QgZGVsZXRlIHVzZXJcIilcbiAgICAgICAgICAgICAgICAgICAgLnBvc2l0aW9uKFwidG9wIHJpZ2h0XCIpXG4gICAgICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoMzAwMClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW1lKFwiZXJyb3ItdG9hc3RcIilcbiAgICAgICAgICAgIClcbiAgICAgICAgfSk7XG4gICAgfVxuXG5cblxufV0pO1xuXG4vLyBGaWx0ZXIgdG8gY29udmVydCBJREVBIGZvcm1hdCBmcm9tIE1vbmdvREIgdG8gc3RhbmRhcmRpemVkIElERUEgZm9ybWF0XG5hcHAuZmlsdGVyKCdpZGVhJywgZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKGlucHV0KSB7XG4gICAgICAgIHZhciByZXMgPSB7fTtcblxuICAgICAgICBhbmd1bGFyLmZvckVhY2goaW5wdXQsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgICAgIGlmIChrZXkgIT0gJ19pZCcpIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVbJyRkYXRlJ10pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2codmFsdWVbJyRkYXRlJ10pO1xuICAgICAgICAgICAgICAgICAgICByZXNba2V5XSA9IG5ldyBEYXRlKHZhbHVlWyckZGF0ZSddKS50b0lTT1N0cmluZygpLnNsaWNlKDAsMTkpICsgJ1onO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbn0pO1xuXG5hcHAuZmlsdGVyKCdqc29uMmh0bWwnLCBbXCIkc2NlXCIsIFwiJGZpbHRlclwiLCBmdW5jdGlvbigkc2NlLCAkZmlsdGVyKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKGlucHV0KSB7XG4gICAgICAgIHZhciBodG1sID0gXCJcIjtcblxuICAgICAgICBhbmd1bGFyLmZvckVhY2goaW5wdXQsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgICAgIGlmIChrZXkgIT0gXCJfaWRcIikge1xuICAgICAgICAgICAgaHRtbCA9IGh0bWwgKyBcIjxkaXY+XCI7XG5cbiAgICAgICAgICAgIC8vIFRoZSB0dXBsZSBpcyBuZXN0ZWRcbiAgICAgICAgICAgIGlmICgodHlwZW9mIHZhbHVlKSA9PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgIGlmICgodHlwZW9mIGtleSkgIT0gJ251bWJlcicgJiYga2V5ICE9IFwiJGRhdGVcIilcbiAgICAgICAgICAgICAgICAgICAgaHRtbCA9IGh0bWwgKyBcIjxlbT5cIiArIGtleSArIFwiPC9lbT46IFwiO1xuICAgICAgICAgICAgICAgIGh0bWwgPSBodG1sICsgXCI8ZGl2IGNsYXNzPVxcXCJzdWJcXFwiPlwiICsgJGZpbHRlcignanNvbjJodG1sJykodmFsdWUpICsgXCI8L2Rpdj5cIjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKCh0eXBlb2Yga2V5ICE9ICdudW1iZXInKSAmJiBrZXkgIT0gXCIkZGF0ZVwiKVxuICAgICAgICAgICAgICAgICAgICBodG1sID0gaHRtbCArIFwiPGVtPlwiICsga2V5ICsgXCI8L2VtPjogXCI7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgaXQgaXMgZGF0ZSAoSSBrbm93LCBpdCBpcyBzb29vb28gZGlydHkpXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlID4gMTAwMDAwMDAwMDAwMClcbiAgICAgICAgICAgICAgICAgICAgaHRtbCA9IGh0bWwgKyBcIjxzcGFuPlwiICsgJGZpbHRlcignZGF0ZScpKHZhbHVlLCd5eXl5L01NL2RkIEg6bW06c3MnKSArIFwiPC9zcGFuPlwiO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgaHRtbCA9IGh0bWwgKyBcIjxzcGFuPlwiICsgdmFsdWUgKyBcIjwvc3Bhbj5cIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGh0bWwgPSBodG1sICsgXCI8L2Rpdj5cIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuICRzY2UudHJ1c3RBcygnaHRtbCcsIGh0bWwpO1xuICAgIH0gICAgIFxufV0pO1xuXG4iLCJhcHAuY29uc3RhbnQoJ0FVVEhfRVZFTlRTJywge1xuICBsb2dpblN1Y2Nlc3M6ICdhdXRoLWxvZ2luLXN1Y2Nlc3MnLFxuICBsb2dpbkZhaWxlZDogJ2F1dGgtbG9naW4tZmFpbGVkJyxcbiAgbG9nb3V0U3VjY2VzczogJ2F1dGgtbG9nb3V0LXN1Y2Nlc3MnLFxuICBzZXNzaW9uVGltZW91dDogJ2F1dGgtc2Vzc2lvbi10aW1lb3V0JyxcbiAgbm90QXV0aGVudGljYXRlZDogJ2F1dGgtbm90LWF1dGhlbnRpY2F0ZWQnLFxuICBub3RBdXRob3JpemVkOiAnYXV0aC1ub3QtYXV0aG9yaXplZCdcbn0pO1xuXG5hcHAuY29uc3RhbnQoJ0NBVEVHT1JJRVMnLCBbIFwiYW55XCIsIFwiUmVjb24uU2Nhbm5pbmdcIiwgXCJBdHRlbXB0LkxvZ2luXCIsIFwiQXZhaWxhYmlsaXR5LkRvU1wiLCBcIkF2YWlsaWJpbGl0eS5ERG9TXCJdKTtcbmFwcC5jb25zdGFudCgnUFJPVE9DT0xTJywgWyBcInRjcFwiLCBcImRuc1wiLCBcInVkcFwiIF0pO1xuYXBwLmNvbnN0YW50KCdUWVBFUycsIFtcImJhcmNoYXJ0XCIsIFwicGllY2hhcnRcIiwgXCJ0b3BcIiwgXCJzdW1cIl0pXG5cbmFwcC5jb25zdGFudCgnUElFQ0hBUlQnLCB7IFxuICAgIG9wdGlvbnM6IHtcbiAgICAgICAgY2hhcnQ6IHtcbiAgICAgICAgICAgIHR5cGU6ICdwaWVDaGFydCcsXG4gICAgICAgICAgICBoZWlnaHQ6IDM3NSxcbiAgICAgICAgICAgIC8vaGVpZ2h0OiBmdW5jdGlvbigpIHsgY29uc29sZS5sb2coZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ252ZDMnKS5vZmZzZXRIZWlnaHQpOyByZXR1cm4gTnVtYmVyKDQyNSl9LFxuICAgICAgICAgICAgeDogZnVuY3Rpb24oZCl7cmV0dXJuIGQua2V5WzBdO30sXG4gICAgICAgICAgICB5OiBmdW5jdGlvbihkKXtyZXR1cm4gZC54O30sXG4gICAgICAgICAgICBzaG93TGFiZWxzOiB0cnVlLFxuICAgICAgICAgICAgZG9udXQgOiB0cnVlLFxuICAgICAgICAgICAgcGFkQW5nbGUgOiAwLjAwLFxuICAgICAgICAgICAgY29ybmVyUmFkaXVzIDogMSxcbiAgICAgICAgICAgIHRyYW5zaXRpb25EdXJhdGlvbjogNTAwLFxuICAgICAgICAgICAgbGFiZWxUaHJlc2hvbGQ6IDAsXG4gICAgICAgICAgICAvL2NvbG9yOiBbJ2JsdWUnLCAnZ3JlZW4nLCAneWVsbG93J10sXG4gICAgICAgICAgICAvL2NvbG9yOiBbXCIjNGFjNGYzXCIsIFwiIzk2ZDZiZFwiLCBcIiMwYTU5OWRcIiwgXCIjOGJhMmMwXCIsIFwiI2Y3ZmNmZFwiLFwiI2U1ZjVmOVwiLFwiI2NjZWNlNlwiLFwiIzk5ZDhjOVwiLFwiIzY2YzJhNFwiLFwiIzQxYWU3NlwiLFwiIzIzOGI0NVwiLFwiIzAwNmQyY1wiLFwiIzAwNDQxYlwiXSxcbiAgICAgICAgICAgIC8vY29sb3I6IFtcIiMyMTk2RjNcIiwgXCIjMDA5Njg4XCIsICBcIiM2NzNBQjdcIiwgIFwiI0ZGOTgwMFwiXSwgXG4gICAgICAgICAgICBsZWdlbmQ6IHtcbiAgICAgICAgICAgICAgICBtYXJnaW46IHtcbiAgICAgICAgICAgICAgICAgICAgdG9wOiA1LFxuICAgICAgICAgICAgICAgICAgICByaWdodDogMCxcbiAgICAgICAgICAgICAgICAgICAgYm90dG9tOiAtMTUsXG4gICAgICAgICAgICAgICAgICAgIGxlZnQ6IDBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbGVnZW5kUG9zaXRpb24gOiBcInRvcFwiLFxuICAgICAgICAgICAgdG9vbHRpcENvbnRlbnQgOiBmdW5jdGlvbihrZXksIHgsIHksIGUsIGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGtleSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZ3JhcGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ09sYWxhbGEhJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHBpZSA6IHtcbiAgICAgICAgICAgICAgICBkaXNwYXRjaDoge1xuICAgICAgICAgICAgICAgICAgICAvL2NoYXJ0Q2xpY2s6IGZ1bmN0aW9uKGUpIHtjb25zb2xlLmxvZyhlKX0sXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnRDbGljazogZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGUuc2V0VGltZShkYXRlLmdldFRpbWUoKSAtIDEwMDAqNjAqNjAqMjQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZS5zZXRIb3VycygwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGUuc2V0TWludXRlcygwKVxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uID0gJyMvZXZlbnRzP2ZpbHRlciZkYXRlPScgKyBkYXRlLmdldFRpbWUoKSArICcmZnJvbT0nICsgbmV3IERhdGUoKS5nZXRIb3VycygpICsgJzonICsgbmV3IERhdGUoKS5nZXRNaW51dGVzKCkgKyAnJmNhdGVnb3J5PScgKyBlLmRhdGEua2V5WzBdfSxcbiAgICAgICAgICAgICAgICAgICAgLy9lbGVtZW50RGJsQ2xpY2s6IGZ1bmN0aW9uKGUpIHtjb25zb2xlLmxvZyhcImVsZW1lbnQgZG91YmxlIGNsaWNrXCIpfSxcbiAgICAgICAgICAgICAgICAgICAgLy9lbGVtZW50TW91c2VvdmVyOiBmdW5jdGlvbihlKSB7Y29uc29sZS5sb2coXCJlbGVtZW50IG1vdXNlb3ZlclwiKX0sXG4gICAgICAgICAgICAgICAgICAgIC8vZWxlbWVudE1vdXNlb3V0OiBmdW5jdGlvbihlKSB7Y29uc29sZS5sb2coXCJlbGVtZW50IG1vdXNlIG91dFwiKX0gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGxhYmVsVHlwZSA6IFwicGVyY2VudFwiLFxuICAgICAgICAgICAgICAgIGxhYmVsc091dHNpZGUgOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAvL3N0YXJ0QW5nbGUgOiBmdW5jdGlvbihkKSB7IHJldHVybiBkLnN0YXJ0QW5nbGUvMiAtTWF0aC5QSS8yIH0sXG4gICAgICAgICAgICAgICAgLy9lbmRBbmdsZSA6IGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuZW5kQW5nbGUvMiAtTWF0aC5QSS8yIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0pO1xuXG5cbmFwcC52YWx1ZSgnQVJFQScsIHtcbiAgICBvcHRpb25zIDoge1xuICAgICAgICBjaGFydDoge1xuICAgICAgICAgICAgdHlwZTogJ211bHRpQmFyQ2hhcnQnLFxuICAgICAgICAgICAgaGVpZ2h0OiA0NTAsXG4gICAgICAgICAgICBtYXJnaW4gOiB7XG4gICAgICAgICAgICAgICAgdG9wOiAzMCxcbiAgICAgICAgICAgICAgICByaWdodDogMjAsXG4gICAgICAgICAgICAgICAgYm90dG9tOiAxMDAsXG4gICAgICAgICAgICAgICAgbGVmdDogNjVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB4OiBmdW5jdGlvbihkKSB7IHJldHVybiBkLnggfSxcbiAgICAgICAgICAgIHk6IGZ1bmN0aW9uKGQpIHsgcmV0dXJuIE51bWJlcihkLkNvdW50KSB9LFxuICAgICAgICAgICAgdXNlVm9yb25vaTogZmFsc2UsXG4gICAgICAgICAgICBjbGlwRWRnZTogdHJ1ZSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAxMDAsXG4gICAgICAgICAgICB1c2VJbnRlcmFjdGl2ZUd1aWRlbGluZTogZmFsc2UsXG4gICAgICAgICAgICB0b29sdGlwQ29udGVudCA6IGZ1bmN0aW9uKGtleSwgeCwgeSwgZSwgZ3JhcGgpIHtyZXR1cm4oXCJIYVwiKTt9LFxuICAgICAgICAgICAgeEF4aXM6IHtcbiAgICAgICAgICAgICAgICBzaG93TWF4TWluOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB0aWNrRm9ybWF0OiBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkMy50aW1lLmZvcm1hdCgnJW0vJWQgJUg6JU0nKShuZXcgRGF0ZShkKSlcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHJvdGF0ZUxhYmVscyA6IC00NSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB5QXhpczoge1xuICAgICAgICAgICAgICAgIHNob3dNYXhNaW46IGZhbHNlLFxuICAgICAgICAgICAgICAgIHRpY2tGb3JtYXQ6IGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZDMuZm9ybWF0KCdzJykoZCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBheGlzTGFiZWwgOiBcIkV2ZW50cyBDb3VudFwiLFxuICAgICAgICAgICAgICAgIGF4aXNMYWJlbERpc3RhbmNlIDogLTIwXG4gICAgICAgICAgICB9LCAgXG4gICAgICAgICAgICBtdWx0aWJhcjoge1xuICAgICAgICAgICAgICAgIGRpc3BhdGNoIDoge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50Q2xpY2s6IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoZS5kYXRhLngpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBob3VycyA9IGRhdGUuZ2V0SG91cnMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtaW51dGVzID0gZGF0ZS5nZXRNaW51dGVzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlLnNldEhvdXJzKDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZS5zZXRNaW51dGVzKDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uID0gJyMvZXZlbnRzP2ZpbHRlciZkYXRlPScgKyBkYXRlLmdldFRpbWUoKSArICcmZnJvbT0nICsgKFwiMFwiICsgaG91cnMpLnNsaWNlKC0yKSArICc6JyArIChcIjBcIiArIG1pbnV0ZXMpLnNsaWNlKC0yKSArICcmY2F0ZWdvcnk9JyArIGUuZGF0YS5rZXkgKyAnJmRpcj0xJztcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuXG5cbmFwcC5jb25zdGFudChcIk1FTlVcIiwgW1xuXHQvKntcblx0XHRcInRpdGxlXCIgOiBcIkRhc2hib2FyZFwiLFxuICAgICAgICBcImxpbmtcIiA6IFwiIy9cIlxuXHRcdFwiaXRlbXNcIiA6IFtcblx0XHRcdHtcblx0XHRcdFx0XCJ0aXRsZVwiIDogXCJVc2Vyc1wiLFxuXHRcdFx0XHRcImxpbmtcIlx0OiBcInVzZXJcIlxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0XCJ0aXRsZVwiIDogXCJNeSBwcm9maWxlXCJcblx0XHRcdH1cblx0XHRdXG5cdH0sKi9cblx0e1xuXHRcdFwidGl0bGVcIiA6IFwiRXZlbnRzXCIsXG5cdFx0XCJsaW5rXCIgXHQ6IFwiIy9ldmVudHNcIlxuXHR9LFxuXHQvKntcblx0XHRcInRpdGxlXCIgOiBcIkFuYWx5dGljczIzXCIsXG5cdFx0XCJpdGVtc1wiIDogW1xuXHRcdFx0e1xuXHRcdFx0XHRcInRpdGxlXCIgOiBcIlVzZXJzXCIsXG5cdFx0XHRcdFwibGlua1wiIFx0OiBcInNldHRpbmdzXCJcblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdFwidGl0bGVcIiA6IFwiTXkgcHJvZmlsZVwiLFxuXHRcdFx0XHRcImxpbmtcIlx0OiBcInByb2ZpbGVcIlxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0XCJ0aXRsZVwiIDogXCJNeSBwcm9maWxlXCIsXG5cdFx0XHRcdFwibGlua1wiXHQ6IFwicHJvZmlsZVwiXG5cdFx0XHR9XG5cdFx0XVxuXG5cdH0sXG5cdHtcblx0XHRcInRpdGxlXCIgOiBcIkFuYWx5dGljczEyM1wiLFxuXHRcdFwibGlua1wiIFx0OiBcImxvZ2luXCJcblx0fSwqL1xuXHR7XG5cdFx0XCJ0aXRsZVwiIDogXCJTZXR0aW5nc1wiLFxuXHRcdFwiaXRlbXNcIiA6IFtcbiAgICAgICAgICAgIHtcblx0XHRcdFx0XCJ0aXRsZVwiIDogXCJNeSBwcm9maWxlXCIsXG5cdFx0XHRcdFwibGlua1wiXHQ6IFwiIy9zZXR0aW5ncy9wcm9maWxlXCJcblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdFwidGl0bGVcIiA6IFwiVXNlcnNcIixcblx0XHRcdFx0XCJsaW5rXCIgXHQ6IFwiIy9zZXR0aW5ncy91c2Vyc1wiXG5cdFx0XHR9LFxuXHRcdF1cblx0fVxuXSk7XG4iLCJhcHAuY29udHJvbGxlcignZXZlbnRDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkcm91dGVQYXJhbXMsICRodHRwLCBhcGkpIHtcblxuICAgICAgICAkc2NvcGUuaWQgPSAkcm91dGVQYXJhbXM7XG4gICAgICAgICRzY29wZS5zaG93UGxhaW4gPSB0cnVlO1xuXG4gICAgICAgICRzY29wZS5nZW8gPSBbXTtcblxuICAgICAgICAkc2NvcGUuYmFjayA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgd2luZG93Lmhpc3RvcnkuYmFjaygpXG4gICAgICAgIH1cblxuICAgICAgICBhcGkuZ2V0KCdpZC8nICsgJHJvdXRlUGFyYW1zWydpZCddKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICRzY29wZS5kYXRhID0gZGF0YTtcblxuICAgICAgICAgICAgLy92YXIgYm91bmRzID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZ0JvdW5kcygpO1xuXG4gICAgICAgICAgICBpZiAoKCRzY29wZS5kYXRhLlNvdXJjZSAhPSB1bmRlZmluZWQgJiYgJHNjb3BlLmRhdGEuVGFyZ2V0ICE9IHVuZGVmaW5lZCkgJiYgXG4gICAgICAgICAgICAgICAgKCRzY29wZS5kYXRhLlNvdXJjZVswXS5JUDQgJiYgJHNjb3BlLmRhdGEuVGFyZ2V0WzBdLklQNCkpIHtcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQoJ2h0dHA6Ly9mcmVlZ2VvaXAubmV0L2pzb24vJyArICRzY29wZS5kYXRhLlRhcmdldFswXS5JUDRbMF0pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgZGF0YVsndHlwZSddID0gXCJUYXJnZXRcIjtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdlby5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAvL3ZhciBsYXRsbmcgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGRhdGEubGF0aXR1ZGUsIGRhdGEubG9uZ2l0dWRlKTtcbiAgICAgICAgICAgICAgICAgICAgLy9ib3VuZHMuZXh0ZW5kKGxhdGxuZyk7XG5cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICRodHRwLmdldCgnaHR0cDovL2ZyZWVnZW9pcC5uZXQvanNvbi8nICsgJHNjb3BlLmRhdGEuU291cmNlWzBdLklQNFswXSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGFbJ3R5cGUnXSA9IFwiU291cmNlXCI7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nZW8ucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgLy92YXIgbGF0bG5nID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhkYXRhLmxhdGl0dWRlLCBkYXRhLmxvbmdpdHVkZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vYm91bmRzLmV4dGVuZChsYXRsbmcpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICgkc2NvcGUuZGF0YS5Tb3VyY2UgPT0gdW5kZWZpbmVkIHx8ICRzY29wZS5kYXRhLlNvdXJjZVswXS5JUDQgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KCdodHRwOi8vZnJlZWdlb2lwLm5ldC9qc29uLycgKyAkc2NvcGUuZGF0YS5UYXJnZXRbMF0uSVA0WzBdKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YVsndHlwZSddID0gXCJUYXJnZXRcIjtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdlby5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRodHRwLmdldCgnaHR0cDovL2ZyZWVnZW9pcC5uZXQvanNvbi8nICsgJHNjb3BlLmRhdGEuU291cmNlWzBdLklQNFswXSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGFbJ3R5cGUnXSA9IFwiU291cmNlXCI7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nZW8ucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICBcblxufSk7XG4iLCJhcHAuY29udHJvbGxlcignZXZlbnRzQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRsb2NhdGlvbiwgYXBpLCAkcm91dGUpIHtcbiAgICAkc2NvcGUuZmlsdGVyID0ge1xuICAgICAgICBcImNhdGVnb3J5XCIgOiBcIlwiLCAgICAvLyBDYXRlZ29yeVxuICAgICAgICBcInNyY19pcFwiIDogXCJcIiwgICAgICAvLyBTb3VyY2UgSVBcbiAgICAgICAgXCJ0cnRfaXBcIiA6IFwiXCIsICAgICAgLy8gVGFyZ2V0IElQXG4gICAgICAgIFwiZGVzY1wiIDogXCJcIiwgICAgICAgIC8vIERlc2NyaXB0aW9uXG4gICAgICAgIFwiZmxvd3NfZnJvbVwiIDogXCJcIiwgIC8vIEZsb3dDb3VudFxuICAgICAgICBcImZsb3dzX3RvXCIgOiBcIlwiLCAgICAvLyBGbG93Q291bnRcbiAgICAgICAgXCJpdGVtc1wiIDogMTAwLCAgICAgIC8vIExpbWl0IG51bWJlciBvZiBkaXNwbGF5ZWQgaXRlbXNcbiAgICB9O1xuICAgICRzY29wZS5xdWVyeSA9IHtcbiAgICAgICAgXCJmcm9tXCIgOiBcIjEyOjAwXCIsXG4gICAgICAgIFwidG9cIiA6IFwiXCIsXG4gICAgICAgIFwiZGF0ZVwiIDogbmV3IERhdGUoKSxcbiAgICAgICAgXCJkZXNjcmlwdGlvblwiIDogXCJcIixcbiAgICAgICAgXCJjYXRlZ29yeVwiIDogXCJcIixcbiAgICAgICAgXCJvcmRlcmJ5XCIgOiBcIkRldGVjdFRpbWVcIixcbiAgICAgICAgXCJkaXJcIiA6IC0xLFxuXHRcdFwiZGlyX3Jhd1wiIDogdHJ1ZSxcbiAgICAgICAgXCJsaW1pdFwiIDogMTAwLFxuICAgICAgICBcInNyY2lwXCIgOiBcIlwiLFxuICAgICAgICBcImRzdGlwXCIgOiBcIlwiXG4gICAgfVxuXG4gICAgJHNjb3BlLm9yZGVyQnkgPSBbXCJEZXRlY3RUaW1lXCIsIFwiQ2F0ZWdvcnlcIiwgXCJEZXNjcmlwdGlvblwiLCBcIkZsb3dDb3VudFwiXTtcbiAgICAkc2NvcGUuc2VhcmNoVGV4dCA9IFwiXCI7XG5cbiAgICAkc2NvcGUuZGF0YSA9IFtdO1xuICAgICRzY29wZS5sb2FkYnRuID0gXCJMb2FkXCI7XG4gICAgJHNjb3BlLm5leHRCdXR0b24gPSBcIkxvYWQgbmV4dCAxMDAgaXRlbXNcIjtcbiAgICAkc2NvcGUuYWN0aXZlRmlsdGVyID0gJGxvY2F0aW9uLnNlYXJjaCgpLmZpbHRlcjtcblx0JHNjb3BlLmRpclZhbCA9IFwiRGVzY2VuZGluZ1wiO1xuXG4gICAgLy8gUkVTRVQgZXZlcnl0aGluZyBpbmNsdWRpbmcgVVJMIHBhcmFtZXRlcnMgYW5kIHJlbG9hZFxuICAgICRzY29wZS5yZXNldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAkbG9jYXRpb24uc2VhcmNoKHt9KTtcbiAgICAgICAgJHJvdXRlLnJlbG9hZCgpO1xuICAgIH1cblxuICAgICRzY29wZS5nZXRRdWVyeSA9IGZ1bmN0aW9uKGlwLCBwYXRoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGlwKTtcbiAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBkYXRlLnNldERhdGUoZGF0ZS5nZXREYXRlKCkgLSA3KTtcbiAgICAgICAgdmFyIG1pbnV0ZXMgPSBcIjBcIiArIGRhdGUuZ2V0TWludXRlcygpO1xuICAgICAgICB2YXIgaG91cnMgPSBcIjBcIiArIGRhdGUuZ2V0SG91cnMoKTtcblxuICAgICAgICB2YXIgcXVlcnkgPSB7XG4gICAgICAgICAgICAgICAgZnJvbSA6IGhvdXJzLnN1YnN0cigtMikgKyAnOicgKyBtaW51dGVzLnN1YnN0cigtMiksIFxuICAgICAgICAgICAgICAgIGRhdGUgOiBkYXRlLFxuICAgICAgICAgICAgICAgIGxpbWl0IDogMTAwLFxuICAgICAgICAgICAgICAgIG9yZGVyYnkgOiBcIkRldGVjdFRpbWVcIixcbiAgICAgICAgICAgICAgICBkaXIgOiAxXG4gICAgICAgICAgICB9O1xuICAgICAgICBpZiAocGF0aCA9PSBcInNyY1wiKSB7XG4gICAgICAgICAgIHF1ZXJ5W1wic3JjaXBcIl0gPSBpcDsgXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBxdWVyeVtcImRzdGlwXCJdID0gaXA7XG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUubG9hZEl0ZW1zKHF1ZXJ5KTtcbiAgICB9XG5cbiAgICAkc2NvcGUuc3dpdGNoRGlyID0gZnVuY3Rpb24odmFsKSB7XG4gICAgICAgIGlmICh2YWwgPT0gLTEgfHwgdmFsIHx8IHZhbCA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICRzY29wZS5kaXJWYWwgPSBcIkRlc2NlbmRpbmdcIjtcbiAgICAgICAgICAgICRzY29wZS5xdWVyeS5kaXIgPSAtMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRzY29wZS5kaXJWYWwgPSBcIkFzY2VuZGluZ1wiO1xuICAgICAgICAgICAgJHNjb3BlLnF1ZXJ5LmRpciA9IDE7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAkc2NvcGUubG9hZE5leHQgPSBmdW5jdGlvbih0aW1lKSB7XG4gICAgICAgICRzY29wZS5uZXh0QnV0dG9uID0gXCJMb2FkaW5nLi4uXCI7XG5cbiAgICAgICAgaWYgKCRsb2NhdGlvbi5zZWFyY2goKS5maWx0ZXIpIHtcbiAgICAgICAgICAgIHZhciBxdWVyeSA9IGFuZ3VsYXIuY29weSgkc2NvcGUucXVlcnkpO1xuICAgICAgICAgICAgcXVlcnkuZnJvbSA9IG5ldyBEYXRlKHRpbWUpO1xuICAgICAgICAgICAgcXVlcnkuZGlyID0gMTtcblxuICAgICAgICAgICAgaWYgKHF1ZXJ5LnRvKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRvID0gcXVlcnkudG8uc3BsaXQoJzonKTtcbiAgICAgICAgICAgICAgICB2YXIgdG9fZGF0ZSA9IG5ldyBEYXRlKHF1ZXJ5LmRhdGUpO1xuICAgICAgICAgICAgICAgIHRvX2RhdGUuc2V0SG91cnModG9fZGF0ZS5nZXRIb3VycygpICsgdG9bMF0pO1xuICAgICAgICAgICAgICAgIHRvX2RhdGUuc2V0TWludXRlcyh0b1sxXSk7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHRvX2RhdGUgPSBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBxdWVyeS50byA9IHRvX2RhdGU7XG5cblxuICAgICAgICAgICAgYXBpLmdldCgncXVlcnknLCBxdWVyeSwgdHJ1ZSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlbWFpbmluZyA9IGRhdGEucG9wKCk7XG5cbiAgICAgICAgICAgICAgICBmb3IoaXRlbSBpbiBkYXRhKSB7ICAgIFxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGF0YS5wdXNoKGRhdGFbaXRlbV0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICRzY29wZS5uZXh0QnV0dG9uID0gXCJMb2FkIG5leHQgMTAwIGl0ZW1zXCI7XG4gICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbihlcnIsIG1zZykge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgJHNjb3BlLm5leHRCdXR0b24gPSBcIkxvYWQgbmV4dCAxMDAgaXRlbXNcIjtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcXVlcnkgPSB7XG4gICAgICAgICAgICAgICAgXCJ0b1wiIDogbmV3IERhdGUodGltZSksXG4gICAgICAgICAgICAgICAgXCJkaXJcIiA6IC0xXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGFwaS5nZXQoJ3F1ZXJ5JywgcXVlcnksIHRydWUpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5yZW1haW5pbmcgPSBkYXRhLnBvcCgpO1xuICAgICAgICAgICAgICAgIGZvcihpdGVtIGluIGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGEucHVzaChkYXRhW2l0ZW1dKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgJHNjb3BlLm5leHRCdXR0b24gPSBcIkxvYWQgbmV4dCAxMDAgaXRlbXNcIjtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZXJyLCBtc2cpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICRzY29wZS5uZXh0QnV0dG9uID0gXCJMb2FkIG5leHQgMTAwIGl0ZW1zXCI7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgJHNjb3BlLmxvYWRJdGVtcyA9IGZ1bmN0aW9uKHF1ZXJ5KSB7XG4gICAgICAgICRzY29wZS5sb2FkYnRuID0gXCJMb2FkaW5nLi4uXCI7XG4gICAgICAgIHZhciBmcm9tID0gcXVlcnkuZnJvbS5zcGxpdCgnOicpO1xuICAgICAgICB2YXIgZnJvbV9kYXRlID0gbmV3IERhdGUocXVlcnkuZGF0ZSk7XG5cbiAgICAgICAgZnJvbV9kYXRlLnNldEhvdXJzKGZyb21bMF0pO1xuICAgICAgICBmcm9tX2RhdGUuc2V0TWludXRlcyhmcm9tWzFdKTtcblxuICAgICAgICB2YXIgdW5peF9kYXRlID0gYW5ndWxhci5jb3B5KHF1ZXJ5LmRhdGUpO1xuXG4gICAgICAgICRsb2NhdGlvbi5zZWFyY2goJ2ZpbHRlcicsIHRydWUpO1xuICAgICAgICAkbG9jYXRpb24uc2VhcmNoKCdmcm9tJywgcXVlcnkuZnJvbSk7XG4gICAgICAgICRsb2NhdGlvbi5zZWFyY2goJ2RhdGUnLCB1bml4X2RhdGUuZ2V0VGltZSgpKTtcbiAgICAgICAgJGxvY2F0aW9uLnNlYXJjaCgnbGltaXQnLCBxdWVyeS5saW1pdCk7XG4gICAgICAgICRsb2NhdGlvbi5zZWFyY2goJ29yZGVyYnknLCBxdWVyeS5vcmRlcmJ5KTtcbiAgICAgICAgJGxvY2F0aW9uLnNlYXJjaCgnZGlyJywgcXVlcnkuZGlyKTtcblxuICAgICAgICBpZiAocXVlcnkudG8pIHtcbiAgICAgICAgICAgIHZhciB0byA9IHF1ZXJ5LnRvLnNwbGl0KCc6Jyk7XG4gICAgICAgICAgICB2YXIgdG9fZGF0ZSA9IG5ldyBEYXRlKHF1ZXJ5LmRhdGUpO1xuICAgICAgICAgICAgdG9fZGF0ZS5zZXRIb3Vycyh0b1swXSk7XG4gICAgICAgICAgICB0b19kYXRlLnNldE1pbnV0ZXModG9bMV0pO1xuICAgICAgICAgICAgJGxvY2F0aW9uLnNlYXJjaCgndG8nLCBxdWVyeS50byk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgdG9fZGF0ZSA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocXVlcnkuZGVzY3JpcHRpb24gIT0gXCJcIikge1xuICAgICAgICAgICAgJGxvY2F0aW9uLnNlYXJjaCgnZGVzY3JpcHRpb24nLCBxdWVyeS5kZXNjcmlwdGlvbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBxdWVyeS5kZXNjcmlwdGlvbiA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocXVlcnkuY2F0ZWdvcnkgIT0gXCJcIikge1xuICAgICAgICAgICAgJGxvY2F0aW9uLnNlYXJjaCgnY2F0ZWdvcnknLCBxdWVyeS5jYXRlZ29yeSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBxdWVyeS5jYXRlZ29yeSA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocXVlcnkuc3JjaXAgIT0gXCJcIikge1xuICAgICAgICAgICAgJGxvY2F0aW9uLnNlYXJjaCgnc3JjaXAnLCBxdWVyeS5zcmNpcCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkbG9jYXRpb24uc2VhcmNoKFwic3JjaXBcIiwgbnVsbCk7XG4gICAgICAgICAgICBxdWVyeS5zcmNpcCA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocXVlcnkuZHN0aXAgIT0gXCJcIikge1xuICAgICAgICAgICAgJGxvY2F0aW9uLnNlYXJjaCgnZHN0aXAnLCBxdWVyeS5kc3RpcCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkbG9jYXRpb24uc2VhcmNoKFwiZHN0aXBcIiwgbnVsbCk7XG4gICAgICAgICAgICBxdWVyeS5kc3RpcCA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc2VuZCA9IHtcbiAgICAgICAgICAgIFwiZnJvbVwiIDogZnJvbV9kYXRlLFxuICAgICAgICAgICAgXCJ0b1wiIDogdG9fZGF0ZSxcbiAgICAgICAgICAgIFwiY2F0ZWdvcnlcIiA6IHF1ZXJ5LmNhdGVnb3J5LFxuICAgICAgICAgICAgXCJkZXNjcmlwdGlvblwiIDogcXVlcnkuZGVzY3JpcHRpb24sXG4gICAgICAgICAgICBcImxpbWl0XCIgOiBxdWVyeS5saW1pdCxcbiAgICAgICAgICAgIFwib3JkZXJieVwiIDogcXVlcnkub3JkZXJieSxcbiAgICAgICAgICAgIFwiZGlyXCIgOiBxdWVyeS5kaXIsXG4gICAgICAgICAgICBcInNyY2lwXCIgOiBxdWVyeS5zcmNpcCxcbiAgICAgICAgICAgIFwiZHN0aXBcIiA6IHF1ZXJ5LmRzdGlwXG4gICAgICAgIH1cbiAgICAgICAgYXBpLmdldCgncXVlcnknLCBzZW5kLCB0cnVlKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRcdCRzY29wZS5yZW1haW5pbmcgPSBkYXRhLnBvcCgpOy8vW2RhdGEubGVuZ3RoIC0gMV0pXG5cdFx0XHQkc2NvcGUuZGF0YSA9IGRhdGE7XG4gICAgICAgICAgICAkc2NvcGUubG9hZGJ0biA9IFwiTG9hZFwiXG5cdCAgICB9KS5lcnJvcihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRzY29wZS5sb2FkYnRuID0gXCJMb2FkXCI7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgICRzY29wZS5ldmVudHMgPSBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIHZhciByZXMgPSBbXTtcbiAgICAgICAgaWYgKCRzY29wZS5maWx0ZXIuc3JjX2lwICE9IFwiXCIpe1xuICAgICAgICAgICAgaWYgKFwiU291cmNlXCIgaW4gaXRlbSkge1xuICAgICAgICAgICAgICAgIGlmIChcIklQNFwiIGluIGl0ZW0uU291cmNlWzBdICYmXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uU291cmNlWzBdLklQNFswXS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJHNjb3BlLmZpbHRlci5zcmNfaXAudG9Mb3dlckNhc2UoKSkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXMucHVzaCgxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICByZXMucHVzaCgwKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzLnB1c2goMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoJHNjb3BlLmZpbHRlci50cnRfaXAgIT0gXCJcIil7XG4gICAgICAgICAgICBpZiAoXCJUYXJnZXRcIiBpbiBpdGVtKSB7XG4gICAgICAgICAgICAgICAgaWYgKFwiSVA0XCIgaW4gaXRlbS5UYXJnZXRbMF0gJiZcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5UYXJnZXRbMF0uSVA0WzBdLnRvTG93ZXJDYXNlKCkuaW5kZXhPZigkc2NvcGUuZmlsdGVyLnRydF9pcC50b0xvd2VyQ2FzZSgpKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlcy5wdXNoKDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHJlcy5wdXNoKDApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXMucHVzaCgwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoJHNjb3BlLmZpbHRlci5jYXRlZ29yeSAhPSBcIlwiKSB7XG4gICAgICAgICAgICBpZiAoaXRlbS5DYXRlZ29yeVswXS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJHNjb3BlLmZpbHRlci5jYXRlZ29yeS50b0xvd2VyQ2FzZSgpKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgcmVzLnB1c2goMSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlcy5wdXNoKDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCRzY29wZS5maWx0ZXIuZGVzYyAhPSBcIlwiKSB7XG4gICAgICAgICAgICBpZiAoaXRlbS5EZXNjcmlwdGlvbi50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJHNjb3BlLmZpbHRlci5kZXNjLnRvTG93ZXJDYXNlKCkpID4gLTEpXG4gICAgICAgICAgICAgICAgcmVzLnB1c2goMSk7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgcmVzLnB1c2goMCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoJHNjb3BlLmZpbHRlci5mbG93c19mcm9tICE9IFwiXCIpIHtcbiAgICAgICAgICAgIGlmIChpdGVtLkZsb3dDb3VudCA+IE51bWJlcigkc2NvcGUuZmlsdGVyLmZsb3dzX2Zyb20pKVxuICAgICAgICAgICAgICAgIHJlcy5wdXNoKDEpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHJlcy5wdXNoKDApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCRzY29wZS5maWx0ZXIuZmxvd3NfdG8gIT0gXCJcIikge1xuICAgICAgICAgICAgaWYgKGl0ZW0uRmxvd0NvdW50IDwgTnVtYmVyKCRzY29wZS5maWx0ZXIuZmxvd3NfdG8pKVxuICAgICAgICAgICAgICAgIHJlcy5wdXNoKDEpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHJlcy5wdXNoKDApO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGxvZ2ljdmFsdWUgPSAxO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbG9naWN2YWx1ZSA9IGxvZ2ljdmFsdWUgKiByZXNbaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxvZ2ljdmFsdWUgPT0gMSA/IHRydWUgOiBmYWxzZTtcblxuICAgIH1cblxuXHQvKlxuXHQgKiBJTklUIHByb2NlZHVyZVxuXHQgKi9cblxuICAgIC8vIENoZWNrIGZvciBGaWx0ZXIgaW4gVVJMIHBhcmFtc1xuXHRpZiAoJGxvY2F0aW9uLnNlYXJjaCgpLmZpbHRlcikge1xuXHRcdCRzY29wZS5zd2l0Y2hEaXIoJGxvY2F0aW9uLnNlYXJjaCgpLmRpcik7XG5cblx0XHQvLyBRdWVyeSBmaWx0ZXIgaXMgc2V0LCBhcHBseSBpdFxuICAgICAgICB2YXIgdG1wX3F1ZXJ5ID0gYW5ndWxhci5jb3B5KCRsb2NhdGlvbi5zZWFyY2goKSk7XG5cbiAgICAgICAgLy8gRmlyc3QgY29udmVydCBVTklYIFRpbWVzdGFtcCB0byBEYXRlXG4gICAgICAgIHRtcF9xdWVyeVsnZGF0ZSddID0gbmV3IERhdGUoTnVtYmVyKHRtcF9xdWVyeVsnZGF0ZSddKSk7XG4gICAgICAgICRzY29wZS5xdWVyeSA9IHRtcF9xdWVyeTtcblxuICAgICAgICAvLyBGZXRjaCBpdGVtc1xuICAgICAgICAkc2NvcGUubG9hZEl0ZW1zKCRzY29wZS5xdWVyeSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRmV0Y2ggMTAwIG1vc3QgcmVjZW50IGV2ZW50c1xuICAgICAgICBhcGkuZ2V0KFwiMTAwXCIpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSBkYXRhO1xuICAgICAgICB9KTtcbiAgICB9XG59KTtcblxuYXBwLmRpcmVjdGl2ZSgndmFsaWRhdGVIb3VycycsIGZ1bmN0aW9uKCkge1xuICAgIHZhciB0byA9IFtdO1xuICAgIHZhciBmcm9tID0gW107XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxuICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMsIGN0cmwpIHtcbiAgICAgICAgICAgIGN0cmwuJHZhbGlkYXRvcnMudGltZSA9IGZ1bmN0aW9uKG1vZGVsVmFsdWUsIHZpZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmIChhdHRycy5uZ01vZGVsID09IFwicXVlcnkuZnJvbVwiICYmIHZpZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBmcm9tID0gdmlld1ZhbHVlLnNwbGl0KCc6Jyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2aWV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdG8gPSB2aWV3VmFsdWUuc3BsaXQoJzonKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodG8ubGVuZ3RoID09IDIgfHwgZnJvbS5sZW5ndGggPT0gMikge1xuICAgICAgICAgICAgICAgIGlmICh0b1swXSA8IGZyb21bMF0gfHwgKHRvWzBdIDw9IGZyb21bMF0gJiYgdG9bMV0gPCBmcm9tWzFdKSB8fFxuICAgICAgICAgICAgICAgICAgICB0b1swXSA8IDAgfHwgdG9bMF0gPiAyMyB8fCB0b1sxXSA8IDAgfHwgdG9bMV0gPiA1OSB8fCBmcm9tWzBdIDwgMCB8fCBmcm9tWzBdID4gMjMgfHwgZnJvbVsxXSA8IDAgfHwgZnJvbVsxXSA+IDU5XG4gICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSk7XG4iLCJhcHAuY29udHJvbGxlcignaG9tZUNvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUsIHVzZXIsICR0aW1lb3V0LCAkaW50ZXJ2YWwsICRsb2csICRsb2NhbFN0b3JhZ2UsICRyb3V0ZSwgJG1kRGlhbG9nLCBkYXNoYm9hcmQpIHtcbiAgICBcbiAgICAkc2NvcGUuZGFzaGJvYXJkcyA9IGRhc2hib2FyZC5nZXRBbGwoKTtcbiAgICAkc2NvcGUuZGFzaGJvYXJkU2V0dGluZ3MgPSBkYXNoYm9hcmQuc2V0dGluZ3MoKTtcblxuICAgICRzY29wZS5hY3RpdmVHcmlkID0gZmFsc2U7XG4gICAgJHNjb3BlLnJlZnJlc2hfaW50ZXJ2YWwgPSAkc2NvcGUuZGFzaGJvYXJkU2V0dGluZ3MuaW50ZXJ2YWw7XG4gICAgXG4gICAgLy8gU3RvcmUgaW50ZXJ2YWwgSURcbiAgICB2YXIgcmVmcmVzaCA9IHVuZGVmaW5lZDtcbiAgICAkc2NvcGUucmVmcmVzaF9lbmFibGVkID0gYW5ndWxhci5pc0RlZmluZWQocmVmcmVzaCk7XG5cbiAgICAkc2NvcGUub3Blbk1lbnUgPSBmdW5jdGlvbigkbWRPcGVuTWVudSwgZXYpIHtcbiAgICAgICAgb3JpZ2luYXRvckV2ID0gZXY7XG4gICAgICAgICRtZE9wZW5NZW51KGV2KTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLmFkZEl0ZW0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgJHNjb3BlLiRicm9hZGNhc3QoJ2FkZEl0ZW0nKTtcbiAgICB9XG5cbiAgICAkc2NvcGUuZW5hYmxlR3JpZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25zb2xlLmxvZygnRW5hYmxlIGdyaWQnKVxuICAgICAgICAkc2NvcGUuJGJyb2FkY2FzdCgnZW5hYmxlR3JpZCcpO1xuICAgICAgICAkc2NvcGUuYWN0aXZlR3JpZCA9ICEkc2NvcGUuYWN0aXZlR3JpZDtcbiAgICB9XG4gICAgJHNjb3BlLiRvbigncmVxdWVzdFJlZHJhdycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3Jlc2l6ZScpKTtcbiAgICAgICAgfSwgMTAwKTtcbiAgICB9KTtcblxuICAgICRzY29wZS5jbGVhckNhY2hlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICRsb2cuZGVidWcoXCJkZWxldGluZyB0aW1lc3RhbXBcIilcbiAgICAgICAgZGVsZXRlICRsb2NhbFN0b3JhZ2VbJ3RpbWVzdGFtcCddO1xuICAgICAgICAkcm91dGUucmVsb2FkKCk7XG4gICAgfVxuXG4gICAgJHNjb3BlLnNldEludGVydmFsID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChyZWZyZXNoKSkge1xuICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChyZWZyZXNoKTtcbiAgICAgICAgICAgIHJlZnJlc2ggPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnYnJvYWRjYXN0IGZhaWxlZCcpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWZyZXNoID0gJGludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdicm9hZGNhc3QnKVxuICAgICAgICAgICAgICAgICRzY29wZS4kYnJvYWRjYXN0KCdyZWZyZXNoRGF0YScpO1xuICAgICAgICAgICAgfSwgJHNjb3BlLnJlZnJlc2hfaW50ZXJ2YWwqMTAwMCk7XG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUucmVmcmVzaF9lbmFibGVkID0gYW5ndWxhci5pc0RlZmluZWQocmVmcmVzaClcblxuICAgIH1cblxuICAgIFxuXG4gICAgJHNjb3BlLnNlbGVjdGVkRGFzaGJvYXJkID0gZGFzaGJvYXJkLmFjdGl2ZSgpO1xuXG4gICAgJHNjb3BlLmVkaXREYXNoYm9hcmQgPSBmdW5jdGlvbihldiwgaW5kZXgpIHtcbiAgICAgICAgLy8gTWFrZSBhIGJhY2t1cCBjb3B5IG9mIGN1cnJlbnQgZGFzaGJvYXJkc1xuICAgICAgICAkc2NvcGUuYmFja3VwRGFzaGJvYXJkcyA9IGFuZ3VsYXIuY29weSgkc2NvcGUuZGFzaGJvYXJkcyk7XG5cbiAgICAgICAgJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgICAgY29udHJvbGxlcjogXCJlZGl0RGFzaGJvYXJkQ29udHJvbGxlclwiLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwYXJ0aWFscy9hZGREYXNoYm9hcmQuaHRtbCcsXG4gICAgICAgICAgICBwYXJlbnQ6IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcbiAgICAgICAgICAgIHRhcmdldEV2ZW50OiBldixcbiAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICBmdWxsc2NyZWVuOiB0cnVlLFxuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbihhbnN3ZXIpIHtcbiAgICAgICAgICAgIGRhc2hib2FyZC5zYXZlKCk7XG4gICAgICAgICAgICAkc2NvcGUucmVmcmVzaF9pbnRlcnZhbCA9ICRzY29wZS5kYXNoYm9hcmRTZXR0aW5ncy5pbnRlcnZhbDtcbiAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkc2NvcGUuZGFzaGJvYXJkcyA9ICRzY29wZS5iYWNrdXBEYXNoYm9hcmRzO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLmJhY2t1cERhc2hib2FyZHMpO1xuICAgICAgICAgICAgJHNjb3BlLmJhY2t1cERhc2hib2FyZHMgPSB7fTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmV2ZXJ0aW5nXCIpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAkc2NvcGUuJG9uKCdzd2l0Y2hEYXNoYm9hcmQnLCBmdW5jdGlvbihldiwgaW5kZXgpIHtcbiAgICAgICAgZGVsZXRlICRsb2NhbFN0b3JhZ2VbJ3RpbWVzdGFtcCddO1xuICAgICAgICBkYXNoYm9hcmQuc3dpdGNoKGluZGV4KVxuICAgICAgICAkc2NvcGUuc2VsZWN0ZWREYXNoYm9hcmQgPSBkYXNoYm9hcmQuYWN0aXZlKCk7XG4gICAgICAgIC8vY29uc29sZS5sb2coKVxuICAgICAgICAkc2NvcGUuJGJyb2FkY2FzdCgncmVsb2FkRGFzaGJvYXJkJyk7XG4gICAgfSk7XG4gICAgXG5cblxufSk7XG5cbmFwcC5jb250cm9sbGVyKCdib3gnLCBmdW5jdGlvbigkc2NvcGUsICRsb2csICRtZERpYWxvZywgUFJPVE9DT0xTLCBUWVBFUywgQ0FURUdPUklFUywgUElFQ0hBUlQsIEFSRUEsIGFwaSwgdXNlciwgJG1kTWVkaWEsICRsb2NhbFN0b3JhZ2UsICR0aW1lb3V0LCBkYXNoYm9hcmQpe1xuICAgIFxuICAgIGZ1bmN0aW9uIHRpbWVTaGlmdChvZmZzZXQpIHtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhvZmZzZXQpXG4gICAgICAgIG9mZnNldCA9IGFuZ3VsYXIuaXNEZWZpbmVkKG9mZnNldCkgPyBvZmZzZXQgOiAwO1xuICAgICAgICAkc2NvcGUuYm94LmNvbmZpZy5iZWdpbnRpbWUgPSAoZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgc2hpZnRfdGltZSA9IChOdW1iZXIob2Zmc2V0KSArIE51bWJlcigkc2NvcGUuYm94LmNvbmZpZy5wZXJpb2QpKSo2MCo2MCoxMDAwO1xuICAgICAgICAgICAgdmFyIHNoaWZ0ZWQgPSBub3cuZ2V0VGltZSgpIC0gc2hpZnRfdGltZTtcbiAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKHNoaWZ0ZWQvMTAwMCk7XG4gICAgICAgIH0pKCk7XG5cbiAgICAgICAgJHNjb3BlLmJveC5jb25maWcuZW5kdGltZSA9IChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpO1xuXG4gICAgICAgICAgICBub3cuc2V0VGltZShub3cuZ2V0VGltZSgpIC0gTnVtYmVyKG9mZnNldCkqNjAqNjAqMTAwMCk7XG4gICAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihub3cvMTAwMCk7XG4gICAgICAgIH0pKCk7XG4gICAgfVxuXG4gICAgdGltZVNoaWZ0KCRzY29wZS5kYXNoYm9hcmQuc2V0dGluZ3MudGltZXNoaWZ0KTtcblxuICAgICRzY29wZS5ib3gubG9hZGluZyA9IHRydWU7XG4gICAgICAgIFxuICAgICRzY29wZS5vcGVuTWVudSA9IGZ1bmN0aW9uKCRtZE9wZW5NZW51LCBldikge1xuICAgICAgICBvcmlnaW5hdG9yRXYgPSBldjtcbiAgICAgICAgJG1kT3Blbk1lbnUoZXYpO1xuICAgIH07XG5cbiAgICAkc2NvcGUuYmFja3VwTW9kZWwgPSB7fTtcblxuICAgICRzY29wZS5wcm90b2NvbCA9IFBST1RPQ09MUztcbiAgICAkc2NvcGUudHlwZXMgPSBUWVBFUztcbiAgICAkc2NvcGUuY2F0ZWdvcmllcyA9IENBVEVHT1JJRVM7XG4gICAgXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgIC8vIEVkaXQgbW9kZSBoYW5kbGluZ1xuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgIC8vIFRyaWdnZXIgZWRpdGluZyBtb2RlIGFuZCBzYXZlIGN1cnJlbnQgc3RhdGVcbiAgICAkc2NvcGUuZWRpdCA9IGZ1bmN0aW9uKGJveCkge1xuICAgICAgICAkc2NvcGUuZWRpdE1vZGUgPSB0cnVlO1xuICAgICAgICAkc2NvcGUuYmFja3VwTW9kZWwgPSBhbmd1bGFyLmNvcHkoYm94KTtcbiAgICB9XG5cbiAgICAvLyBTYXZlIGNoYW5nZXMgYW5kIGRpc2FibGUgZWRpdCBtb2RlXG4gICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgZGFzaGJvYXJkLnNhdmUoKTsgXG5cbiAgICAgICAgJHNjb3BlLmJhY2t1cE1vZGVsID0ge307XG5cbiAgICAgICAgJHNjb3BlLmJveC5jb25maWcudHlwZSA9ICRzY29wZS5ib3gudHlwZTtcbiAgICAgICAgXG4gICAgICAgIC8vIERpc2FibGUgZWRpdCBtb2RlXG4gICAgICAgICRzY29wZS5lZGl0TW9kZSA9IGZhbHNlO1xuXG4gICAgICAgIGNhY2hlX3RpbWUgPSAzMDAgKyAxMDtcblxuICAgICAgICAvLyBHZXQgcmVxdWlyZWQgZGF0YVxuICAgICAgICBnZXREYXRhKCk7XG4gICAgfVxuXG4gICAgLy8gUmV2ZXJ0IHRvIG9yaWdpbmFsIGFuZCBkaXNhYmxlIGVkaXQgbW9kZVxuICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbihib3gpIHtcbiAgICAgICAgJHNjb3BlLmJveCA9IGFuZ3VsYXIuY29weSgkc2NvcGUuYmFja3VwTW9kZWwpO1xuICAgICAgICAkc2NvcGUuYmFja3VwTW9kZWwgPSB7fTtcbiAgICB9XG4gICAgXG4gICAgJHNjb3BlLnRvcCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aW1lU2hpZnQoJHNjb3BlLmJveC5zZXR0aW5ncy50aW1lc2hpZnQpXG4gICAgICAgIGFwaS5nZXQoJ3RvcCcsICRzY29wZS5ib3guY29uZmlnLCB0cnVlKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgJHNjb3BlLmJveC5kYXRhID0gZGF0YTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICB2YXIgY2FjaGVfdGltZSA9IChuZXcgRGF0ZSgpIC0gbmV3IERhdGUoJGxvY2FsU3RvcmFnZVsndGltZXN0YW1wJ10pKS8xMDAwO1xuICAgIGlmIChpc05hTihjYWNoZV90aW1lKSlcbiAgICAgICAgY2FjaGVfdGltZSA9IDMwMCArIDEwO1xuXG4gICAgLy8gU2hvdyBsb2FkaW5nIGluZGljYXRvclxuICAgIGlmIChjYWNoZV90aW1lIDwgMzAwKSB7XG4gICAgICAgICRzY29wZS5ib3gubG9hZGluZyA9IGZhbHNlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgJHNjb3BlLmJveC5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgLy9jb25zb2xlLmxvZygnRGF0YSBpcyBub3QgY2FjaGVkLCByZWRyYXcnKVxuICAgIH1cblxuICAgICRzY29wZS4kb24oJ2dyaWRzdGVyLWl0ZW0taW5pdGlhbGl6ZWQnLCBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIGlmICgkc2NvcGUuYm94LnR5cGUgPT0gJ3BpZWNoYXJ0JyB8fCAkc2NvcGUuYm94LnR5cGUgPT0gJ2JhcmNoYXJ0Jykge1xuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7ICRzY29wZS4kZW1pdCgncmVxdWVzdFJlZHJhdycpO30sIDUwMCk7XG4gICAgICAgIH1cbiAgICB9KVxuXG4gICAgZnVuY3Rpb24gZ2V0RGF0YSgpIHtcbiAgICAgICAgdGltZVNoaWZ0KCRzY29wZS5kYXNoYm9hcmQuc2V0dGluZ3MudGltZXNoaWZ0KTtcbiAgICAgICAgaWYgKCRzY29wZS5ib3gudHlwZSA9PSBcInBpZWNoYXJ0XCIgfHwgJHNjb3BlLmJveC50eXBlID09IFwiYmFyY2hhcnRcIikge1xuICAgICAgICAgICAgLy8gVGhlIGJveCBpcyBhIGNoYXJ0XG4gICAgICAgICAgICBpZiAoJHNjb3BlLmJveC50eXBlID09ICdwaWVjaGFydCcpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYm94Lm9wdGlvbnMgPSBQSUVDSEFSVC5vcHRpb25zO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCRzY29wZS5ib3gudHlwZSA9PSAnYmFyY2hhcnQnKSB7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygkc2NvcGUuYm94LnRpdGxlICsgXCI6IFwiICsgJHNjb3BlLmJveC5zZWxlY3RvcilcbiAgICAgICAgICAgICAgICAkc2NvcGUuYm94Lm9wdGlvbnMgPSBhbmd1bGFyLmNvcHkoQVJFQS5vcHRpb25zKTtcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmJveC5zZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYm94Lm9wdGlvbnMuY2hhcnQueUF4aXMuYXhpc0xhYmVsID0gXCJGbG93IENvdW50XCI7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5ib3gub3B0aW9ucy5jaGFydC55ID0gZnVuY3Rpb24oZCkgeyByZXR1cm4gTnVtYmVyKGQuRmxvd0NvdW50KX0gXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmJveC5vcHRpb25zLmNoYXJ0LnlBeGlzLmF4aXNMYWJlbCA9IFwiRXZlbnRzIENvdW50XCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICBcbiAgICAgICAgICAgICRzY29wZS5ib3guY29uZmlnLnR5cGUgPSAkc2NvcGUuYm94LnR5cGU7XG5cbiAgICAgICAgICAgIGlmIChjYWNoZV90aW1lID4gMzAwKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgcXVlcnkgPSBhbmd1bGFyLmNvcHkoJHNjb3BlLmJveC5jb25maWcpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuYm94LmNvbmZpZy5tZXRyaWMgPT0gXCJjdXN0b21cIikge1xuICAgICAgICAgICAgICAgICAgICBxdWVyeS5tZXRyaWMgPSBxdWVyeS5jdXN0b21fbWV0cmljO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGZvcihpdGVtIGluIHF1ZXJ5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coaXRlbSk7XG4gICAgICAgICAgICAgICAgICAgIGlmKHF1ZXJ5W2l0ZW1dID09IFwiXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeVtpdGVtXSA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cocXVlcnkpXG4gICAgICAgICAgICAgICAgYXBpLmdldCgnYWdnJywgcXVlcnksIGZhbHNlLCB0cnVlKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmJveC5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5ib3guZGF0YSA9IGRhdGE7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS4kZW1pdCgncmVxdWVzdFJlZHJhdycpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKCRzY29wZS5ib3gudHlwZSA9PSAndG9wJyAmJiBjYWNoZV90aW1lID4gMzAwKSB7XG4gICAgICAgICAgICBhcGkuZ2V0KCd0b3AnLCAkc2NvcGUuYm94LmNvbmZpZywgZmFsc2UsIHRydWUpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5ib3gubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5ib3guZGF0YSA9IGRhdGE7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9IGVsc2UgaWYgKCRzY29wZS5ib3gudHlwZSA9PSAnc3VtJyAmJiBjYWNoZV90aW1lID4gMzAwKSB7XG4gICAgICAgICAgICBhcGkuZ2V0KCdjb3VudCcsICRzY29wZS5ib3guY29uZmlnLCBmYWxzZSwgdHJ1ZSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmJveC5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmJveC5kYXRhID0gZGF0YTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgZ2V0RGF0YSgpO1xuXG5cbiAgICAkc2NvcGUuJG9uKCdyZWZyZXNoRGF0YScsIGZ1bmN0aW9uKCkgeyBcbiAgICAgICAgLy9jb25zb2xlLmxvZygncmVmcmVzaGluZycpOyBcbiAgICAgICAgY2FjaGVfdGltZSA9IDMwMCsxMDsgXG4gICAgICAgIGdldERhdGEoKTtcbiAgICB9KVxuIFxuICAgICRzY29wZS4kb24oJ3NhdmVVc2VyJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIGRhc2hib2FyZC5zYXZlKCk7IFxuICAgIH0pO1xuXG4gICAgJHNjb3BlLiRvbignZ3JpZHN0ZXItaXRlbS1yZXNpemVkJywgZnVuY3Rpb24oZ3JpZHN0ZXIpIHtcbiAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coXCJyZXF1ZXN0IGFjY2VwdGVkXCIpO1xuICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgncmVzaXplJykpO1xuICAgICAgICB9LCAxMDApO1xuICAgIH0pXG5cblxuICAgICRzY29wZS5zaG93RWRpdCA9IGZ1bmN0aW9uKGV2LCBib3gpIHtcbiAgICAgICAgJHNjb3BlLmJhY2t1cE1vZGVsID0gYW5ndWxhci5jb3B5KCRzY29wZS5ib3gpO1xuXG4gICAgICAgICRtZERpYWxvZy5zaG93KHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdlZGl0Qm94Q29udHJvbGxlcicsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3BhcnRpYWxzL2VkaXQuaHRtbCcsXG4gICAgICAgICAgICBwYXJlbnQ6IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcbiAgICAgICAgICAgIHRhcmdldEV2ZW50OiBldixcbiAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6dHJ1ZSxcbiAgICAgICAgICAgIGZ1bGxzY3JlZW46IHRydWUsXG4gICAgICAgICAgICBsb2NhbHM6IHtcbiAgICAgICAgICAgICAgICBib3g6ICRzY29wZS5ib3hcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKGFuc3dlcikge1xuICAgICAgICAgICAgJHNjb3BlLnNhdmUoKTtcbiAgICAgICAgfSwgZnVuY3Rpb24oKSB7IC8vIGNhbmNlbFxuICAgICAgICAgICAgJHNjb3BlLmJveCA9IGFuZ3VsYXIuY29weSgkc2NvcGUuYmFja3VwTW9kZWwpO1xuICAgICAgICAgICAgJHNjb3BlLmJhY2t1cE1vZGVsID0ge307XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgfTtcblxuICBcbn0pO1xuXG5hcHAuY29udHJvbGxlcignZ3JpZCcsIGZ1bmN0aW9uKCRzY29wZSwgJHRpbWVvdXQsICRsb2csICRyb3V0ZSwgdXNlciwgZGFzaGJvYXJkKSB7XG4gICAgJHNjb3BlLm9wdCA9IHtcbiAgICAgICAgb3V0ZXJNYXJnaW46IGZhbHNlLFxuICAgICAgICBjb2x1bW5zOiA4LFxuICAgICAgICBwdXNoaW5nOiB0cnVlLFxuICAgICAgICByb3dIZWlnaHQ6IDE3MCxcbiAgICAgICAgY29sV2lkdGggOiAnYXV0bycsXG4gICAgICAgIGZsb2F0aW5nOiB0cnVlLFxuICAgICAgICBzd2FwcGluZzogdHJ1ZSxcbiAgICAgICAgbW9iaWxlQnJlYWtQb2ludDogOTMzLFxuICAgICAgICBkcmFnZ2FibGU6IHtcbiAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgICByZXNpemFibGU6IHtcbiAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICAgICAgaGFuZGxlczogWyduJywgJ2UnLCAncycsICd3JywgJ3NlJywgJ3N3J10sXG4gICAgICAgICAgICBzdG9wOiBmdW5jdGlvbihldmVudCwgJGVsZW1lbnQsIHdpZGdldCkge1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJyZXNpemUgZW5kXCIpO1xuICAgICAgICAgICAgICAgICRzY29wZS4kZW1pdCgncmVxdWVzdFJlZHJhdycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgJHNjb3BlLmRhc2hib2FyZCA9IGRhc2hib2FyZC5nZXQoKTtcbiAgICAkc2NvcGUuaXRlbXMgPSAkc2NvcGUuZGFzaGJvYXJkLml0ZW1zO1xuICAgIC8vY29uc29sZS5sb2coJHNjb3BlLml0ZW1zKTtcblxuICAgICRzY29wZS4kb24oJ2VuYWJsZUdyaWQnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCRzY29wZS5vcHQucmVzaXphYmxlLmVuYWJsZWQgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgJHNjb3BlLiRicm9hZGNhc3QoJ3NhdmVVc2VyJyk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgICRzY29wZS5vcHQucmVzaXphYmxlLmVuYWJsZWQgPSAhJHNjb3BlLm9wdC5yZXNpemFibGUuZW5hYmxlZDsgXG4gICAgICAgICRzY29wZS5vcHQuZHJhZ2dhYmxlLmVuYWJsZWQgPSAhJHNjb3BlLm9wdC5kcmFnZ2FibGUuZW5hYmxlZDsgXG4gICAgfSlcblxuICAgICRzY29wZS5yZW1vdmUgPSBmdW5jdGlvbihib3gpIHtcbiAgICAgICAgdmFyIHRtcCA9ICRzY29wZS5pdGVtcy5zcGxpY2UoJHNjb3BlLml0ZW1zLmluZGV4T2YoYm94KSwgMSk7XG4gICAgICAgICRzY29wZS4kYnJvYWRjYXN0KCdzYXZlVXNlcicpO1xuICAgIH07XG5cbiAgICAkc2NvcGUuJG9uKCdhZGRJdGVtJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBpdGVtID0ge1xuICAgICAgICAgICAgXCJ0aXRsZVwiIDogXCJOZXcgYm94XCIsXG4gICAgICAgICAgICBcImxvYWRpbmdcIiA6IGZhbHNlLFxuICAgICAgICAgICAgc2l6ZVg6IDEsXG4gICAgICAgICAgICBzaXplWTogMSxcbiAgICAgICAgICAgIGNvbnRlbnQ6IFwiXCIsXG4gICAgICAgICAgICBjb25maWcgOiB7XG4gICAgICAgICAgICAgICAgcGVyaW9kIDogMFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9yb3cgOiByb3csXG4gICAgICAgICAgICAvL2NvbCA6IGNvbFxuICAgICAgICB9XG5cbiAgICAgICAgJHNjb3BlLml0ZW1zLnB1c2goaXRlbSlcbiAgICB9KTtcblxuICAgIFxuXG4gICAgJHNjb3BlLiRvbigncmVsb2FkRGFzaGJvYXJkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICRzY29wZS5kYXNoYm9hcmQgPSBkYXNoYm9hcmQuZ2V0KCk7XG4gICAgICAgICRzY29wZS5pdGVtcyA9ICRzY29wZS5kYXNoYm9hcmQuaXRlbXM7XG4gICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS5kYXNoYm9hcmQpO1xuICAgICAgICAkc2NvcGUuJGVtaXQoJ3JlcXVlc3RSZWRyYXcnKVxuICAgIH0pXG5cblxuXG5cbn0pXG5cblxuYXBwLmNvbnRyb2xsZXIoJ2VkaXRCb3hDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkbWREaWFsb2csIGJveCwgUFJPVE9DT0xTLCBUWVBFUywgQ0FURUdPUklFUykge1xuICAgIFxuICAgICRzY29wZS5ib3ggPSBib3g7XG4gICAgXG4gICAgJHNjb3BlLmJhY2t1cE1vZGVsID0gYW5ndWxhci5jb3B5KGJveCk7XG5cbiAgICAkc2NvcGUuY2F0ZWdvcmllcyA9IENBVEVHT1JJRVM7XG4gICAgJHNjb3BlLnByb3RvY29scyA9IFBST1RPQ09MUztcbiAgICAkc2NvcGUudHlwZXMgPSBUWVBFUztcblxuICAgICRzY29wZS5zYXZlQW5kQ2xvc2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICB9O1xuICAgICRzY29wZS5hbnN3ZXIgPSBmdW5jdGlvbihhbnN3ZXIpIHtcbiAgICAgICAgJG1kRGlhbG9nLmhpZGUoYW5zd2VyKTtcbiAgICB9O1xuXG5cbiAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24oYm94KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiQ2FuY2VsbGluZ1wiKTtcbiAgICAgICAgJG1kRGlhbG9nLmNhbmNlbCgpO1xuICAgIH1cblxuICAgICRzY29wZS5jaGFuZ2VTZWxlY3RvciA9IGZ1bmN0aW9uKHNlbCkge1xuICAgICAgICAvL2FuZ3VsYXIuZm9yRWFjaCgkc2NvcGUuYm94LmRhdGEsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgLy8gICAgYW5ndWxhci5mb3JFYWNoKHZhbHVlLnZhbHVlcywgZnVuY3Rpb24odmFsLCBrKSB7XG4gICAgICAgIC8vICAgICAgICB2YWxbJ3NlbGVjdG9yJ10gPSBzZWw7XG4gICAgICAgIC8vICAgIH0pXG4gICAgICAgIC8vfSlcbiAgICAgICAgLy8kc2NvcGUuJGVtaXQoJ3JlcXVlc3RSZWRyYXcnKVxuXG4gICAgfVxuXG5cbn0pO1xuXG5hcHAuY29udHJvbGxlcignYWRkRGFzaGJvYXJkQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJG1kRGlhbG9nLCBkYXNoYm9hcmQpIHtcbiAgICBcbiAgICAkc2NvcGUuZWRpdERhc2hib2FyZCA9IGZhbHNlO1xuICAgIFxuICAgICRzY29wZS5zYXZlQW5kQ2xvc2UgPSBmdW5jdGlvbihhbnN3ZXIpIHtcbiAgICAgICAgLy92YXIgbmV3SW5kZXggPSBkYXNoYm9hcmQuYWRkKGFuc3dlcik7XG4gICAgICAgIC8vZGFzaGJvYXJkLnNhdmUoKTtcbiAgICAgICAgJG1kRGlhbG9nLmhpZGUoYW5zd2VyKTtcbiAgICB9O1xuXG5cbiAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24oYm94KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiQ2FuY2VsbGluZ1wiKTtcbiAgICAgICAgJG1kRGlhbG9nLmNhbmNlbCgpO1xuICAgIH1cblxufSk7XG5cblxuYXBwLmNvbnRyb2xsZXIoJ2VkaXREYXNoYm9hcmRDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkcm9vdFNjb3BlLCAkbWREaWFsb2csIGRhc2hib2FyZCkge1xuICAgIFxuICAgIC8vIExvYWQgZGFzaGJvYXJkIHNldHRpbmdzXG4gICAgJHNjb3BlLmRiID0gZGFzaGJvYXJkLnNldHRpbmdzKCk7XG5cbiAgICAvLyBWYXJpYmxlIHRvIGRpZmZlcmVudGlhdGUgYmV0d2VlbiBlZGl0aW5nIGFuZCBhZGRpbmcgYSBkYXNoYm9hcmRcbiAgICAvLyBXZSBhcmUgdXNpbmcgdGhlIHNhbWUgcGFydGlhbCB0byBkaXNwbGF5IHdpdGhpbiBkaWFsb2dcbiAgICAkc2NvcGUuZWRpdERhc2hib2FyZCA9IHRydWU7XG5cbiBcbiAgICAkc2NvcGUuc2F2ZUFuZENsb3NlID0gZnVuY3Rpb24oYW5zd2VyKSB7XG4gICAgICAgIGRhc2hib2FyZC51cGRhdGUoYW5zd2VyKTtcbiAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLmRlbGV0ZURhc2hib2FyZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBkYXNoYm9hcmQuZGVsZXRlKCk7XG4gICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnc3dpdGNoRGFzaGJvYXJkJywgMCk7XG4gICAgICAgIGRhc2hib2FyZC5zYXZlKCk7XG4gICAgICAgICRtZERpYWxvZy5oaWRlKCk7XG4gICAgfVxuXG5cbiAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24oYm94KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiQ2FuY2VsbGluZ1wiKTtcbiAgICAgICAgJG1kRGlhbG9nLmNhbmNlbCgpO1xuICAgIH1cblxufSk7XG4iLCJhcHAuY29udHJvbGxlcignbG9naW5Db250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkbG9jYXRpb24sICRsb2csIHVzZXIpIHtcblx0JHNjb3BlLnRpdGxlID0gXCJMb2dpbiB0byBOZW1lYSBEYXNoYm9hcmRcIjtcblx0JHNjb3BlLmxvZ2luQnRuID0gXCJMb2dpblwiO1xuICAgIFxuICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbihjcmVkKSB7XG5cdFx0JHNjb3BlLmxvZ2luQnRuID0gXCJBdXRoZW50aWNhdGluZy4uLlwiO1xuICAgICAgICAkc2NvcGUubG9naW5CdG5EaXNhYmxlZCA9IHRydWU7XG5cbiAgICAgICAgdXNlci5hdXRoKGNyZWQpXG4gICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7ICAgIFxuICAgICAgICB9KVxuICAgICAgICAuZXJyb3IoZnVuY3Rpb24obXNnKSB7XG4gICAgICAgICAgICAkc2NvcGUuZXJyb3JfbWVzID0gbXNnO1xuICAgICAgICAgICAgJHNjb3BlLmxvZ2luQnRuID0gXCJMb2dpblwiXG4gICAgICAgICAgICAkc2NvcGUubG9naW5CdG5EaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICB9KVxuICAgIH1cblxuXG4gICAgdmFyIHBhdHRlcm4gPSBUcmlhbmdsaWZ5KHtcbiAgICAgICAgd2lkdGg6IHdpbmRvdy5pbm5lcldpZHRoLFxuICAgICAgICBoZWlnaHQ6IHdpbmRvdy5pbm5lckhlaWdodCxcbiAgICAgICAgeF9jb2xvcnM6ICdHbkJ1JyxcbiAgICAgICAgeV9jb2xvcnM6ICdHbkJ1JyxcbiAgICAgICAgY2VsbF9zaXplOiA1MFxuXG4gICAgfSk7XG5cbiAgICBjb25zb2xlLmxvZyhwYXR0ZXJuKTtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvZ2luXCIpLmFwcGVuZENoaWxkKHBhdHRlcm4uY2FudmFzKCkpXG5cblxuXHRcdFxuXHRcdC8qbG9naW5BdXRoLmZldGNoVXNlcih1c2VyKVxuXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcblxuXHRcdFx0JGxvZy5pbmZvKGRhdGEpO1xuXG5cdFx0XHRpZiAoZGF0YVtcInN1Y2Nlc3NcIl0gPT0gdHJ1ZSkge1xuXHRcdFx0XHQvLyRsb2cuaW5mbyhkYXRhKTtcdFxuXHRcdFx0XHQkc2NvcGUubG9naW5CdG4gPSBcIlN1Y2Nlc3NcIjtcblx0XHRcdFx0JGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuXHRcdFx0XHRsb2NhbFN0b3JhZ2VTZXJ2aWNlLnNldCgnbG9nZ2VkSW4nLCB0cnVlKTtcblx0XHRcdFx0bG9jYWxTdG9yYWdlU2VydmljZS5zZXQoJ2xvZ2dlZEluLnB3Jywgc2hhMjU2X2RpZ2VzdChkYXRhLnBhc3N3b3JkKSk7XHRcblx0XHRcdH1cblx0XHRcdGVsc2Uge1xuXHRcdFx0XHQkbG9nLmVycm9yKFwiZXJyb3IgLSBiYWQgcGFzc3dvcmRcIik7XG5cdFx0XHRcdCRzY29wZS5lcnJvcl9tZXMgPSBcIkJhZCBwYXNzd29yZFwiO1xuXHRcdFx0XHQkc2NvcGUubG9naW5CdG4gPSBcIkxvZ2luXCI7XG5cdFx0XHRcdGxvZ2luQ29ycmVjdCA9IGZhbHNlO1xuXHRcdFx0XHRsb2NhbFN0b3JhZ2VTZXJ2aWNlLnNldCgnbG9nZ2VkSW4nLCBmYWxzZSk7XHRcblx0XHRcdH1cblx0XHR9KTsqL1xufSk7XG5cblxuIiwiYXBwLmNvbnRyb2xsZXIoJ3Byb2ZpbGVDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkbG9nLCAkbG9jYWxTdG9yYWdlLCB1c2VyLCBkYXNoYm9hcmQpIHtcbiAgICAkc2NvcGUudXNlciA9IHVzZXIuZ2V0KCk7XG5cbiAgICAkc2NvcGUuc2F2ZV9idG4gPSBcIlNhdmVcIjtcblxuICAgICRzY29wZS5lZGl0VXNlciA9IGZ1bmN0aW9uKHVzZXJfZGF0YSkge1xuICAgICAgICAkc2NvcGUuc2F2ZV9idG4gPSBcIlByb2Nlc3NpbmcuLi5cIjtcblxuICAgICAgICB1c2VyX2RhdGFbXCJzZXR0aW5nc1wiXSA9IGRhc2hib2FyZC5jbGVhbigpO1xuXG4gICAgICAgIHVzZXIucHV0KHVzZXJfZGF0YSwgdHJ1ZSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAkbG9jYWxTdG9yYWdlW1widG9rZW5cIl0gPSBkYXRhW1wiand0XCJdO1xuICAgICAgICAgICAgJHNjb3BlLmVycl9tc2cgPSBcIlwiO1xuICAgICAgICAgICAgJHNjb3BlLnVzZXIgPSBhbmd1bGFyLmNvcHkodXNlci5nZXQoKSk7XG4gICAgICAgICAgICAkc2NvcGUuc2F2ZV9idG4gPSBcIlNhdmVcIjtcbiAgICAgICAgfSlcbiAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICRzY29wZS5zYXZlX2J0biA9IFwiU2F2ZVwiO1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAkbG9nLmVycm9yKGRhdGFbXCJlcnJvclwiXSk7XG4gICAgICAgICAgICAkc2NvcGUudXNlci5wYXNzd29yZCA9IFwiXCI7XG4gICAgICAgICAgICAkc2NvcGUuZXJyX21zZyA9IGRhdGFbXCJlcnJvclwiXTtcbiAgICAgICAgfSlcbiAgICB9XG59KVxuIiwiYXBwLmNvbnRyb2xsZXIoJ3VzZXJzQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgYXBpLCB1c2VyLCAkbWREaWFsb2cpIHtcbiAgICBcbiAgICB1c2VyLmdldCh0cnVlKS5zdWNjZXNzKGZ1bmN0aW9uKGQpIHskc2NvcGUucGVvcGxlID0gZH0pO1xuXG4gICAgLy8kc2NvcGUudXNlcnMgPSB1c2VycztcbiAgICAvKi5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgY29uc29sZS5sb2coZGF0YSlcbiAgICAgICAgJHNjb3BlLnVzZXJzID0gZGF0YTtcbiAgICB9KTsqL1xuXG5cbiAgICAkc2NvcGUubXlVc2VybmFtZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdG1wID0gdXNlci5nZXQoKTtcbiAgICAgICAgcmV0dXJuIHRtcFsndXNlcm5hbWUnXTtcbiAgICB9XG5cbiAgICAkc2NvcGUuZGVsZXRlVXNlciA9IGZ1bmN0aW9uKHVzZXJfaWQpIHtcbiAgICAgICAgY29uc29sZS5sb2codXNlcl9pZCk7XG4gICAgICAgIHVzZXIuZGVsZXRlKHVzZXJfaWQpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICB1c2VyLmdldCh0cnVlKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUudXNlcnMgPSBkYXRhO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgJHNjb3BlLmFkZFVzZXIgPSBmdW5jdGlvbihldikge1xuICAgICAgICAkc2NvcGUuYWRkVXNlckJveCA9IHRydWU7XG4gICAgICAgICRtZERpYWxvZy5zaG93KHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdhZGRVc2VyQ29udHJvbGxlcicsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3BhcnRpYWxzL2FkZFVzZXIuaHRtbCcsXG4gICAgICAgICAgICBwYXJlbnQ6IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcbiAgICAgICAgICAgIHRhcmdldEV2ZW50OiBldixcbiAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6dHJ1ZSxcbiAgICAgICAgICAgIGZ1bGxzY3JlZW46IHRydWUsXG4gICAgICAgICAgICAvKmxvY2Fsczoge1xuICAgICAgICAgICAgICAgIGJveDogJHNjb3BlLmJveFxuICAgICAgICAgICAgfSwqL1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihmdW5jdGlvbihhbnN3ZXIpIHtcbiAgICAgICAgICAgIC8vJHNjb3BlLnNhdmUoKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGFuc3dlcilcbiAgICAgICAgICAgIHVzZXIucG9zdChhbnN3ZXIpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuXG4gICAgICAgICAgICAgICAgdXNlci5nZXQodHJ1ZSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS51c2VycyA9IGRhdGE7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9LCBmdW5jdGlvbigpIHsgLy8gY2FuY2VsXG4gICAgICAgICAgICAvLyRzY29wZS5ib3ggPSBhbmd1bGFyLmNvcHkoJHNjb3BlLmJhY2t1cE1vZGVsKTtcbiAgICAgICAgICAgIC8vJHNjb3BlLmJhY2t1cE1vZGVsID0ge307XG4gICAgICAgIH0pO1xuXG4gICAgfVxufSk7XG5cbmFwcC5jb250cm9sbGVyKCdhZGRVc2VyQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJG1kRGlhbG9nKSB7XG5cbiAgICAkc2NvcGUudXNlciA9IHtcbiAgICAgICAgdXNlcm5hbWUgOiAnJyxcbiAgICAgICAgbmFtZSA6ICcnLFxuICAgICAgICBzdXJuYW1lIDogJycsXG4gICAgICAgIHBhc3N3b3JkIDogJycsXG4gICAgICAgIHNldHRpbmdzIDpbXG5cdFx0e1xuXHRcdFx0XCJzZXR0aW5nc1wiIDoge1xuXHRcdFx0XHRcInRpdGxlXCIgOiBcIkJhc2ljXCIsXG5cdFx0XHRcdFwidGltZXNoaWZ0XCIgOiBcIjBcIixcblx0XHRcdFx0XCJpbnRlcnZhbFwiIDogXCI2MFwiXG5cdFx0XHR9LFxuXHRcdFx0XCJpdGVtc1wiIDogW1xuXHRcdFx0XHR7XG5cdFx0XHRcdFx0XCJsb2FkaW5nXCIgOiBmYWxzZSxcblx0XHRcdFx0XHRcInJvd1wiIDogMCxcblx0XHRcdFx0XHRcImNvbmZpZ1wiIDoge1xuXHRcdFx0XHRcdFx0XCJwZXJpb2RcIiA6IFwiMjRcIixcblx0XHRcdFx0XHRcdFwidHlwZVwiIDogXCJwaWVjaGFydFwiLFxuXHRcdFx0XHRcdFx0XCJtZXRyaWNcIiA6IFwiY2F0ZWdvcnlcIlxuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XCJzaXplWFwiIDogNCxcblx0XHRcdFx0XHRcInNpemVZXCIgOiAzLFxuXHRcdFx0XHRcdFwiY29sXCIgOiAwLFxuXHRcdFx0XHRcdFwidGl0bGVcIiA6IFwiMjRoIHNoYXJlc1wiLFxuXHRcdFx0XHRcdFwidHlwZVwiIDogXCJwaWVjaGFydFwiLFxuXHRcdFx0XHRcdFwiY29udGVudFwiIDogXCJDbGljayB0aGUgbWVudSBpY29uIHRvIHNlbGVjdCBlZGl0XCJcblx0XHRcdFx0fVxuXHRcdFx0XVxuXHRcdH1cblx0XVxuXHR9XG4gICAgJHNjb3BlLnNhdmVBbmRDbG9zZSA9IGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgY29uc29sZS5sb2codXNlcilcbiAgICAgICAgJG1kRGlhbG9nLmhpZGUodXNlcik7XG4gICAgfTtcblxuICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbihib3gpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJDYW5jZWxsaW5nXCIpO1xuICAgICAgICAkbWREaWFsb2cuY2FuY2VsKCk7XG4gICAgfVxufSlcbiIsImFwcC5kaXJlY3RpdmUoJ2dyaWRzdGVyRHluYW1pY0hlaWdodCcsIGZ1bmN0aW9uICgkdGltZW91dCkge1xuXG4gICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIGl0ZW06IFwiPVwiIC8vZ3JpZHN0ZXIgaXRlbVxuICAgICAgICB9LFxuICAgICAgICBsaW5rOiBsaW5rLFxuICAgICAgICByZXN0cmljdDogJ0EnXG4gICAgfTtcbiAgICByZXR1cm4gZGlyZWN0aXZlO1xuXG4gICAgZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgc2NvcGUuJHdhdGNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnRbMF0uc2Nyb2xsSGVpZ2h0O1xuICAgICAgICB9LFxuICAgICAgICBmdW5jdGlvbihuZXdWYWwsIG9sZFZhbCkgeyBcbiAgICAgICAgICAgIHZhciByb3dIZWlnaHRPcHRpb24gPSAyNzA7IC8vIENoYW5nZSB0aGlzIHZhbHVlIHdpdGggeW91ciBvd24gcm93SGVpZ2h0IG9wdGlvblxuICAgICAgICAgICAgdmFyIGhlaWdodCA9IHJvd0hlaWdodE9wdGlvbiAqIHNjb3BlLml0ZW0uc2l6ZVk7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKHNjb3BlLml0ZW0udGl0bGUpO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIm5ld1ZhbDogXCIgKyBuZXdWYWwgKyBcIiAgICAgaGVpZ2h0OiBcIiArIGhlaWdodClcbiAgICAgICAgICAgIGlmKG5ld1ZhbCA+IGhlaWdodCl7XG4gICAgICAgICAgICAgICAgdmFyIGRpdiA9IE1hdGguZmxvb3IobmV3VmFsIC8gcm93SGVpZ2h0T3B0aW9uKTtcbiAgICAgICAgICAgICAgICAvL2RpdisrO1xuICAgICAgICAgICAgICAgIHNjb3BlLml0ZW0uc2l6ZVkgPSBkaXY7IFxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgIH1cbn0pO1xuIiwiYXBwLnNlcnZpY2UoJ2FwaScsIGZ1bmN0aW9uKCRodHRwLCAkbG9nLCAkbWRUb2FzdCwgJGxvY2FsU3RvcmFnZSwgUElFQ0hBUlQsIENPTkZJRykge1xuXG5cdHZhciBhZGRyID0gQ09ORklHW1wiaG9zdFwiXSArIFwiOlwiICsgQ09ORklHW1wicG9ydFwiXSArIFwiL1wiICsgQ09ORklHW1widmVyc2lvblwiXSArIFwiL2V2ZW50cy9cIjtcblxuICAgIHRoaXMuYXV0aCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gJGxvY2FsU3RvcmFnZVtcInRva2VuXCJdO1xuICAgIH1cblxuICAgIHRoaXMuY29uZmlnID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICRodHRwLmdldCgnaHR0cDovL2JlbmVmaXppby5saWJlcm91dGVyLm9yZzo1NTU1L2NvbmZpZycpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgdGhpcy5hZGRyID0gZGF0YS5ob3N0ICsgJzonICsgZGF0YS5wb3J0ICsgZGF0YS5ldmVudHM7XG4gICAgICAgICAgICAkbG9jYWxTdG9yYWdlWydjb25maWcnXSA9IGRhdGE7XG4gICAgICAgICAgICBhbGVydChkYXRhKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgdGhpcy5nZXQgPSBmdW5jdGlvbih1cmwsIHBhcmFtcywgaW5mbywgY2FjaGUpIHtcblx0XHRyZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgdXJsIDogYWRkciArIHVybCxcbiAgICAgICAgICAgIG1ldGhvZCA6IFwiR0VUXCIsXG4gICAgICAgICAgICBwYXJhbXMgOiBwYXJhbXMsXG4gICAgICAgICAgICBoZWFkZXJzIDoge1xuICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJyA6IHRoaXMuYXV0aCgpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIGlmIChpbmZvKSB7XG4gICAgICAgICAgICAgICAgJG1kVG9hc3Quc2hvdyhcbiAgICAgICAgICAgICAgICAgICAgJG1kVG9hc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zaW1wbGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRleHRDb250ZW50KCdEYXRhIHN1Y2Nlc3N1bGx5IGxvYWRlZCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAucG9zaXRpb24oXCJ0b3AgcmlnaHRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoMzAwMClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVtZShcInN1Y2Nlc3MtdG9hc3RcIilcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY2FjaGUpXG4gICAgICAgICAgICAgICAgJGxvY2FsU3RvcmFnZVsndGltZXN0YW1wJ10gPSBuZXcgRGF0ZSgpO1xuXG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgfSlcbiAgICAgICAgLmVycm9yKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJGxvZy5lcnJvcignQ2Fubm90IGZldGNoIGRhdGEnKTtcbiAgICAgICAgICAgICRtZFRvYXN0LnNob3coXG4gICAgICAgICAgICAgICAgJG1kVG9hc3Quc2ltcGxlKClcbiAgICAgICAgICAgICAgICAgICAgLnRleHRDb250ZW50KCdDYW5ub3QgbG9hZCBkYXRhJylcbiAgICAgICAgICAgICAgICAgICAgLnBvc2l0aW9uKFwidG9wIHJpZ2h0XCIpXG4gICAgICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoMzAwMClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW1lKFwiZXJyb3ItdG9hc3RcIilcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgdGhpcy5wb3N0ID0gZnVuY3Rpb24odXJsLCBkYXRhLCBpbmZvKSB7XG4gICAgICAgIHJldHVybiAkaHR0cC5wb3N0KGFkZHIgKyB1cmwsIEpTT04uc3RyaW5naWZ5KGRhdGEpKVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmIChpbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgICRtZFRvYXN0LnNob3coXG4gICAgICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zaW1wbGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0Q29udGVudCgnRGF0YSBzdWNjZXNzZnVsbHkgbG9hZGVkJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucG9zaXRpb24oXCJ0b3AgcmlnaHRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaGlkZURlbGF5KDMwMDApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW1lKFwic3VjY2Vzcy10b2FzdFwiKVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTsgICAgICAgIFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIFx0JGxvZy5lcnJvcignQ2Fubm90IGZldGNoIGRhdGEnKTtcbiAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxuICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaW1wbGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRleHRDb250ZW50KCdDYW5ub3QgZmV0Y2ggZGF0YScpXG4gICAgICAgICAgICAgICAgICAgICAgICAucG9zaXRpb24oXCJ0b3AgcmlnaHRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoMzAwMClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVtZShcImVycm9yLXRvYXN0XCIpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pXG4gICAgfVxuXG4gICAgdGhpcy5wdXQgPSBmdW5jdGlvbih1cmwsIGRhdGEsIGluZm8pIHtcbiAgICAgICAgcmV0dXJuICRodHRwLnB1dChhZGRyICsgdXJsLCBKU09OLnN0cmluZ2lmeShkYXRhKSlcbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBpZiAoaW5mbykge1xuICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxuICAgICAgICAgICAgICAgICAgICAgICAgJG1kVG9hc3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2ltcGxlKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQoJ0RhdGEgc3VjY2Vzc2Z1bGx5IGxvYWRlZCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnBvc2l0aW9uKFwidG9wIHJpZ2h0XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmhpZGVEZWxheSgzMDAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVtZShcInN1Y2Nlc3MtdG9hc3RcIilcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7ICAgICAgICBcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcdCRsb2cuZXJyb3IoJ0Nhbm5vdCBmZXRjaCBkYXRhJyk7XG4gICAgICAgICAgICAgICAgJG1kVG9hc3Quc2hvdyhcbiAgICAgICAgICAgICAgICAgICAgJG1kVG9hc3Quc2ltcGxlKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0Q29udGVudCgnQ2Fubm90IGZldGNoIGRhdGEnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnBvc2l0aW9uKFwidG9wIHJpZ2h0XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuaGlkZURlbGF5KDMwMDApXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbWUoXCJlcnJvci10b2FzdFwiKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KVxuICAgIH1cblxuXG59KTtcblxuXG4iLCJhcHAuc2VydmljZSgnZGFzaGJvYXJkJywgZnVuY3Rpb24oJGxvZywgJGxvY2FsU3RvcmFnZSwgdXNlcikge1xuXG4gICAgdmFyIHNlbGVjdGVkRGFzaGJvYXJkID0gMDtcbiAgICB2YXIgZGFzaGJvYXJkcyA9ICRsb2NhbFN0b3JhZ2VbJ2Rhc2hib2FyZCddO1xuICAgIHZhciBhY3RpdmUgPSAkbG9jYWxTdG9yYWdlWydkYXNoYm9hcmQnXVtzZWxlY3RlZERhc2hib2FyZF07XG4gICAgdmFyIGJhY2t1cDtcblxuICAgIHRoaXMuZ2V0QWxsID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAkbG9jYWxTdG9yYWdlWydkYXNoYm9hcmQnXTtcbiAgICB9XG5cbiAgICB0aGlzLmdldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gICRsb2NhbFN0b3JhZ2VbJ2Rhc2hib2FyZCddW3NlbGVjdGVkRGFzaGJvYXJkXTtcbiAgICB9XG5cbiAgICB0aGlzLnNldHRpbmdzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAgJGxvY2FsU3RvcmFnZVsnZGFzaGJvYXJkJ11bc2VsZWN0ZWREYXNoYm9hcmRdLnNldHRpbmdzO1xuICAgIH1cblxuICAgIHRoaXMuYWN0aXZlID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKGluZGV4KSkge1xuICAgICAgICAgICAgc2VsZWN0ZWREYXNoYm9hcmQgPSBpbmRleFxuICAgICAgICB9XG5cbiAgICAgICAgLy9hY3RpdmUgPSAkbG9jYWxTdG9yYWdlWydkYXNoYm9hcmQnXVtzZWxlY3RlZERhc2hib2FyZF07XG5cbiAgICAgICAgcmV0dXJuIHNlbGVjdGVkRGFzaGJvYXJkO1xuICAgIH1cblxuICAgIHRoaXMudXBkYXRlID0gZnVuY3Rpb24odXBkYXRlZERhc2hib2FyZCkge1xuICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZCh1cGRhdGVkRGFzaGJvYXJkKSlcbiAgICAgICAgICAgIGFjdGl2ZS5zZXR0aW5ncyA9IDA7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGFjdGl2ZS5zZXR0aW5ncyA9IHVwZGF0ZWREYXNoYm9hcmQ7XG5cbiAgICAgICAgLy9kYXNoYm9hcmRzID0gJGxvY2FsU3RvcmFnZVsnZGFzaGJvYXJkJ107XG4gICAgfVxuXG4gICAgdGhpcy5jbGVhbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgdmFyIHNldHRpbmdzID0gYW5ndWxhci5jb3B5KCRsb2NhbFN0b3JhZ2VbJ2Rhc2hib2FyZCddKTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhzZXR0aW5ncylcbiAgICAgICAgXG4gICAgICAgIC8vIFJlbW92ZSBkYXRhIGFuZCBncmFwaCBvcHRpb25zXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2V0dGluZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coc2V0dGluZ3NbaV0pO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhzZXR0aW5nc1tpXS5pdGVtcy5sZW5ndGgpXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNldHRpbmdzW2ldLml0ZW1zLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHNldHRpbmdzW2ldLml0ZW1zW2pdW1wiZGF0YVwiXTtcbiAgICAgICAgICAgICAgICBkZWxldGUgc2V0dGluZ3NbaV0uaXRlbXNbal1bXCJvcHRpb25zXCJdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNldHRpbmdzO1xuICAgIH1cblxuICAgIHRoaXMuc2F2ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgIFxuICAgICAgICB2YXIgcXVlcnkgPSB7XG4gICAgICAgICAgICBcInNldHRpbmdzXCIgOiB0aGlzLmNsZWFuKClcbiAgICAgICAgfVxuXG4gICAgICAgIC8vY29uc29sZS5sb2cocXVlcnkpXG5cbiAgICAgICAgLy8kbG9nLmluZm8ocXVlcnkpXG4gICAgICAgIHJldHVybiB1c2VyLnB1dChxdWVyeSlcbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICAgICAkbG9nLmVycm9yKGRhdGEpXG4gICAgICAgICAgICB9KVxuICAgIH1cblxuICAgIHRoaXMuYWRkID0gZnVuY3Rpb24obmV3RGFzaGJvYXJkKSB7XG4gICAgICAgIC8vIFdlIG5lZWQgdG8gc2V0IHVwIGZpcnN0IGl0ZW0gaW4gZGFzaGJvYXJkIFxuICAgICAgICB2YXIgdG1wRGFzaGJvYXJkID0ge1xuICAgICAgICAgICAgc2V0dGluZ3MgOiBuZXdEYXNoYm9hcmQsXG4gICAgICAgICAgICBpdGVtcyA6IFt7XG4gICAgICAgICAgICAgICAgXCJ0aXRsZVwiIDogXCJOZXcgYm94XCIsXG4gICAgICAgICAgICAgICAgXCJsb2FkaW5nXCIgOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBzaXplWDogMSxcbiAgICAgICAgICAgICAgICBzaXplWTogMSxcbiAgICAgICAgICAgICAgICBjb250ZW50OiBcIkNsaWNrIHRoZSBtZW51IGljb24gdG8gc2VsZWN0IGVkaXRcIixcbiAgICAgICAgICAgICAgICBjb25maWcgOiB7XG4gICAgICAgICAgICAgICAgICAgIHBlcmlvZCA6IFwiMFwiXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XVxuICAgICAgICB9XG5cbiAgICAgICAgJGxvY2FsU3RvcmFnZVsnZGFzaGJvYXJkJ10ucHVzaCh0bXBEYXNoYm9hcmQpO1xuICAgICAgICAvL2NvbnNvbGUubG9nKCAkbG9jYWxTdG9yYWdlWydkYXNoYm9hcmQnXS5sZW5ndGggLSAxKTtcblxuICAgICAgICByZXR1cm4gKCAkbG9jYWxTdG9yYWdlWydkYXNoYm9hcmQnXS5sZW5ndGggLSAxKTtcblxuICAgIH1cblxuICAgIHRoaXMuZGVsZXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGJhY2t1cCA9ICAkbG9jYWxTdG9yYWdlWydkYXNoYm9hcmQnXS5zcGxpY2UoICRsb2NhbFN0b3JhZ2VbJ2Rhc2hib2FyZCddLmluZGV4T2YoYWN0aXZlKSwgMSk7XG4gICAgICAgIHNlbGVjdGVkRGFzaGJvYXJkID0gMDtcblxuICAgICAgICByZXR1cm4gYmFja3VwO1xuICAgIFxuICAgIH1cblxuICAgIHRoaXMuc3dpdGNoID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgYWN0aXZlID0gJGxvY2FsU3RvcmFnZVsnZGFzaGJvYXJkJ11baW5kZXhdO1xuICAgICAgICBzZWxlY3RlZERhc2hib2FyZCA9IGluZGV4O1xuICAgICAgICByZXR1cm4gYWN0aXZlO1xuICAgIH1cblxuICAgIHRoaXMucmVzZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgc2VsZWN0ZWREYXNoYm9hcmQgPSAwO1xuICAgICAgICBhY3RpdmUgPSAkbG9jYWxTdG9yYWdlWydkYXNoYm9hcmQnXVtzZWxlY3RlZERhc2hib2FyZF1cbiAgICB9XG4gICAgICAgIFxufSk7XG4iLCJhcHAuZGlyZWN0aXZlKFwic2lkZWJhck1lbnVcIiwgZnVuY3Rpb24oKSB7XG5cdHJldHVybiB7XG4gICAgICAgIHNjb3BlOiB7XG5cdFx0XHRzZWN0aW9uOiAnPSdcblx0XHR9LFxuXHRcdHRlbXBsYXRlVXJsOiAncGFydGlhbHMvc2lkZWJhci1tZW51Lmh0bWwnLFxuICAgICAgICBjb250cm9sbGVyOiBmdW5jdGlvbigkc2NvcGUsICRtZFNpZGVuYXYsICRtZERpYWxvZywgJGxvY2F0aW9uLCBNRU5VLCB1c2VyLCBkYXNoYm9hcmQpIHtcbiAgICAgICAgICAgICRzY29wZS5tZW51ID0gTUVOVTtcblxuICAgICAgICAgICAgJHNjb3BlLmRhc2hib2FyZHMgPSBkYXNoYm9hcmQuZ2V0QWxsKCk7XG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWREYXNoYm9hcmQgPSBkYXNoYm9hcmQuYWN0aXZlKCk7XG5cbiAgICAgICAgICAgICRzY29wZS5pc0FjdGl2ZSA9IGZ1bmN0aW9uKGN1cnJlbnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4oJyMnICsgJGxvY2F0aW9uLnBhdGgoKSA9PSBjdXJyZW50KTtcbiAgICAgICAgICAgIH0gICBcblxuICAgICAgICAgICAgJHNjb3BlLmVuYWJsZSA9IHRydWU7XG5cbiAgICAgICAgICAgICRzY29wZS50b2dnbGVJdGVtID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZUJ0biA9IFwidG9nZ2xlZFwiO1xuICAgICAgICAgICAgfTtcblxuXG4gICAgICAgICAgICAkc2NvcGUuY2xvc2VMZWZ0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJG1kU2lkZW5hdignbGVmdCcpLnRvZ2dsZSgpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgJHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGRhc2hib2FyZC5yZXNldCgpO1xuICAgICAgICAgICAgICAgIHVzZXIubG9nb3V0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICRzY29wZS5hZGREYXNoYm9hcmQgPSBmdW5jdGlvbihldikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQWRkaW5nIG5ldyBkYXNoYm9hcmRcIik7XG5cbiAgICAgICAgICAgICAgICAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdhZGREYXNoYm9hcmRDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwYXJ0aWFscy9hZGREYXNoYm9hcmQuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIHBhcmVudDogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpLFxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRFdmVudDogZXYsXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrT3V0c2lkZVRvQ2xvc2U6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGZ1bGxzY3JlZW46IHRydWUsXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihhbnN3ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld0luZGV4ID0gZGFzaGJvYXJkLmFkZChhbnN3ZXIpO1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKG5ld0luZGV4KVxuICAgICAgICAgICAgICAgICAgICBkYXNoYm9hcmQuc2F2ZSgpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGVtaXQoJ3N3aXRjaERhc2hib2FyZCcsIG5ld0luZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkRGFzaGJvYXJkID0gZGFzaGJvYXJkLmFjdGl2ZShuZXdJbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIC8qZGFzaGJvYXJkLnN3aXRjaChuZXdJbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZERhc2hib2FyZCA9IG5ld0luZGV4O1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGJyb2FkY2FzdCgncmVsb2FkRGFzaGJvYXJkJyk7ICovXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oKSB7IC8vIGNhbmNlbFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgLypmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAvLyRzY29wZS4kZW1pdCgnYWRkRGFzaGJvYXJkJyk7XG4gICAgICAgICAgICB9Ki9cblxuICAgICAgICAgICAgJHNjb3BlLnN3aXRjaERhc2hib2FyZCA9IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkRGFzaGJvYXJkID0gZGFzaGJvYXJkLmFjdGl2ZShpbmRleCk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLiRlbWl0KCdzd2l0Y2hEYXNoYm9hcmQnLCBpbmRleCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICRzY29wZS4kb24oJ3N3aXRjaERhc2hib2FyZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic3dpdGNoaW5nXCIpO1xuICAgICAgICAgICAgICAgICRzY29wZS5zZWxlY3RlZERhc2hib2FyZCA9IGRhc2hib2FyZC5hY3RpdmUoKTtcbiAgICAgICAgICAgIH0pXG4gICAgXG4gXG4gICAgICAgIH1cblx0fTtcbn0pO1xuXG5hcHAuZGlyZWN0aXZlKFwidG9wYmFyTWVudVwiLCBmdW5jdGlvbigpIHtcblx0cmV0dXJuIHtcblx0XHRzY29wZToge1xuXHRcdFx0c2VjdGlvbjogJz0nXG5cdFx0fSxcblx0XHR0ZW1wbGF0ZVVybDogJ3BhcnRpYWxzL3RvcGJhci1tZW51Lmh0bWwnLFxuICAgICAgICBjb250cm9sbGVyIDogZnVuY3Rpb24oJHNjb3BlLCAkbWRTaWRlbmF2KSB7XG4gICAgICAgICAgICAkc2NvcGUudG9nZ2xlTGVmdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICRtZFNpZGVuYXYoJ2xlZnQnKS50b2dnbGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXHR9O1xufSk7XG5cblxuYXBwLmRpcmVjdGl2ZShcImJveGVzXCIsIGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4ge1xuXHRcdHNjb3BlOiB7XG5cdFx0XHRzZWN0aW9uOiAnPSdcblx0XHR9LFxuXHRcdHRlbXBsYXRlVXJsOiAncGFydGlhbHMvYm94ZXMuaHRtbCdcblx0fTtcbn0pO1xuXG5cbiIsImFwcC5zZXJ2aWNlKCd1c2VyJywgZnVuY3Rpb24oJGxvY2FsU3RvcmFnZSwgJGh0dHAsICRtZFRvYXN0LCAkbG9jYXRpb24sICRsb2csIENPTkZJRyl7XG4gICAgdmFyIGNhY2hlID0gbnVsbDtcblxuICAgIHZhciBkYXNoYm9hcmQgPSBbXTtcblxuXHR2YXIgYWRkciA9IENPTkZJR1tcImhvc3RcIl0gKyBcIjpcIiArIENPTkZJR1tcInBvcnRcIl0gKyBcIi9cIiArIENPTkZJR1tcInZlcnNpb25cIl0gKyBcIi91c2Vycy9cIjtcblxuICAgIHRoaXMuY29uZmlnID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAkbG9jYWxTdG9yYWdlW1wiZGFzaGJvYXJkXCJdO1xuICAgIH1cblxuICAgIHRoaXMuand0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB0b2tlbiA9ICRsb2NhbFN0b3JhZ2VbJ3Rva2VuJ107XG4gICAgICAgIHZhciBiYXNlNjRVcmwgPSB0b2tlbi5zcGxpdCgnLicpWzFdO1xuICAgICAgICB2YXIgYmFzZTY0ID0gYmFzZTY0VXJsLnJlcGxhY2UoJy0nLCAnKycpLnJlcGxhY2UoJ18nLCAnLycpO1xuICAgICAgICByZXR1cm4gSlNPTi5wYXJzZSh3aW5kb3cuYXRvYihiYXNlNjQpKTtcbiAgICB9XG5cbiAgICB0aGlzLmF1dGggPSBmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGFkZHIpO1xuICAgICAgICByZXR1cm4gJGh0dHAucG9zdChhZGRyICsgXCJhdXRoXCIsIGFuZ3VsYXIudG9Kc29uKHVzZXIpKVxuICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAkbG9jYWxTdG9yYWdlW1widG9rZW5cIl0gPSBkYXRhW1wiand0XCJdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBUT0RPOiBkaWZmZXJlbnRpYXRlIGJldHdlZW4gY29uZmlnIGFuZCBqd3QgPj4gZHVwbGljaXR5XG4gICAgICAgICAgICBkZWxldGUgJGxvY2FsU3RvcmFnZVtcImRhc2hib2FyZFwiXTtcbiAgICAgICAgICAgICRsb2NhbFN0b3JhZ2VbXCJkYXNoYm9hcmRcIl0gPSBkYXRhW1wic2V0dGluZ3NcIl07XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0pXG4gICAgICAgIC5lcnJvcihmdW5jdGlvbihlcnJvciwgc3RhdHVzKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzdGF0dXMpXG4gICAgICAgICAgICAvLyBMZXQgaXQgYmUgaGFuZGxlZCBieSBjb250cm9sbGVyXG4gICAgICAgICAgICByZXR1cm4gZXJyb3I7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgdGhpcy5wdXQgPSBmdW5jdGlvbihkYXRhLCBpbmZvKSB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICB1cmwgOiBhZGRyLCBcbiAgICAgICAgICAgIG1ldGhvZCA6IFwiUFVUXCIsXG4gICAgICAgICAgICBkYXRhIDogYW5ndWxhci50b0pzb24oZGF0YSksXG4gICAgICAgICAgICBoZWFkZXJzIDoge1xuICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJyA6ICRsb2NhbFN0b3JhZ2VbXCJ0b2tlblwiXVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBpZiAoaW5mbykge1xuICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxuICAgICAgICAgICAgICAgICAgICAgICAgJG1kVG9hc3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2ltcGxlKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQoJ1VzZXIgc2V0dGluZ3MgdXBkYXRlZCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnBvc2l0aW9uKFwidG9wIHJpZ2h0XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmhpZGVEZWxheSgzMDAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVtZShcInN1Y2Nlc3MtdG9hc3RcIilcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7ICAgICAgICBcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24obXNnLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIFx0JGxvZy5lcnJvcignU29tZXRoaW5nIHdlbnQgd3Jvbmcgc2VuZGluZyB1c2VyIGRhdGEnKTtcbiAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxuICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaW1wbGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRleHRDb250ZW50KCdTb21ldGhpbmcgd2VudCB3cm9uZycpXG4gICAgICAgICAgICAgICAgICAgICAgICAucG9zaXRpb24oXCJ0b3AgcmlnaHRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoMzAwMClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVtZShcImVycm9yLXRvYXN0XCIpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtc2cpO1xuICAgICAgICAgICAgICAgIHJldHVybiBtc2c7XG4gICAgICAgICAgICB9KVxuICAgIH1cbiAgICBcbiAgICAvLyBMb2dvdXQgdXNlclxuICAgIC8vIFJlbW92ZSBKV1QgZnJvbSBsb2NhbFN0b3JhZ2UgYW5kIGRlbGV0ZSBzZXNzaW9uIG9uIHNlcnZlclxuICAgIHRoaXMubG9nb3V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB1c2VyID0gJGxvY2FsU3RvcmFnZVtcInRva2VuXCJdO1xuXG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICB1cmwgOiBhZGRyICsgXCJsb2dvdXRcIixcbiAgICAgICAgICAgIG1ldGhvZCA6IFwiREVMRVRFXCIsXG4gICAgICAgICAgICBoZWFkZXJzIDoge1xuICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJyA6ICRsb2NhbFN0b3JhZ2VbXCJ0b2tlblwiXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIik7XG4gICAgICAgICAgICAgICAgZGVsZXRlICRsb2NhbFN0b3JhZ2VbXCJ0b2tlblwiXTtcbiAgICAgICAgICAgICAgICBkZWxldGUgJGxvY2FsU3RvcmFnZVtcImRhc2hib2FyZFwiXTtcbiAgICAgICAgICAgICAgICBkZWxldGUgJGxvY2FsU3RvcmFnZVtcInRpbWVzdGFtcFwiXTtcbiAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxuICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdFxuICAgICAgICAgICAgICAgICAgICAgICAgLnNpbXBsZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQoJ0xvZ291dCBzdWNjZXNzZnVsbCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAucG9zaXRpb24oXCJ0b3AgcmlnaHRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoMzAwMClcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIHJldHVybjsgICAgICAgIFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihlcnJvciwgbXNnKSB7XG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIik7XG4gICAgICAgICAgICAgICAgZGVsZXRlICRsb2NhbFN0b3JhZ2VbXCJ0b2tlblwiXTtcbiAgICAgICAgICAgICAgICBkZWxldGUgJGxvY2FsU3RvcmFnZVtcImRhc2hib2FyZFwiXTtcbiAgICAgICAgICAgICAgICBkZWxldGUgJGxvY2FsU3RvcmFnZVtcInRpbWVzdGFtcFwiXTtcbiAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxuICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdFxuICAgICAgICAgICAgICAgICAgICAgICAgLnNpbXBsZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQoJ0xvZ291dCBmYWlsZWQgb24gc2VydmVyIHNpZGUsIGJ1dCB5b3UgYXJlIGxvZ2dlZCBvdXQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnBvc2l0aW9uKFwidG9wIHJpZ2h0XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuaGlkZURlbGF5KDMwMDApXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIHRoaXMuZ2V0ID0gZnVuY3Rpb24oYWxsdXNlcnMpIHtcbiAgICAgICAgdmFyIHVzZXIgPSAkbG9jYWxTdG9yYWdlW1widG9rZW5cIl07XG4gICAgICAgIFxuICAgICAgICBpZiAoYWxsdXNlcnMpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICAgICAgdXJsIDogYWRkcixcbiAgICAgICAgICAgICAgICBtZXRob2QgOiBcIkdFVFwiLFxuICAgICAgICAgICAgICAgIGhlYWRlcnMgOiB7XG4gICAgICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJyA6IHVzZXJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YV9yYXcpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhX3JhdylcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YV9yYXc7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGVycm9yLCBtc2cpIHtcbiAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxuICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdFxuICAgICAgICAgICAgICAgICAgICAgICAgLnNpbXBsZXQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRleHRDb250ZW50KFwiQ2Fubm90IGZldGNoIHVzZXJzIGZyb20gZGF0YWJhc2VcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wb3NpdGlvbihcInRvcCByaWdodFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmhpZGVEZWxheSgzMDAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW1lKFwiZXJyb3ItdG9hc3RcIilcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLmp3dCgpO1xuICAgIH1cblxuXG4gICAgdGhpcy5wb3N0ID0gZnVuY3Rpb24odXNlckRhdGEpIHtcbiAgICAgICAgdmFyIHVzZXIgPSAkbG9jYWxTdG9yYWdlW1widG9rZW5cIl07XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgdXJsIDogYWRkcixcbiAgICAgICAgICAgIG1ldGhvZCA6IFwiUE9TVFwiLFxuICAgICAgICAgICAgZGF0YSA6IGFuZ3VsYXIudG9Kc29uKHVzZXJEYXRhKSxcbiAgICAgICAgICAgIGhlYWRlcnMgOiB7XG4gICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nIDogdXNlclxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgfSlcbiAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGVycm9yLCBtc2cpIHtcbiAgICAgICAgICAgICRtZFRvYXN0LnNob3coXG4gICAgICAgICAgICAgICAgJG1kVG9hc3RcbiAgICAgICAgICAgICAgICAgICAgLnNpbXBsZXQoKVxuICAgICAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQoXCJDYW5ub3QgY3JlYXRlIHVzZXJcIilcbiAgICAgICAgICAgICAgICAgICAgLnBvc2l0aW9uKFwidG9wIHJpZ2h0XCIpXG4gICAgICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoMzAwMClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW1lKFwiZXJyb3ItdG9hc3RcIilcbiAgICAgICAgICAgIClcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgIHRoaXMuZGVsZXRlID0gZnVuY3Rpb24odXNlcklkKSB7XG4gICAgICAgIHZhciB1c2VyID0gJGxvY2FsU3RvcmFnZVtcInRva2VuXCJdO1xuICAgICAgICBjb25zb2xlLmxvZyh1c2VySWQpXG4gICAgICAgIFxuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgdXJsIDogYWRkcixcbiAgICAgICAgICAgIG1ldGhvZCA6IFwiREVMRVRFXCIsXG4gICAgICAgICAgICBwYXJhbXMgOiB7XCJ1c2VySWRcIiA6IHVzZXJJZH0sXG4gICAgICAgICAgICBoZWFkZXJzIDoge1xuICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJyA6IHVzZXJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH0pXG4gICAgICAgIC5lcnJvcihmdW5jdGlvbihlcnJvciwgbXNnKSB7XG4gICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxuICAgICAgICAgICAgICAgICRtZFRvYXN0XG4gICAgICAgICAgICAgICAgICAgIC5zaW1wbGV0KClcbiAgICAgICAgICAgICAgICAgICAgLnRleHRDb250ZW50KFwiQ2Fubm90IGRlbGV0ZSB1c2VyXCIpXG4gICAgICAgICAgICAgICAgICAgIC5wb3NpdGlvbihcInRvcCByaWdodFwiKVxuICAgICAgICAgICAgICAgICAgICAuaGlkZURlbGF5KDMwMDApXG4gICAgICAgICAgICAgICAgICAgIC50aGVtZShcImVycm9yLXRvYXN0XCIpXG4gICAgICAgICAgICApXG4gICAgICAgIH0pO1xuICAgIH1cblxuXG5cbn0pO1xuIiwiLy8gRmlsdGVyIHRvIGNvbnZlcnQgSURFQSBmb3JtYXQgZnJvbSBNb25nb0RCIHRvIHN0YW5kYXJkaXplZCBJREVBIGZvcm1hdFxuYXBwLmZpbHRlcignaWRlYScsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBmdW5jdGlvbihpbnB1dCkge1xuICAgICAgICB2YXIgcmVzID0ge307XG5cbiAgICAgICAgYW5ndWxhci5mb3JFYWNoKGlucHV0LCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgICAgICAgICBpZiAoa2V5ICE9ICdfaWQnKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlWyckZGF0ZSddKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHZhbHVlWyckZGF0ZSddKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzW2tleV0gPSBuZXcgRGF0ZSh2YWx1ZVsnJGRhdGUnXSkudG9JU09TdHJpbmcoKS5zbGljZSgwLDE5KSArICdaJztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXNba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICB9XG59KTtcbiIsImFwcC5maWx0ZXIoJ2pzb24yaHRtbCcsIGZ1bmN0aW9uKCRzY2UsICRmaWx0ZXIpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oaW5wdXQpIHtcbiAgICAgICAgdmFyIGh0bWwgPSBcIlwiO1xuXG4gICAgICAgIGFuZ3VsYXIuZm9yRWFjaChpbnB1dCwgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAgICAgICAgaWYgKGtleSAhPSBcIl9pZFwiKSB7XG4gICAgICAgICAgICBodG1sID0gaHRtbCArIFwiPGRpdj5cIjtcblxuICAgICAgICAgICAgLy8gVGhlIHR1cGxlIGlzIG5lc3RlZFxuICAgICAgICAgICAgaWYgKCh0eXBlb2YgdmFsdWUpID09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgaWYgKCh0eXBlb2Yga2V5KSAhPSAnbnVtYmVyJyAmJiBrZXkgIT0gXCIkZGF0ZVwiKVxuICAgICAgICAgICAgICAgICAgICBodG1sID0gaHRtbCArIFwiPGVtPlwiICsga2V5ICsgXCI8L2VtPjogXCI7XG4gICAgICAgICAgICAgICAgaHRtbCA9IGh0bWwgKyBcIjxkaXYgY2xhc3M9XFxcInN1YlxcXCI+XCIgKyAkZmlsdGVyKCdqc29uMmh0bWwnKSh2YWx1ZSkgKyBcIjwvZGl2PlwiO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoKHR5cGVvZiBrZXkgIT0gJ251bWJlcicpICYmIGtleSAhPSBcIiRkYXRlXCIpXG4gICAgICAgICAgICAgICAgICAgIGh0bWwgPSBodG1sICsgXCI8ZW0+XCIgKyBrZXkgKyBcIjwvZW0+OiBcIjtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBpdCBpcyBkYXRlIChJIGtub3csIGl0IGlzIHNvb29vbyBkaXJ0eSlcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgPiAxMDAwMDAwMDAwMDAwKVxuICAgICAgICAgICAgICAgICAgICBodG1sID0gaHRtbCArIFwiPHNwYW4+XCIgKyAkZmlsdGVyKCdkYXRlJykodmFsdWUsJ3l5eXkvTU0vZGQgSDptbTpzcycpICsgXCI8L3NwYW4+XCI7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBodG1sID0gaHRtbCArIFwiPHNwYW4+XCIgKyB2YWx1ZSArIFwiPC9zcGFuPlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaHRtbCA9IGh0bWwgKyBcIjwvZGl2PlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gJHNjZS50cnVzdEFzKCdodG1sJywgaHRtbCk7XG4gICAgfSAgICAgXG59KTtcblxuIl19
