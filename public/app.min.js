function config(t,e,o,n){t.when("/login",{controller:"loginController",templateUrl:"views/login.html"}).when("/",{controller:"homeController",templateUrl:"views/home.html"}).when("/user",{controller:"userController",templateUrl:"views/login.html"}).when("/events",{controller:"eventsController",templateUrl:"views/events.html",reloadOnSearch:!1}).when("/events/:id",{controller:"eventController",templateUrl:"views/event.html"}).when("/profile",{controller:"profileController",templateUrl:"views/profile.html"}).otherwise({redirectTo:"/login"}),e.theme("default").primaryPalette("light-blue").accentPalette("orange"),o.interceptors.push("notAllowedInterceptor"),n.setKeyPrefix("nd-")}function topBarCtrl(t,e,o){this.toggleLeft=function(){o("left").toggle()}}function topBarCtrl(t,e,o){this.user="Petr",this.toggleLeft=function(){o("left").toggle()},this.logout=function(){var o=t.confirm().title("Are you sure?").content("You are about to be logged out. All unsaved changes will be lost in the void!").ok("Log me out").cancel("Keep me here");t.show(o).then(function(){e.path("/login")})}}config.$inject=["$routeProvider","$mdThemingProvider","$httpProvider","$localStorageProvider"],topBarCtrl.$inject=["$mdDialog","$location","$mdSidenav"];var app=angular.module("gui",["ngMaterial","ngRoute","ngMessages","nvd3","ngStorage","ngMap","gridster"]);app.config(config),app.filter("nospace",function(){return function(t){return t?t.replace(/ /g,""):""}}),app.run(["user","$localStorage","$location","$rootScope","$log",function(t,e,o,n,i){n.$on("$locationChangeStart",function(t){void 0==e.token&&(i.info("no token found, redirecting to /login"),o.path("/login"))})}]),app.factory("notAllowedInterceptor",["$log","$localStorage","$location","$injector","$q",function(t,e,o,n,i){var r={responseError:function(n){return 401==n.status&&(t.error("You are not allowed to access, redirecting to /login"),delete e.token,o.path("/login")),i.reject(n)}};return r}]),app.constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}),app.constant("CATEGORIES",["any","Recon.Scanning","Attempt.Login","Availability.DoS"]),app.constant("PROTOCOLS",["tcp","dns","udp"]),app.constant("TYPES",["barchart","piechart","top","sum"]),app.constant("PIECHART",{options:{chart:{type:"pieChart",height:450,x:function(t){return t.key[0]},y:function(t){return t.x},showLabels:!0,donut:!0,padAngle:0,cornerRadius:1,transitionDuration:500,labelThreshold:0,legend:{margin:{top:5,right:0,bottom:0,left:0}},tooltipContent:function(t,e,o,n,i){return console.log(t),console.log(o),console.log(n),console.log(i),"Olalala!"},pie:{dispatch:{elementClick:function(t){var e=new Date;console.log(t),e.setTime(e.getTime()-864e5),e.setHours(0),e.setMinutes(0),window.location="#/events?filter&date="+e.toISOString()+"&from="+(new Date).getHours()+":"+(new Date).getMinutes()+"&category="+t.data.key[0]}},labelType:"percent",labelsOutside:!0}}}}),app.constant("AREA",{options:{chart:{type:"multiBarChart",height:450,margin:{top:30,right:20,bottom:100,left:50},x:function(t){return t.x},y:function(t){return t.Count},useVoronoi:!1,clipEdge:!0,duration:100,useInteractiveGuideline:!0,xAxis:{showMaxMin:!1,tickFormat:function(t){return d3.time.format("%m/%d %H:%M")(new Date(t))},rotateLabels:-45},yAxis:{tickFormat:function(t){return d3.format(",.0f")(t)}},zoom:{enabled:!0,useFixedDomain:!1,useNiceScale:!1,horizontalOff:!1,verticalOff:!0,unzoomEventType:"dblclick.zoom"},dispatch:{stateChange:function(t){console.log("stateChange")},changeState:function(t){console.log("changeState")},tooltipShow:function(t){console.log("tooltipShow")},tooltipHide:function(t){console.log("tooltipHide")}},multibar:{dispatch:{elementClick:function(t){var e=new Date(t.data.x);console.log(e);var o=e.getHours(),n=e.getMinutes();e.setHours(0),e.setMinutes(0),window.location="#/events?filter&date="+e.toISOString()+"&from="+("0"+o).slice(-2)+":"+("0"+n).slice(-2)+"&category="+t.data.key}}}}}}),app.constant("MENU",[{title:"Dashboard",link:"#/"},{title:"Events",link:"#/events"},{title:"Settings",items:[{title:"My profile",link:"#/profile"},{title:"Users",link:"/settings"}]}]),app.service("api",["$http","$log","$mdToast","$localStorage","PIECHART","CONFIG",function(t,e,o,n,i,r){var a=r.host+":"+r.port+"/"+r.version+"/events/";this.auth=function(){return n.token},this.config=function(){t.get("http://benefizio.liberouter.org:5555/config").success(function(t){this.addr=t.host+":"+t.port+t.events,n.config=t,alert(t)})},this.get=function(n,i,r){return t({url:a+n,method:"GET",params:i,headers:{Authorization:this.auth()}}).success(function(t){return void 0!=r&&o.show(o.simple().textContent("Data successully loaded").position("top right").hideDelay(3e3).theme("success-toast")),t}).error(function(){e.error("Cannot fetch data"),o.show(o.simple().textContent("Something went wrong").position("top right").hideDelay(3e3).theme("error-toast"))})},this.post=function(n,i,r){return t.post(a+n,JSON.stringify(i)).success(function(t){return r&&o.show(o.simple().textContent("Data successfully loaded").position("top right").hideDelay(3e3).theme("success-toast")),t}).error(function(){e.error("Cannot fetch data"),o.show(o.simple().textContent("Something went wrong").position("top right").hideDelay(3e3).theme("error-toast"))})},this.put=function(n,i,r){return t.put(a+n,JSON.stringify(i)).success(function(t){return r&&o.show(o.simple().textContent("Data successfully loaded").position("top right").hideDelay(3e3).theme("success-toast")),t}).error(function(){e.error("Cannot fetch data"),o.show(o.simple().textContent("Something went wrong").position("top right").hideDelay(3e3).theme("error-toast"))})}}]),app.factory("menu",["$http",function(t){return t.get("json/menu.json").success(function(t){return t})}]),app.factory("jsondata",["$http",function(t){return t.get("json/testfile_100.json").success(function(t){return t})}]),app.directive("sidebarMenu",function(){return{scope:{section:"="},templateUrl:"partials/sidebar-menu.html",controller:["$scope","$mdSidenav","$location","MENU","user",function(t,e,o,n,i){t.menu=n,t.isActive=function(t){return o.path()==t},t.changeMode=function(){t.$emit("reqChangeMode")},t.enable=!0,t.toggleItem=function(){t.toggleBtn="toggled"},t.closeLeft=function(){e("left").toggle()},t.logout=function(){i.logout()}}]}}),app.directive("topbarMenu",function(){return{scope:{section:"="},templateUrl:"partials/topbar-menu.html",controller:["$scope","$mdSidenav",function(t,e){t.toggleLeft=function(){e("left").toggle()}}]}}),app.controller("topBar",topBarCtrl),app.directive("boxes",function(){return{scope:{section:"="},templateUrl:"partials/boxes.html"}}),app.directive("clickEdit",function(){var t='<div><h2 ng-show="view.showTitle" ng-click="editTitle()">{{box.title}}</h2><md-input-container ng-hide="showTitle"><input type="text" value="{{box.title}}" ng-blur="editTitle(box.title)" ng-model="box.title" class="focusTitle" aria-label="Edit Title"></md-input-container></div>';return{restrict:"A",replace:!0,template:t,scope:{value:"=clickEdit"},controller:["$scope","inputText","$timeout",function(t,e,o){t.view.showTitle=!0,(t.showTitle=!0)&&o(function(){angular.element(".focusTitle").trigger("focus"),console.log("trigger")},100),t.editTitle=function(){t.view.showTitle=!t.view.showTitle}}]}}),app.directive("clickToEdit",function(){var t='<div class="click-to-edit"><div ng-hide="view.editorEnabled" ng-click="enableEditor()"><a ng-click="enableEditor()"><md-icon md-svg-src="img/icons/edit.svg"></md-icon></a>{{value}} </div><md-input-container ng-show="view.editorEnabled"><div><input ng-model="view.editableValue" class="focusTitle" aria-label="Title"><span ng-click="save()">Save</span> or <a ng-click="disableEditor()">cancel</a>.</div></md-input-container></div>';return{restrict:"A",replace:!0,template:t,scope:{value:"=clickToEdit"},controller:["$scope","$timeout",function(t,e){t.view={editableValue:t.value,editorEnabled:!1},t.enableEditor=function(){t.view.editorEnabled=!0,t.view.editableValue=t.value,e(function(){angular.element(".focusTitle").trigger("focus"),console.log("trigger")},100)},t.disableEditor=function(){t.view.editorEnabled=!1},t.save=function(){t.value=t.view.editableValue,t.disableEditor()}}]}}),app.service("user",["$localStorage","$http","$mdToast","$location","CONFIG",function(t,e,o,n,i){var r=i.host+":"+i.port+"/"+i.version+"/users/";this.config=function(){return t.dashboard},this.jwt=function(){return t.jwt},this.auth=function(o){return e.post(r+"auth",angular.toJson(o)).success(function(e){t.token=e.jwt,delete t.dashboard,t.dashboard=e.settings}).error(function(t,e){return console.log(t),console.log(e),t})},this.put=function(n,i){return e({url:r,method:"PUT",data:angular.toJson(n),headers:{Authorization:t.token}}).success(function(t){return i&&o.show(o.simple().textContent("User settings updated").position("top right").hideDelay(3e3).theme("success-toast")),t}).error(function(t,e){$log.error("Something went wrong sending user data"),o.show(o.simple().textContent("Something went wrong").position("top right").hideDelay(3e3).theme("error-toast"))})},this.logout=function(){t.token;return e({url:r+"logout",method:"DELETE",headers:{Authorization:t.token}}).success(function(e){n.path("/login"),delete t.token,delete t.dashboard,o.show(o.simple().textContent("Logout successfull").position("top right").hideDelay(3e3))}).error(function(e,i){n.path("/login"),delete t.token,delete t.dashboard,o.show(o.simple().textContent("Logout failed on server side, but you are logged out").position("top right").hideDelay(3e3))})}}]),app.controller("eventController",["$scope","$routeParams","$http","api",function(t,e,o,n){t.id=e,t.geo=[],t.back=function(){window.history.back()},n.get("id/"+e.id).success(function(e){t.data=e,void 0!=t.data.Source&&void 0!=t.data.Target&&t.data.Source[0].IP4&&t.data.Target[0].IP4?(o.get("http://freegeoip.net/json/"+t.data.Target[0].IP4[0]).success(function(e){e.type="Target",t.geo.push(e)}),o.get("http://freegeoip.net/json/"+t.data.Source[0].IP4[0]).success(function(e){e.type="Source",t.geo.push(e)})):void 0==t.data.Source||void 0==t.data.Source[0].IP4?o.get("http://freegeoip.net/json/"+t.data.Target[0].IP4[0]).success(function(e){e.type="Target",t.geo.push(e)}):o.get("http://freegeoip.net/json/"+t.data.Source[0].IP4[0]).success(function(e){e.type="Source",t.geo.push(e)})})}]),app.filter("json2html",["$sce","$filter",function(t,e){return function(o){var n="";return angular.forEach(o,function(t,o){n+="<div>","object"==typeof t?("number"!=typeof o&&"$date"!=o&&(n=n+"<em>"+o+"</em>: "),n=n+'<div class="sub">'+e("json2html")(t)+"</div>"):("number"!=typeof o&&"$date"!=o&&(n=n+"<em>"+o+"</em>: "),n=t>1e12?n+"<span>"+e("date")(t,"yyyy/MM/dd H:mm:ss")+"</span>":n+"<span>"+t+"</span>"),n+="</div>"}),t.trustAs("html",n)}}]),app.filter("idea",function(){return function(t){var e={};return angular.forEach(t,function(t,o){"_id"!=o&&(t.$date?e[o]=new Date(t.$date).toISOString().slice(0,19)+"Z":e[o]=t)}),e}}),app.controller("eventsController",["$scope","$http","$location","api",function(t,e,o,n){t.filter={category:"",src_ip:"",trt_ip:"",desc:"",flows_from:"",flows_to:"",items:100},t.query={from:"",to:"",date:new Date,description:"",category:"",limit:100},t.data=[],t.loadbtn="Load",console.log(t.query.date),t.loadItems=function(e){t.loadbtn="Loading...";var i=e.from.split(":"),r=new Date(e.date);if(r.setHours(r.getHours()+i[0]),r.setMinutes(i[1]),o.search("filter",!0),o.search("from",e.from),o.search("date",e.date),o.search("limit",e.limit),e.to){var a=e.to.split(":"),s=new Date(e.date);s.setHours(s.getHours()+a[0]),s.setMinutes(a[1]),o.search("to",e.to)}else var s=null;""!=e.description?o.search("description",e.description):e.description=null,""!=e.category?o.search("category",e.category):e.category=null;var c={from:r,to:s,category:e.category,description:e.description,limit:e.limit};n.get("query",c,!0).success(function(e){t.data=e,t.loadbtn="Load"}).error(function(){t.loadbtn="Load"})},o.search().filter?(t.query=o.search(),console.log(t.query.date),t.query.date=new Date(t.query.date),t.loadItems(t.query)):n.get("100").success(function(e){t.data=e}),t.events=function(e){var o=[];""!=t.filter.src_ip&&("Source"in e&&"IP4"in e.Source[0]&&e.Source[0].IP4[0].toLowerCase().indexOf(t.filter.src_ip.toLowerCase())>-1?o.push(1):o.push(0)),""!=t.filter.trt_ip&&("Target"in e&&"IP4"in e.Target[0]&&e.Target[0].IP4[0].toLowerCase().indexOf(t.filter.trt_ip.toLowerCase())>-1?o.push(1):o.push(0)),""!=t.filter.category&&(e.Category[0].toLowerCase().indexOf(t.filter.category.toLowerCase())>-1?o.push(1):o.push(0)),""!=t.filter.desc&&(e.Description.toLowerCase().indexOf(t.filter.desc.toLowerCase())>-1?o.push(1):o.push(0)),""!=t.filter.flows_from&&(e.FlowCount>Number(t.filter.flows_from)?o.push(1):o.push(0)),""!=t.filter.flows_to&&(e.FlowCount<Number(t.filter.flows_to)?o.push(1):o.push(0));for(var n=1,i=0;i<o.length;i++)n*=o[i];return 1==n?!0:!1}}]),app.directive("validateHours",function(){var t=[],e=[];return{require:"ngModel",link:function(o,n,i,r){r.$validators.time=function(o,n){return"query.from"==i.ngModel&&n?e=n.split(":"):n&&(t=n.split(":")),console.log(e),console.log(t),2!=t.length&&2!=e.length||!(t[0]<e[0]||t[0]<=e[0]&&t[1]<e[1]||t[0]<0||t[0]>23||t[1]<0||t[1]>59||e[0]<0||e[0]>23||e[1]<0||e[1]>59)?!0:!1}}}}),app.value("boxes_arr",[{row:0,height:"",items:[{title:"Events shares",type:"piechart",content:"",config:{metric:"category",type:"piechart",period:"24",begintime:""}},{title:"Last 24 hours",type:"barchart",data:"",timestamp:"",config:{metric:"category",type:"barchart",period:24,window:60,begintime:""}}]},{row:1,items:[{title:"Top events in 1 hour",type:"top",config:{period:1,begintime:""}},{title:"2",type:"incident"}]}]),app.controller("homeController",["$scope","$log","api","boxes_arr","$http","$localStorage","user",function(t,e,o,n,i,r,a){t.activeGrid=!1,t.openMenu=function(t,e){originatorEv=e,t(e)},t.addItem=function(){t.$broadcast("addItem")},t.enableGrid=function(){console.log("Enable grid"),t.$broadcast("enableGrid"),t.activeGrid=!t.activeGrid}}]),app.controller("topBar",topBarCtrl),app.controller("row",["$scope","$timeout",function(t,e){t.$on("requestRedraw",function(t){t.stopPropagation(),e(function(){console.log("request accepted"),window.dispatchEvent(new Event("resize"))},10)})}]),app.controller("box",["$scope","$log","boxes_arr","$timeout","$element","$mdDialog","PROTOCOLS","TYPES","CATEGORIES","$http","PIECHART","AREA","api","$location","user",function(t,e,o,n,i,r,a,s,c,l,u,p,d,g,f){function h(){void 0==t.box||"piechart"!=t.box.type&&"barchart"!=t.box.type&&"top"!=t.box.type&&"sum"!=t.box.type||(t.box.config.begintime=function(){var e=new Date;return e.setHours(e.getHours()-t.box.config.period),e}())}h(),t.box.loading=!0,t.openMenu=function(t,e){originatorEv=e,t(e)},t.editMode=!1,t.backupModel={},t.protocol=a,t.types=s,t.categories=c,t.edit=function(e){t.editMode=!0,t.backupModel=angular.copy(e),t.$emit("switch-drag")},t.save=function(){t.user(),"piechart"==t.box.type&&(t.box.options=u.options),"barchart"==t.box.type&&(t.box.options=p.options),t.backupModel={},t.box.config.type=t.box.type,t.editMode=!1,t.box.loading=!0,h(),t.$emit("switch-drag"),"piechart"==t.box.type||"barchart"==t.box.type?d.get("agg",t.box.config,!0).success(function(e){t.box.loading=!1,t.box.data=e}):"top"==t.box.type?d.get("top",t.box.config,!0).success(function(e){t.box.loading=!1,t.box.data=e}):"sum"==t.box.type&&d.get("count",t.box.config).success(function(e){t.box.loading=!1,t.box.data=e})},t.cancel=function(e){t.box=angular.copy(t.backupModel),t.backupModel={},t.editMode=!1,t.$emit("switch-drag")},t.top=function(){h(),d.get("top",t.box.config,!0).success(function(e){console.log(e),t.box.data=e})},void 0!=t.box&&("piechart"==t.box.type||"barchart"==t.box.type?("piechart"==t.box.type&&(t.box.options=u.options),"barchart"==t.box.type&&(t.box.options=p.options),t.box.config.type=t.box.type,d.get("agg",t.box.config).success(function(e){if(t.box.loading=!1,t.box.data=e,"piechart"==t.box.type)for(var o=0;o<t.box.data.length;o++)t.total=t.total+Number(t.box.data[o].x)})):"top"==t.box.type?d.get("top",t.box.config).success(function(e){t.box.loading=!1,t.box.data=e}):"sum"==t.box.type&&d.get("count",t.box.config).success(function(e){t.box.loading=!1,t.box.data=e})),t.user=function(){var o=angular.copy(t.items);console.log(o);for(var n=0;n<o.length;n++)delete o[n].data,delete o[n].options;var i={jwt:f.jwt(),settings:o};e.info(i),f.put(i).success(function(t){console.log("Data"),console.log(t)}).error(function(t){e.error(t)})},t.$on("saveUser",function(){t.user()}),t.$on("gridster-item-resized",function(t){n(function(){console.log("request accepted"),window.dispatchEvent(new Event("resize"))},100)})}]),app.controller("grid",["$scope","$timeout","$log","user",function(t,e,o,n){t.opt={outerMargin:!1,columns:6,pushing:!0,rowHeight:260,colWidth:"auto",floating:!0,swapping:!0,mobileBreakPoint:933,draggable:{enabled:!1},resizable:{enabled:!1,handles:["n","e","s","w","se","sw"],stop:function(o,n,i){console.log("resize end"),t.$emit("requestRedraw"),e(function(){console.log("request accepted"),window.dispatchEvent(new Event("resize"))},100)}}},console.log(n.config()),t.$on("enableGrid",function(){1==t.opt.resizable.enabled&&t.$broadcast("saveUser"),t.opt.resizable.enabled=!t.opt.resizable.enabled,t.opt.draggable.enabled=!t.opt.draggable.enabled}),t.remove=function(e){t.items.splice(t.items.indexOf(e),1)},t.items=n.config(),t.$on("addItem",function(){var e={title:"New box",loading:!1,sizeX:1,sizeY:1};t.items.push(e)})}]),app.directive("gridsterDynamicHeight",["$timeout",function(t){function e(t,e,o){t.$watch(function(){return e[0].scrollHeight},function(e,o){var n=270,i=n*t.item.sizeY;if(e>i){var r=Math.floor(e/n);t.item.sizeY=r}})}var o={scope:{item:"="},link:e,restrict:"A"};return o}]),app.controller("loginController",["$scope","$location","$log","user",function(t,e,o,n){t.title="Login to Nemea Dashboard",t.loginBtn="Login",t.submit=function(o){t.loginBtn="Authenticating...",t.loginBtnDisabled=!0,n.auth(o).success(function(t){e.path("/")}).error(function(e){t.error_mes=e,t.loginBtn="Login",t.loginBtnDisabled=!1})}}]),app.controller("profileController",["$scope","user","api",function(t,e,o){t.user=e.config(),t.editUser=function(t){console.log(t)}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsInNlcnZpY2VzL21lbnUuanMiLCJjb250cm9sbGVycy9ob21lQ29udHJvbGxlci5qcyIsImpzL2FwcC5taW4uanMiLCJjb25zdGFudHMuanMiLCJzZXJ2aWNlcy9hcGkuanMiLCJzZXJ2aWNlcy91c2VyLmpzIiwiY29udHJvbGxlcnMvZXZlbnRDb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvZXZlbnRzQ29udHJvbGxlci5qcyIsImNvbnRyb2xsZXJzL2xvZ2luQ29udHJvbGxlci5qcyIsImNvbnRyb2xsZXJzL3Byb2ZpbGVDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwiJG1kVGhlbWluZ1Byb3ZpZGVyIiwiJGh0dHBQcm92aWRlciIsIiRsb2NhbFN0b3JhZ2VQcm92aWRlciIsIndoZW4iLCJjb250cm9sbGVyIiwidGVtcGxhdGVVcmwiLCJyZWxvYWRPblNlYXJjaCIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCJ0aGVtZSIsInByaW1hcnlQYWxldHRlIiwiYWNjZW50UGFsZXR0ZSIsImludGVyY2VwdG9ycyIsInB1c2giLCJzZXRLZXlQcmVmaXgiLCJ0b3BCYXJDdHJsIiwiJG1kRGlhbG9nIiwiJGxvY2F0aW9uIiwiJG1kU2lkZW5hdiIsInRoaXMiLCJ0b2dnbGVMZWZ0IiwidG9nZ2xlIiwidXNlciIsImxvZ291dCIsImNvbmZpcm0iLCJ0aXRsZSIsImNvbnRlbnQiLCJvayIsImNhbmNlbCIsInNob3ciLCJ0aGVuIiwicGF0aCIsIiRpbmplY3QiLCJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiZmlsdGVyIiwidmFsdWUiLCJyZXBsYWNlIiwicnVuIiwiJGxvY2FsU3RvcmFnZSIsIiRyb290U2NvcGUiLCIkbG9nIiwiJG9uIiwiZXZlbnQiLCJ1bmRlZmluZWQiLCJpbmZvIiwiZmFjdG9yeSIsIiRpbmplY3RvciIsIiRxIiwibm90QWxsb3dlZEludGVyY2VwdG9yIiwicmVzcG9uc2VFcnJvciIsInJlc3BvbnNlIiwic3RhdHVzIiwiZXJyb3IiLCJyZWplY3QiLCJjb25zdGFudCIsImxvZ2luU3VjY2VzcyIsImxvZ2luRmFpbGVkIiwibG9nb3V0U3VjY2VzcyIsInNlc3Npb25UaW1lb3V0Iiwibm90QXV0aGVudGljYXRlZCIsIm5vdEF1dGhvcml6ZWQiLCJvcHRpb25zIiwiY2hhcnQiLCJ0eXBlIiwiaGVpZ2h0IiwieCIsImQiLCJrZXkiLCJ5Iiwic2hvd0xhYmVscyIsImRvbnV0IiwicGFkQW5nbGUiLCJjb3JuZXJSYWRpdXMiLCJ0cmFuc2l0aW9uRHVyYXRpb24iLCJsYWJlbFRocmVzaG9sZCIsImxlZ2VuZCIsIm1hcmdpbiIsInRvcCIsInJpZ2h0IiwiYm90dG9tIiwibGVmdCIsInRvb2x0aXBDb250ZW50IiwiZSIsImdyYXBoIiwiY29uc29sZSIsImxvZyIsInBpZSIsImRpc3BhdGNoIiwiZWxlbWVudENsaWNrIiwiZGF0ZSIsIkRhdGUiLCJzZXRUaW1lIiwiZ2V0VGltZSIsInNldEhvdXJzIiwic2V0TWludXRlcyIsIndpbmRvdyIsImxvY2F0aW9uIiwidG9JU09TdHJpbmciLCJnZXRIb3VycyIsImdldE1pbnV0ZXMiLCJkYXRhIiwibGFiZWxUeXBlIiwibGFiZWxzT3V0c2lkZSIsIkNvdW50IiwidXNlVm9yb25vaSIsImNsaXBFZGdlIiwiZHVyYXRpb24iLCJ1c2VJbnRlcmFjdGl2ZUd1aWRlbGluZSIsInhBeGlzIiwic2hvd01heE1pbiIsInRpY2tGb3JtYXQiLCJkMyIsInRpbWUiLCJmb3JtYXQiLCJyb3RhdGVMYWJlbHMiLCJ5QXhpcyIsInpvb20iLCJlbmFibGVkIiwidXNlRml4ZWREb21haW4iLCJ1c2VOaWNlU2NhbGUiLCJob3Jpem9udGFsT2ZmIiwidmVydGljYWxPZmYiLCJ1bnpvb21FdmVudFR5cGUiLCJzdGF0ZUNoYW5nZSIsImNoYW5nZVN0YXRlIiwidG9vbHRpcFNob3ciLCJ0b29sdGlwSGlkZSIsIm11bHRpYmFyIiwiaG91cnMiLCJtaW51dGVzIiwic2xpY2UiLCJsaW5rIiwiaXRlbXMiLCJzZXJ2aWNlIiwiJGh0dHAiLCIkbWRUb2FzdCIsIlBJRUNIQVJUIiwiQ09ORklHIiwiYWRkciIsImF1dGgiLCJnZXQiLCJzdWNjZXNzIiwiaG9zdCIsInBvcnQiLCJldmVudHMiLCJhbGVydCIsInVybCIsInBhcmFtcyIsIm1ldGhvZCIsImhlYWRlcnMiLCJBdXRob3JpemF0aW9uIiwic2ltcGxlIiwidGV4dENvbnRlbnQiLCJwb3NpdGlvbiIsImhpZGVEZWxheSIsInBvc3QiLCJKU09OIiwic3RyaW5naWZ5IiwicHV0IiwiZGlyZWN0aXZlIiwic2NvcGUiLCJzZWN0aW9uIiwiJHNjb3BlIiwiTUVOVSIsIm1lbnUiLCJpc0FjdGl2ZSIsImN1cnJlbnQiLCJjaGFuZ2VNb2RlIiwiJGVtaXQiLCJlbmFibGUiLCJ0b2dnbGVJdGVtIiwidG9nZ2xlQnRuIiwiY2xvc2VMZWZ0IiwidGVtcGxhdGUiLCJyZXN0cmljdCIsImlucHV0VGV4dCIsIiR0aW1lb3V0IiwidmlldyIsInNob3dUaXRsZSIsImVsZW1lbnQiLCJ0cmlnZ2VyIiwiZWRpdFRpdGxlIiwiZWRpdG9yVGVtcGxhdGUiLCJlZGl0YWJsZVZhbHVlIiwiZWRpdG9yRW5hYmxlZCIsImVuYWJsZUVkaXRvciIsImRpc2FibGVFZGl0b3IiLCJzYXZlIiwiand0IiwidG9Kc29uIiwibXNnIiwiJHJvdXRlUGFyYW1zIiwiYXBpIiwiaWQiLCJnZW8iLCJiYWNrIiwiaGlzdG9yeSIsIlNvdXJjZSIsIlRhcmdldCIsIklQNCIsIiRzY2UiLCIkZmlsdGVyIiwiaW5wdXQiLCJodG1sIiwiZm9yRWFjaCIsInRydXN0QXMiLCJyZXMiLCJjYXRlZ29yeSIsInNyY19pcCIsInRydF9pcCIsImRlc2MiLCJmbG93c19mcm9tIiwiZmxvd3NfdG8iLCJxdWVyeSIsImZyb20iLCJ0byIsImRlc2NyaXB0aW9uIiwibGltaXQiLCJsb2FkYnRuIiwibG9hZEl0ZW1zIiwic3BsaXQiLCJmcm9tX2RhdGUiLCJzZWFyY2giLCJ0b19kYXRlIiwic2VuZCIsIml0ZW0iLCJ0b0xvd2VyQ2FzZSIsImluZGV4T2YiLCJDYXRlZ29yeSIsIkRlc2NyaXB0aW9uIiwiRmxvd0NvdW50IiwiTnVtYmVyIiwibG9naWN2YWx1ZSIsImkiLCJsZW5ndGgiLCJyZXF1aXJlIiwiYXR0cnMiLCJjdHJsIiwiJHZhbGlkYXRvcnMiLCJtb2RlbFZhbHVlIiwidmlld1ZhbHVlIiwibmdNb2RlbCIsInJvdyIsIm1ldHJpYyIsInBlcmlvZCIsImJlZ2ludGltZSIsInRpbWVzdGFtcCIsImJveGVzX2FyciIsImFjdGl2ZUdyaWQiLCJvcGVuTWVudSIsIiRtZE9wZW5NZW51IiwiZXYiLCJvcmlnaW5hdG9yRXYiLCJhZGRJdGVtIiwiJGJyb2FkY2FzdCIsImVuYWJsZUdyaWQiLCJzdG9wUHJvcGFnYXRpb24iLCJkaXNwYXRjaEV2ZW50IiwiRXZlbnQiLCIkZWxlbWVudCIsIlBST1RPQ09MUyIsIlRZUEVTIiwiQ0FURUdPUklFUyIsIkFSRUEiLCJ0aW1lU2hpZnQiLCJib3giLCJub3ciLCJsb2FkaW5nIiwiZWRpdE1vZGUiLCJiYWNrdXBNb2RlbCIsInByb3RvY29sIiwidHlwZXMiLCJjYXRlZ29yaWVzIiwiZWRpdCIsImNvcHkiLCJ0b3RhbCIsInNldHRpbmdzIiwiZ3JpZHN0ZXIiLCJvcHQiLCJvdXRlck1hcmdpbiIsImNvbHVtbnMiLCJwdXNoaW5nIiwicm93SGVpZ2h0IiwiY29sV2lkdGgiLCJmbG9hdGluZyIsInN3YXBwaW5nIiwibW9iaWxlQnJlYWtQb2ludCIsImRyYWdnYWJsZSIsInJlc2l6YWJsZSIsImhhbmRsZXMiLCJzdG9wIiwid2lkZ2V0IiwicmVtb3ZlIiwic3BsaWNlIiwic2l6ZVgiLCJzaXplWSIsIiR3YXRjaCIsInNjcm9sbEhlaWdodCIsIm5ld1ZhbCIsIm9sZFZhbCIsInJvd0hlaWdodE9wdGlvbiIsImRpdiIsIk1hdGgiLCJmbG9vciIsImxvZ2luQnRuIiwic3VibWl0IiwiY3JlZCIsImxvZ2luQnRuRGlzYWJsZWQiLCJlcnJvcl9tZXMiLCJlZGl0VXNlciJdLCJtYXBwaW5n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QUExTyxFQUFBLENBQ0EsR0FBQTZPLEdBQUFDLEtBQUFDLE1BQUFMLEVBQUFFLEVBRUE1SSxHQUFBaUUsS0FBQXNFLE1BQUFNLEtBckJBLEdBQUE5SSxJQUNBQyxPQUNBaUUsS0FBQSxLQUVBOUYsS0FBQUEsRUFDQTJDLFNBQUEsSUFFQSxPQUFBZixNTzNZQWhJLElBQUE3QixXQUFBLG1CQUFBLFNBQUEsWUFBQSxPQUFBLE9BQUEsU0FBQWdLLEVBQUFuSixFQUFBeUIsRUFBQXBCLEdBQ0E4SSxFQUFBM0ksTUFBQSwyQkFDQTJJLEVBQUE4SSxTQUFBLFFBRUE5SSxFQUFBK0ksT0FBQSxTQUFBQyxHQUNBaEosRUFBQThJLFNBQUEsb0JBQ0E5SSxFQUFBaUosa0JBQUEsRUFFQS9SLEVBQUF1SCxLQUFBdUssR0FDQXJLLFFBQUEsU0FBQXpDLEdBQ0FyRixFQUFBYyxLQUFBLE9BRUF1QixNQUFBLFNBQUEwSSxHQUNBNUIsRUFBQWtKLFVBQUF0SCxFQUNBNUIsRUFBQThJLFNBQUEsUUFDQTlJLEVBQUFpSixrQkFBQSxRQ2ZBcFIsSUFBQTdCLFdBQUEscUJBQUEsU0FBQSxPQUFBLE1BQUEsU0FBQWdLLEVBQUE5SSxFQUFBNEssR0FDQTlCLEVBQUE5SSxLQUFBQSxFQUFBeEIsU0FFQXNLLEVBQUFtSixTQUFBLFNBQUFqUyxHQUNBZ0UsUUFBQUMsSUFBQWpFIiwiZmlsZSI6ImpzL2FwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2d1aScsIFsnbmdNYXRlcmlhbCcsICduZ1JvdXRlJywgJ25nTWVzc2FnZXMnLCAnbnZkMycsICduZ1N0b3JhZ2UnLCAnbmdNYXAnLCAnZ3JpZHN0ZXInXSk7XG5cbmFwcC5jb25maWcoY29uZmlnKTtcblxuZnVuY3Rpb24gY29uZmlnKCRyb3V0ZVByb3ZpZGVyLCAkbWRUaGVtaW5nUHJvdmlkZXIsICRodHRwUHJvdmlkZXIsICRsb2NhbFN0b3JhZ2VQcm92aWRlcikge1xuXHQkcm91dGVQcm92aWRlclxuXHRcdC53aGVuKCcvbG9naW4nLCB7XG5cdFx0XHRjb250cm9sbGVyOiAnbG9naW5Db250cm9sbGVyJyxcblx0XHRcdHRlbXBsYXRlVXJsOiAndmlld3MvbG9naW4uaHRtbCcsXG5cdFx0fSlcblx0XHQud2hlbignLycsIHtcblx0XHRcdGNvbnRyb2xsZXI6ICdob21lQ29udHJvbGxlcicsXG5cdFx0XHR0ZW1wbGF0ZVVybDogJ3ZpZXdzL2hvbWUuaHRtbCcsXG5cdFx0fSlcblx0XHQud2hlbignL3VzZXInLCB7XG5cdFx0XHRjb250cm9sbGVyOiAndXNlckNvbnRyb2xsZXInLFxuXHRcdFx0dGVtcGxhdGVVcmw6ICd2aWV3cy9sb2dpbi5odG1sJyxcblx0XHR9KVxuICAgICAgICAud2hlbignL2V2ZW50cycsIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIgOiAnZXZlbnRzQ29udHJvbGxlcicsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybCA6ICd2aWV3cy9ldmVudHMuaHRtbCcsXG4gICAgICAgICAgICByZWxvYWRPblNlYXJjaCA6IGZhbHNlXG4gICAgICAgIH0pXG4gICAgICAgIC53aGVuKCcvZXZlbnRzLzppZCcsIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdldmVudENvbnRyb2xsZXInLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmwgOiAndmlld3MvZXZlbnQuaHRtbCdcbiAgICAgICAgfSlcbiAgICAgICAgLndoZW4oJy9wcm9maWxlJywge1xuICAgICAgICAgICAgY29udHJvbGxlciA6ICdwcm9maWxlQ29udHJvbGxlcicsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybCA6ICd2aWV3cy9wcm9maWxlLmh0bWwnXG4gICAgICAgIH0pXG5cdFx0Lm90aGVyd2lzZSh7XG5cdFx0XHRyZWRpcmVjdFRvOiAnL2xvZ2luJ1xuXHRcdH0pO1xuXG4gICAgJG1kVGhlbWluZ1Byb3ZpZGVyLnRoZW1lKCdkZWZhdWx0JykucHJpbWFyeVBhbGV0dGUoJ2xpZ2h0LWJsdWUnKS5hY2NlbnRQYWxldHRlKCdvcmFuZ2UnKTtcblxuICAgICRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ25vdEFsbG93ZWRJbnRlcmNlcHRvcicpO1xuICAgICRsb2NhbFN0b3JhZ2VQcm92aWRlclxuICAgICAgICAuc2V0S2V5UHJlZml4KCduZC0nKTtcblx0Ly8gbG9jYWxTdG9yYWdlU2VydmljZVByb3ZpZGVyXG5cdC8vIFx0LnNldFByZWZpeCgnbmVtZWEtZGFzaGJvYXJkJylcblx0Ly8gXHQvL1BST0RVQ1RJT05cblx0Ly8gXHQvLy5zZXRTdG9yYWdlQ29va2llRG9tYWluKHdpbmRvdy5sb2NhdGlvbilcblx0Ly8gXHQvL0RFVlxuXHQvLyBcdC5zZXRTdG9yYWdlQ29va2llRG9tYWluKCcnKVxuXHQvLyBcdDtcblxuLy9cdCRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcbn07XG5cbi8vdGFrZSBhbGwgd2hpdGVzcGFjZSBvdXQgb2Ygc3RyaW5nXG5hcHAuZmlsdGVyKCdub3NwYWNlJywgZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gKCF2YWx1ZSkgPyAnJyA6IHZhbHVlLnJlcGxhY2UoLyAvZywgJycpO1xuICAgICAgfTtcbiAgICB9KTtcblxuLy8gQWx3YXlzIGNoZWNrIGZvciBhIEpXVFxuYXBwLnJ1bihmdW5jdGlvbih1c2VyLCAkbG9jYWxTdG9yYWdlLCAkbG9jYXRpb24sICRyb290U2NvcGUsICRsb2cpIHtcblx0JHJvb3RTY29wZS4kb24oXCIkbG9jYXRpb25DaGFuZ2VTdGFydFwiLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICBpZiAoJGxvY2FsU3RvcmFnZVtcInRva2VuXCJdID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgJGxvZy5pbmZvKFwibm8gdG9rZW4gZm91bmQsIHJlZGlyZWN0aW5nIHRvIC9sb2dpblwiKVxuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoXCIvbG9naW5cIik7XG4gICAgICAgIH1cbiAgICB9KVxufSlcblxuLy8gSFRUUCBpbnRlcmNlcHRvciBpbmplY3RlZCBpbiBjb25maWdcbmFwcC5mYWN0b3J5KCdub3RBbGxvd2VkSW50ZXJjZXB0b3InLCBmdW5jdGlvbigkbG9nLCAkbG9jYWxTdG9yYWdlLCAkbG9jYXRpb24sICRpbmplY3RvciwgJHEpIHtcbiAgICB2YXIgbm90QWxsb3dlZEludGVyY2VwdG9yID0ge1xuICAgICAgICAvLyBJbnRlcmNlcHQgJGh0dHAgZXJyb3JzXG4gICAgICAgIHJlc3BvbnNlRXJyb3IgOiBmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgLy8gQ2hlY2sgZm9yIDQwMSBlcnJvclxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSA0MDEpIHtcbiAgICAgICAgICAgICAgICAkbG9nLmVycm9yKCdZb3UgYXJlIG5vdCBhbGxvd2VkIHRvIGFjY2VzcywgcmVkaXJlY3RpbmcgdG8gL2xvZ2luJyk7XG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIGV4aXNpdGluZyBKV1QgZnJvbSBsb2NhbFN0b3JhZ2UgXG4gICAgICAgICAgICAgICAgZGVsZXRlICRsb2NhbFN0b3JhZ2VbXCJ0b2tlblwiXTtcbiAgICAgICAgICAgICAgICAvLyBSZWRpcmVjdCB0byBsb2dpblxuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvbG9naW4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIFJldHVybiBwcm9taXNlIHNvIHdlIGNhbiBoYW5kbGUgdGhlIGVycm9yIGZ1cnRoZXJcbiAgICAgICAgICAgIHJldHVybiAkcS5yZWplY3QocmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBub3RBbGxvd2VkSW50ZXJjZXB0b3I7XG59KVxuIiwiYXBwLmZhY3RvcnkoJ21lbnUnLCBbJyRodHRwJywgZnVuY3Rpb24oJGh0dHApIHtcblx0cmV0dXJuICRodHRwLmdldCgnanNvbi9tZW51Lmpzb24nKVxuXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRcdHJldHVybiBkYXRhO1xuXHRcdH0pO1xuXHQvL1x0LmVycm9yKGNvbnNvbGUubG9nKCdDYW5ub3QgcmV0cmlldmUgZGF0YScpKTtcbn1dKTtcblxuYXBwLmZhY3RvcnkoJ2pzb25kYXRhJywgWyckaHR0cCcsIGZ1bmN0aW9uKCRodHRwKSB7XG5cdHJldHVybiAkaHR0cC5nZXQoJ2pzb24vdGVzdGZpbGVfMTAwLmpzb24nKVxuXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRcdHJldHVybiBkYXRhO1xuXHRcdH0pO1xuXHQvL1x0LmVycm9yKGNvbnNvbGUubG9nKCdDYW5ub3QgcmV0cmlldmUgZGF0YScpKTtcbn1dKTtcblxuYXBwLmRpcmVjdGl2ZShcInNpZGViYXJNZW51XCIsIGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4ge1xuICAgICAgICBzY29wZToge1xuXHRcdFx0c2VjdGlvbjogJz0nXG5cdFx0fSxcblx0XHR0ZW1wbGF0ZVVybDogJ3BhcnRpYWxzL3NpZGViYXItbWVudS5odG1sJyxcbiAgICAgICAgY29udHJvbGxlcjogZnVuY3Rpb24oJHNjb3BlLCAkbWRTaWRlbmF2LCAkbG9jYXRpb24sIE1FTlUsIHVzZXIpIHtcbiAgICAgICAgICAgICRzY29wZS5tZW51ID0gTUVOVTtcblxuICAgICAgICAgICAgJHNjb3BlLmlzQWN0aXZlID0gZnVuY3Rpb24oY3VycmVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybigkbG9jYXRpb24ucGF0aCgpID09IGN1cnJlbnQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuY2hhbmdlTW9kZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS4kZW1pdCgncmVxQ2hhbmdlTW9kZScpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkc2NvcGUuZW5hYmxlID0gdHJ1ZTtcblxuICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZUl0ZW0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUudG9nZ2xlQnRuID0gXCJ0b2dnbGVkXCI7XG4gICAgICAgICAgICB9O1xuXG5cbiAgICAgICAgICAgICRzY29wZS5jbG9zZUxlZnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkbWRTaWRlbmF2KCdsZWZ0JykudG9nZ2xlKCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAkc2NvcGUubG9nb3V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdXNlci5sb2dvdXQoKTtcbiAgICAgICAgICAgIH1cbiAgICBcbiBcbiAgICAgICAgfVxuXHR9O1xufSk7XG5cbmFwcC5kaXJlY3RpdmUoXCJ0b3BiYXJNZW51XCIsIGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4ge1xuXHRcdHNjb3BlOiB7XG5cdFx0XHRzZWN0aW9uOiAnPSdcblx0XHR9LFxuXHRcdHRlbXBsYXRlVXJsOiAncGFydGlhbHMvdG9wYmFyLW1lbnUuaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXIgOiBmdW5jdGlvbigkc2NvcGUsICRtZFNpZGVuYXYpIHtcbiAgICAgICAgICAgICRzY29wZS50b2dnbGVMZWZ0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJG1kU2lkZW5hdignbGVmdCcpLnRvZ2dsZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cdH07XG59KTtcblxuXG5hcHAuY29udHJvbGxlcigndG9wQmFyJywgdG9wQmFyQ3RybCk7XG5cbmZ1bmN0aW9uIHRvcEJhckN0cmwoJG1kRGlhbG9nLCAkbG9jYXRpb24sICRtZFNpZGVuYXYpe1xuICAgIHRoaXMudG9nZ2xlTGVmdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAkbWRTaWRlbmF2KCdsZWZ0JykudG9nZ2xlKCk7XG4gICAgfTtcbn07XG5cbmFwcC5kaXJlY3RpdmUoXCJib3hlc1wiLCBmdW5jdGlvbigpIHtcblx0cmV0dXJuIHtcblx0XHRzY29wZToge1xuXHRcdFx0c2VjdGlvbjogJz0nXG5cdFx0fSxcblx0XHR0ZW1wbGF0ZVVybDogJ3BhcnRpYWxzL2JveGVzLmh0bWwnXG5cdH07XG59KTtcblxuXG5hcHAuZGlyZWN0aXZlKCdjbGlja0VkaXQnLCBmdW5jdGlvbigpIHtcblx0dmFyIHRlbXBsYXRlID0gJzxkaXY+PGgyIG5nLXNob3c9XCJ2aWV3LnNob3dUaXRsZVwiIG5nLWNsaWNrPVwiZWRpdFRpdGxlKClcIj57e2JveC50aXRsZX19PC9oMj4nICtcblx0XHRcdFx0JzxtZC1pbnB1dC1jb250YWluZXIgbmctaGlkZT1cInNob3dUaXRsZVwiPicgK1xuXHRcdFx0XHRcdCc8aW5wdXQgdHlwZT1cInRleHRcIiB2YWx1ZT1cInt7Ym94LnRpdGxlfX1cIiBuZy1ibHVyPVwiZWRpdFRpdGxlKGJveC50aXRsZSlcIiBuZy1tb2RlbD1cImJveC50aXRsZVwiIGNsYXNzPVwiZm9jdXNUaXRsZVwiIGFyaWEtbGFiZWw9XCJFZGl0IFRpdGxlXCI+JyArXG5cdFx0XHRcdCc8L21kLWlucHV0LWNvbnRhaW5lcj48L2Rpdj4nO1xuXG5cdHJldHVybiB7XG5cdFx0cmVzdHJpY3QgXHQ6IFwiQVwiLFxuXHRcdHJlcGxhY2VcdFx0OiB0cnVlLFxuXHRcdHRlbXBsYXRlIFx0OiB0ZW1wbGF0ZSxcblx0XHRzY29wZVx0XHQ6IHtcblx0XHRcdHZhbHVlOiBcIj1jbGlja0VkaXRcIlxuXHRcdH0sXG5cdFx0Y29udHJvbGxlclx0OiBmdW5jdGlvbigkc2NvcGUsIGlucHV0VGV4dCwgJHRpbWVvdXQpIHtcblx0XHRcdCRzY29wZS52aWV3LnNob3dUaXRsZSA9IHRydWU7XG5cblx0XHRcdGlmICgkc2NvcGUuc2hvd1RpdGxlID0gdHJ1ZSkge1xuXHRcdCAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdCAgICAgICAgYW5ndWxhci5lbGVtZW50KCcuZm9jdXNUaXRsZScpLnRyaWdnZXIoJ2ZvY3VzJyk7XG5cdFx0ICAgICAgICBjb25zb2xlLmxvZyhcInRyaWdnZXJcIik7XG5cdFx0ICAgICAgfSwgMTAwKTtcblx0XHQgICAgfTtcblxuXHRcdCAgICAkc2NvcGUuZWRpdFRpdGxlID0gZnVuY3Rpb24oKSB7XG5cdFx0ICAgIFx0JHNjb3BlLnZpZXcuc2hvd1RpdGxlID0gISRzY29wZS52aWV3LnNob3dUaXRsZTtcblx0XHQgICAgfTtcblx0XHR9XG5cdH07XG59KTtcblxuYXBwLmRpcmVjdGl2ZShcImNsaWNrVG9FZGl0XCIsIGZ1bmN0aW9uKCkge1xuICAgIHZhciBlZGl0b3JUZW1wbGF0ZSA9ICc8ZGl2IGNsYXNzPVwiY2xpY2stdG8tZWRpdFwiPicgK1xuICAgICAgICAnPGRpdiBuZy1oaWRlPVwidmlldy5lZGl0b3JFbmFibGVkXCIgbmctY2xpY2s9XCJlbmFibGVFZGl0b3IoKVwiPicgK1xuICAgICAgICAgICAgJzxhIG5nLWNsaWNrPVwiZW5hYmxlRWRpdG9yKClcIj48bWQtaWNvbiBtZC1zdmctc3JjPVwiaW1nL2ljb25zL2VkaXQuc3ZnXCI+PC9tZC1pY29uPjwvYT4nICtcbiAgICAgICAgICAgICd7e3ZhbHVlfX0gJyArXG4gICAgICAgICc8L2Rpdj4nICtcbiAgICAgICAgJzxtZC1pbnB1dC1jb250YWluZXIgbmctc2hvdz1cInZpZXcuZWRpdG9yRW5hYmxlZFwiPicgK1xuXHQgICAgICAgICc8ZGl2PicgK1xuXHQgICAgICAgICAgICAnPGlucHV0IG5nLW1vZGVsPVwidmlldy5lZGl0YWJsZVZhbHVlXCIgY2xhc3M9XCJmb2N1c1RpdGxlXCIgYXJpYS1sYWJlbD1cIlRpdGxlXCI+JyArXG5cdCAgICAgICAgICAgICc8c3BhbiBuZy1jbGljaz1cInNhdmUoKVwiPlNhdmU8L3NwYW4+JyArXG5cdCAgICAgICAgICAgICcgb3IgJyArXG5cdCAgICAgICAgICAgICc8YSBuZy1jbGljaz1cImRpc2FibGVFZGl0b3IoKVwiPmNhbmNlbDwvYT4uJyArXG5cdCAgICAgICAgJzwvZGl2PicgK1xuXHQgICAgJzwvbWQtaW5wdXQtY29udGFpbmVyPicgK1xuICAgICc8L2Rpdj4nO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6IFwiQVwiLFxuICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICB0ZW1wbGF0ZTogZWRpdG9yVGVtcGxhdGUsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICB2YWx1ZTogXCI9Y2xpY2tUb0VkaXRcIixcbiAgICAgICAgfSxcbiAgICAgICAgY29udHJvbGxlcjogZnVuY3Rpb24oJHNjb3BlLCAkdGltZW91dCkge1xuICAgICAgICAgICAgJHNjb3BlLnZpZXcgPSB7XG4gICAgICAgICAgICAgICAgZWRpdGFibGVWYWx1ZTogJHNjb3BlLnZhbHVlLFxuICAgICAgICAgICAgICAgIGVkaXRvckVuYWJsZWQ6IGZhbHNlXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAkc2NvcGUuZW5hYmxlRWRpdG9yID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnZpZXcuZWRpdG9yRW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnZpZXcuZWRpdGFibGVWYWx1ZSA9ICRzY29wZS52YWx1ZTtcblxuICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdCAgICAgICAgYW5ndWxhci5lbGVtZW50KCcuZm9jdXNUaXRsZScpLnRyaWdnZXIoJ2ZvY3VzJyk7XG5cdFx0ICAgICAgICBjb25zb2xlLmxvZyhcInRyaWdnZXJcIik7XG5cdFx0ICAgICAgfSwgMTAwKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICRzY29wZS5kaXNhYmxlRWRpdG9yID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnZpZXcuZWRpdG9yRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUudmFsdWUgPSAkc2NvcGUudmlldy5lZGl0YWJsZVZhbHVlO1xuICAgICAgICAgICAgICAgICRzY29wZS5kaXNhYmxlRWRpdG9yKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfTtcbn0pO1xuIiwiYXBwLnZhbHVlKCdib3hlc19hcnInLCBbXG4gIHsgXG4gICAgXCJyb3dcIiAgIDogMCxcbiAgICBcImhlaWdodFwiIDogXCJcIixcbiAgICBcIml0ZW1zXCIgOiBbXG4gICAgICB7XG4gICAgICAgIFwidGl0bGVcIiAgIDogXCJFdmVudHMgc2hhcmVzXCIsXG4gICAgICAgIFwidHlwZVwiICAgIDogXCJwaWVjaGFydFwiLFxuICAgICAgICBcImNvbnRlbnRcIiA6IFwiXCIsXG4gICAgICAgIFwiY29uZmlnXCIgIDoge1xuICAgICAgICAgICAgXCJtZXRyaWNcIiAgICA6IFwiY2F0ZWdvcnlcIixcbiAgICAgICAgICAgIFwidHlwZVwiICAgICAgOiBcInBpZWNoYXJ0XCIsXG4gICAgICAgICAgICBcInBlcmlvZFwiICAgIDogXCIyNFwiLFxuICAgICAgICAgICAgXCJiZWdpbnRpbWVcIiA6IFwiXCJcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgXCJ0aXRsZVwiICAgOiBcIkxhc3QgMjQgaG91cnNcIixcbiAgICAgICAgXCJ0eXBlXCIgICAgOiBcImJhcmNoYXJ0XCIsXG4gICAgICAgIFwiZGF0YVwiICAgIDogXCJcIixcbiAgICAgICAgXCJ0aW1lc3RhbXBcIjogXCJcIixcbiAgICAgICAgXCJjb25maWdcIiA6IHtcbiAgICAgICAgICAgIFwibWV0cmljXCIgOiBcImNhdGVnb3J5XCIsXG4gICAgICAgICAgICBcInR5cGVcIiA6IFwiYmFyY2hhcnRcIixcbiAgICAgICAgICAgIFwicGVyaW9kXCIgOiAyNCxcbiAgICAgICAgICAgIFwid2luZG93XCIgOiA2MCxcbiAgICAgICAgICAgIFwiYmVnaW50aW1lXCIgOiBcIlwiXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBdXG4gIH0sXG4gIHsgXG4gICAgXCJyb3dcIiAgIDogMSxcbiAgICBcIml0ZW1zXCIgOiBbXG4gICAgICB7XG4gICAgICAgIFwidGl0bGVcIiA6IFwiVG9wIGV2ZW50cyBpbiAxIGhvdXJcIixcbiAgICAgICAgXCJ0eXBlXCIgIDogXCJ0b3BcIixcbiAgICAgICAgXCJjb25maWdcIiA6IHtcbiAgICAgICAgICAgIFwicGVyaW9kXCIgOiAxLFxuICAgICAgICAgICAgXCJiZWdpbnRpbWVcIiA6IFwiXCJcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIFwidGl0bGVcIjogXCIyXCIsXG4gICAgICAgIFwidHlwZVwiICAgIDogXCJpbmNpZGVudFwiXG4gICAgICB9LFxuICAgIF1cbiAgfSxcbiAgXSk7XG5cblxuYXBwLmNvbnRyb2xsZXIoJ2hvbWVDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkbG9nLCBhcGksIGJveGVzX2FyciwgJGh0dHAsICRsb2NhbFN0b3JhZ2UsIHVzZXIpIHtcbiAgICAkc2NvcGUuYWN0aXZlR3JpZCA9IGZhbHNlOyBcbiAgICAkc2NvcGUub3Blbk1lbnUgPSBmdW5jdGlvbigkbWRPcGVuTWVudSwgZXYpIHtcbiAgICAgICAgb3JpZ2luYXRvckV2ID0gZXY7XG4gICAgICAgICRtZE9wZW5NZW51KGV2KTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLmFkZEl0ZW0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgJHNjb3BlLiRicm9hZGNhc3QoJ2FkZEl0ZW0nKTtcbiAgICB9XG5cbiAgICAkc2NvcGUuZW5hYmxlR3JpZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25zb2xlLmxvZygnRW5hYmxlIGdyaWQnKVxuICAgICAgICAkc2NvcGUuJGJyb2FkY2FzdCgnZW5hYmxlR3JpZCcpO1xuICAgICAgICAkc2NvcGUuYWN0aXZlR3JpZCA9ICEkc2NvcGUuYWN0aXZlR3JpZDtcbiAgICB9XG5cblxufSk7XG5cbmFwcC5jb250cm9sbGVyKCd0b3BCYXInLCB0b3BCYXJDdHJsKTtcblxuZnVuY3Rpb24gdG9wQmFyQ3RybCgkbWREaWFsb2csICRsb2NhdGlvbiwgJG1kU2lkZW5hdil7XG5cblx0dGhpcy51c2VyID0gXCJQZXRyXCJcblxuICB0aGlzLnRvZ2dsZUxlZnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICRtZFNpZGVuYXYoJ2xlZnQnKS50b2dnbGUoKTtcbiAgICB9O1xuICBcdFxuICB0aGlzLmxvZ291dCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBjb25maXJtID0gJG1kRGlhbG9nLmNvbmZpcm0oKVxuXHQgICAgICAgIC50aXRsZSgnQXJlIHlvdSBzdXJlPycpXG5cdCAgICAgICAgLmNvbnRlbnQoJ1lvdSBhcmUgYWJvdXQgdG8gYmUgbG9nZ2VkIG91dC4gQWxsIHVuc2F2ZWQgY2hhbmdlcyB3aWxsIGJlIGxvc3QgaW4gdGhlIHZvaWQhJylcblx0ICAgICAgICAub2soJ0xvZyBtZSBvdXQnKVxuXHQgICAgICAgIC5jYW5jZWwoJ0tlZXAgbWUgaGVyZScpXG4gICAgJG1kRGlhbG9nLnNob3coY29uZmlybSkudGhlbihcbiAgICBcdGZ1bmN0aW9uKCkge1xuICAgIFx0XHQkbG9jYXRpb24ucGF0aCgnL2xvZ2luJyk7XG4gICAgXHR9KTtcbiAgfTtcblxuICBcbn07XG5cbmFwcC5jb250cm9sbGVyKCdyb3cnLCBmdW5jdGlvbigkc2NvcGUsICR0aW1lb3V0KXtcbiAgJHNjb3BlLiRvbigncmVxdWVzdFJlZHJhdycsIGZ1bmN0aW9uKGUpIHtcbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgY29uc29sZS5sb2coXCJyZXF1ZXN0IGFjY2VwdGVkXCIpO1xuICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdyZXNpemUnKSk7XG4gICAgfSwgMTApO1xuICB9KTtcbn0pO1xuXG5hcHAuY29udHJvbGxlcignYm94JywgZnVuY3Rpb24oJHNjb3BlLCAkbG9nLCBib3hlc19hcnIsICR0aW1lb3V0LCAkZWxlbWVudCwgJG1kRGlhbG9nLCBQUk9UT0NPTFMsIFRZUEVTLCBDQVRFR09SSUVTLCAkaHR0cCwgUElFQ0hBUlQsIEFSRUEsIGFwaSwgJGxvY2F0aW9uLCB1c2VyKXtcbiAgICBcbiAgICBmdW5jdGlvbiB0aW1lU2hpZnQoKSB7ICAgIFxuICAgICAgICBpZiAoJHNjb3BlLmJveCAhPSB1bmRlZmluZWQgJiYgKCRzY29wZS5ib3gudHlwZSA9PSBcInBpZWNoYXJ0XCIgfHwgJHNjb3BlLmJveC50eXBlID09IFwiYmFyY2hhcnRcIiB8fCAkc2NvcGUuYm94LnR5cGUgPT0gJ3RvcCcgfHwgJHNjb3BlLmJveC50eXBlID09IFwic3VtXCIgKSkge1xuICAgICAgICAgICAgJHNjb3BlLmJveC5jb25maWcuYmVnaW50aW1lID0gKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgICAgIG5vdy5zZXRIb3Vycyhub3cuZ2V0SG91cnMoKSAtICRzY29wZS5ib3guY29uZmlnLnBlcmlvZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vdztcbiAgICAgICAgICAgIH0pKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0aW1lU2hpZnQoKTtcblxuICAgICRzY29wZS5ib3gubG9hZGluZyA9IHRydWU7XG4gICAgICAgIFxuICAgICRzY29wZS5vcGVuTWVudSA9IGZ1bmN0aW9uKCRtZE9wZW5NZW51LCBldikge1xuICAgICAgICBvcmlnaW5hdG9yRXYgPSBldjtcbiAgICAgICAgJG1kT3Blbk1lbnUoZXYpO1xuICAgIH07XG5cbiAgICAkc2NvcGUuZWRpdE1vZGUgPSBmYWxzZTtcbiAgICAkc2NvcGUuYmFja3VwTW9kZWwgPSB7fTtcblxuICAgICRzY29wZS5wcm90b2NvbCA9IFBST1RPQ09MUztcbiAgICAkc2NvcGUudHlwZXMgPSBUWVBFUztcbiAgICAkc2NvcGUuY2F0ZWdvcmllcyA9IENBVEVHT1JJRVM7XG5cblxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAvLyBFZGl0IG1vZGUgaGFuZGxpbmdcbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAvLyBUcmlnZ2VyIGVkaXRpbmcgbW9kZSBhbmQgc2F2ZSBjdXJyZW50IHN0YXRlXG4gICAgJHNjb3BlLmVkaXQgPSBmdW5jdGlvbihib3gpIHtcbiAgICAgICAgJHNjb3BlLmVkaXRNb2RlID0gdHJ1ZTtcbiAgICAgICAgJHNjb3BlLmJhY2t1cE1vZGVsID0gYW5ndWxhci5jb3B5KGJveCk7XG4gICAgICAgICRzY29wZS4kZW1pdChcInN3aXRjaC1kcmFnXCIpO1xuICAgIH1cblxuICAgIC8vIFNhdmUgY2hhbmdlcyBhbmQgZGlzYWJsZSBlZGl0IG1vZGVcbiAgICAkc2NvcGUuc2F2ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAkc2NvcGUudXNlcigpO1xuICAgICAgICBpZiAoJHNjb3BlLmJveC50eXBlID09ICdwaWVjaGFydCcpIHtcbiAgICAgICAgICAgICRzY29wZS5ib3gub3B0aW9ucyA9IFBJRUNIQVJULm9wdGlvbnM7XG4gICAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBpZiAoJHNjb3BlLmJveC50eXBlID09ICdiYXJjaGFydCcpXG4gICAgICAgICAgICAkc2NvcGUuYm94Lm9wdGlvbnMgPSBBUkVBLm9wdGlvbnM7XG4gICAgICAgIFxuXG4gICAgICAgICRzY29wZS5iYWNrdXBNb2RlbCA9IHt9O1xuXG4gICAgICAgICRzY29wZS5ib3guY29uZmlnLnR5cGUgPSAkc2NvcGUuYm94LnR5cGU7XG4gICAgICAgIFxuICAgICAgICAvLyBEaXNhYmxlIGVkaXQgbW9kZVxuICAgICAgICAkc2NvcGUuZWRpdE1vZGUgPSBmYWxzZTtcblxuICAgICAgICAvLyBTaG93IGxvYWRpbmcgaW5kaWNhdG9yXG4gICAgICAgICRzY29wZS5ib3gubG9hZGluZyA9IHRydWU7XG5cbiAgICAgICAgLy8gU2hpZnQgdGltZSBmb3IgcXVlcnlcbiAgICAgICAgdGltZVNoaWZ0KCk7XG5cbiAgICAgICAgJHNjb3BlLiRlbWl0KFwic3dpdGNoLWRyYWdcIik7XG4gICAgICAgIC8vIEdldCByZXF1aXJlZCBkYXRhXG4gICAgICAgIGlmICgkc2NvcGUuYm94LnR5cGUgPT0gJ3BpZWNoYXJ0JyB8fCAkc2NvcGUuYm94LnR5cGUgPT0gJ2JhcmNoYXJ0Jykge1xuICAgICAgICAgICAgYXBpLmdldCgnYWdnJywgJHNjb3BlLmJveC5jb25maWcsIHRydWUpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5ib3gubG9hZGluZyA9IGZhbHNlOyAgICBcbiAgICAgICAgICAgICAgICAkc2NvcGUuYm94LmRhdGEgPSBkYXRhO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBlbHNlIGlmICgkc2NvcGUuYm94LnR5cGUgPT0gJ3RvcCcpIHtcbiAgICAgICAgICAgIGFwaS5nZXQoJ3RvcCcsICRzY29wZS5ib3guY29uZmlnLCB0cnVlKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYm94LmxvYWRpbmcgPSBmYWxzZTsgICAgXG4gICAgICAgICAgICAgICAgJHNjb3BlLmJveC5kYXRhID0gZGF0YTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSBpZiAoJHNjb3BlLmJveC50eXBlID09ICdzdW0nKSB7XG4gICAgICAgICAgICBhcGkuZ2V0KCdjb3VudCcsICRzY29wZS5ib3guY29uZmlnKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYm94LmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYm94LmRhdGEgPSBkYXRhO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIFJldmVydCB0byBvcmlnaW5hbCBhbmQgZGlzYWJsZSBlZGl0IG1vZGVcbiAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24oYm94KSB7XG4gICAgICAgICRzY29wZS5ib3ggPSBhbmd1bGFyLmNvcHkoJHNjb3BlLmJhY2t1cE1vZGVsKTtcbiAgICAgICAgJHNjb3BlLmJhY2t1cE1vZGVsID0ge307XG4gICAgICAgICRzY29wZS5lZGl0TW9kZSA9IGZhbHNlO1xuICAgICAgICAkc2NvcGUuJGVtaXQoXCJzd2l0Y2gtZHJhZ1wiKTtcbiAgICB9XG4gICAgXG4gICAgJHNjb3BlLnRvcCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aW1lU2hpZnQoKVxuICAgICAgICBhcGkuZ2V0KCd0b3AnLCAkc2NvcGUuYm94LmNvbmZpZywgdHJ1ZSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICRzY29wZS5ib3guZGF0YSA9IGRhdGE7XG4gICAgICAgIH0pXG4gICAgfVxuICAgIFxuICAgIGlmICgkc2NvcGUuYm94ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAoJHNjb3BlLmJveC50eXBlID09IFwicGllY2hhcnRcIiB8fCAkc2NvcGUuYm94LnR5cGUgPT0gXCJiYXJjaGFydFwiKSB7XG4gICAgICAgICAgICBpZiAoJHNjb3BlLmJveC50eXBlID09ICdwaWVjaGFydCcpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYm94Lm9wdGlvbnMgPSBQSUVDSEFSVC5vcHRpb25zO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCRzY29wZS5ib3gudHlwZSA9PSAnYmFyY2hhcnQnKVxuICAgICAgICAgICAgICAgICRzY29wZS5ib3gub3B0aW9ucyA9IEFSRUEub3B0aW9ucztcbiAgICAgICAgICAgXG4gICAgICAgICAgICAkc2NvcGUuYm94LmNvbmZpZy50eXBlID0gJHNjb3BlLmJveC50eXBlO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBhcGkuZ2V0KCdhZ2cnLCAkc2NvcGUuYm94LmNvbmZpZykuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmJveC5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmJveC5kYXRhID0gZGF0YTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBTdW0gYWxsIGV2ZW50c1xuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuYm94LnR5cGUgPT0gJ3BpZWNoYXJ0Jykge1xuICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgJHNjb3BlLmJveC5kYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudG90YWwgPSAkc2NvcGUudG90YWwgKyBOdW1iZXIoJHNjb3BlLmJveC5kYXRhW2ldLngpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoJHNjb3BlLmJveC50eXBlID09ICd0b3AnKSB7XG4gICAgICAgICAgICBhcGkuZ2V0KCd0b3AnLCAkc2NvcGUuYm94LmNvbmZpZykuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmJveC5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmJveC5kYXRhID0gZGF0YTsgICAgICAgIFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBlbHNlIGlmICgkc2NvcGUuYm94LnR5cGUgPT0gJ3N1bScpIHtcbiAgICAgICAgICAgIGFwaS5nZXQoJ2NvdW50JywgJHNjb3BlLmJveC5jb25maWcpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5ib3gubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5ib3guZGF0YSA9IGRhdGE7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgJHNjb3BlLnVzZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNldHRpbmdzID0gYW5ndWxhci5jb3B5KCRzY29wZS5pdGVtcyk7XG4gICAgICAgIGNvbnNvbGUubG9nKHNldHRpbmdzKVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNldHRpbmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHNldHRpbmdzW2ldW1wiZGF0YVwiXTtcbiAgICAgICAgICAgICAgICBkZWxldGUgc2V0dGluZ3NbaV1bXCJvcHRpb25zXCJdO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB2YXIgcXVlcnkgPSB7XG4gICAgICAgICAgICBcImp3dFwiIDogdXNlci5qd3QoKSxcbiAgICAgICAgICAgIFwic2V0dGluZ3NcIiA6IHNldHRpbmdzXG4gICAgICAgIH1cblxuICAgICAgICAkbG9nLmluZm8ocXVlcnkpXG4gICAgICAgIHVzZXIucHV0KHF1ZXJ5KVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRGF0YVwiKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgJGxvZy5lcnJvcihkYXRhKVxuICAgICAgICAgICAgfSlcbiAgICB9XG5cbiAgICAkc2NvcGUuJG9uKCdzYXZlVXNlcicsIGZ1bmN0aW9uKCkgeyRzY29wZS51c2VyKCl9KTtcblxuICAgICRzY29wZS4kb24oJ2dyaWRzdGVyLWl0ZW0tcmVzaXplZCcsIGZ1bmN0aW9uKGdyaWRzdGVyKSB7XG4gICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVxdWVzdCBhY2NlcHRlZFwiKTtcbiAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3Jlc2l6ZScpKTtcbiAgICAgICAgfSwgMTAwKTtcbiAgICB9KVxuXG4gIFxufSk7XG5cbmFwcC5jb250cm9sbGVyKCdncmlkJywgZnVuY3Rpb24oJHNjb3BlLCAkdGltZW91dCwgJGxvZy8qLCAkbWRNZWRpYSwgJHdpbmRvdyovLCB1c2VyKSB7XG4kc2NvcGUub3B0ID0ge1xuICAgIG91dGVyTWFyZ2luOiBmYWxzZSxcbiAgICBjb2x1bW5zOiA2LFxuICAgIHB1c2hpbmc6IHRydWUsXG4gICAgcm93SGVpZ2h0OiAyNTAgKyAxMCxcbiAgICBjb2xXaWR0aCA6ICdhdXRvJyxcbiAgICBmbG9hdGluZzogdHJ1ZSxcbiAgICBzd2FwcGluZzogdHJ1ZSxcbiAgICBtb2JpbGVCcmVha1BvaW50OiA5MzMsXG4gICAgZHJhZ2dhYmxlOiB7XG4gICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgIH0sXG4gICAgcmVzaXphYmxlOiB7XG4gICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICBoYW5kbGVzOiBbJ24nLCAnZScsICdzJywgJ3cnLCAnc2UnLCAnc3cnXSxcbiAgICAgICAgc3RvcDogZnVuY3Rpb24oZXZlbnQsICRlbGVtZW50LCB3aWRnZXQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVzaXplIGVuZFwiKTtcbiAgICAgICAgICAgICRzY29wZS4kZW1pdCgncmVxdWVzdFJlZHJhdycpO1xuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVxdWVzdCBhY2NlcHRlZFwiKTtcbiAgICAgICAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdyZXNpemUnKSk7XG4gICAgICAgICAgICB9LCAxMDApO1xuXG4gICAgICAgIH1cbiAgICB9XG59XG4vKnZhciB3ID0gYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpO1xudy5iaW5kKCdyZXNpemUnLCBmdW5jdGlvbigpIHtcbiAgICAvLyRzY29wZS5vcHQubW9iaWxlTW9kZUVuYWJsZSA9ICRtZE1lZGlhKCdndC1tZCcpO1xuICAgICRzY29wZS5vcHQuaXNNb2JpbGUgPSAhJG1kTWVkaWEoJ2d0LW1kJyk7XG59KTsqL1xuXG5jb25zb2xlLmxvZyh1c2VyLmNvbmZpZygpKVxuXG5cbiRzY29wZS4kb24oJ2VuYWJsZUdyaWQnLCBmdW5jdGlvbigpIHtcbiAgICBpZiAoJHNjb3BlLm9wdC5yZXNpemFibGUuZW5hYmxlZCA9PSB0cnVlKSB7XG4gICAgICAgICRzY29wZS4kYnJvYWRjYXN0KCdzYXZlVXNlcicpO1xuICAgIH1cbiAgICBcbiAgICAkc2NvcGUub3B0LnJlc2l6YWJsZS5lbmFibGVkID0gISRzY29wZS5vcHQucmVzaXphYmxlLmVuYWJsZWQ7IFxuICAgICRzY29wZS5vcHQuZHJhZ2dhYmxlLmVuYWJsZWQgPSAhJHNjb3BlLm9wdC5kcmFnZ2FibGUuZW5hYmxlZDsgXG59KVxuXG4kc2NvcGUucmVtb3ZlID0gZnVuY3Rpb24oYm94KSB7XG5cbiAgICB2YXIgdG1wID0gJHNjb3BlLml0ZW1zLnNwbGljZSgkc2NvcGUuaXRlbXMuaW5kZXhPZihib3gpLCAxKTtcblxuICB9O1xuXG4kc2NvcGUuaXRlbXMgPSB1c2VyLmNvbmZpZygpO1xuLyokc2NvcGUuaXRlbXMgPSBbe1xuICAgIHNpemVYOiAyLFxuICAgIHNpemVZOiAyLFxuICAgIHJvdzogMCxcbiAgICBjb2w6IDAsXG4gICAgXCJ0aXRsZVwiICAgOiBcIkV2ZW50cyBzaGFyZXNcIixcbiAgICBcInR5cGVcIiAgICA6IFwicGllY2hhcnRcIixcbiAgICBcImNvbnRlbnRcIiA6IFwiXCIsXG4gICAgXCJjb25maWdcIiAgOiB7XG4gICAgICAgIFwibWV0cmljXCIgICAgOiBcImNhdGVnb3J5XCIsXG4gICAgICAgIFwidHlwZVwiICAgICAgOiBcInBpZWNoYXJ0XCIsXG4gICAgICAgIFwicGVyaW9kXCIgICAgOiBcIjI0XCIsXG4gICAgICAgIFwiYmVnaW50aW1lXCIgOiBcIlwiXG4gICAgfVxufSwge1xuICAgIHNpemVYOiAyLFxuICAgIHNpemVZOiAyLFxuICAgIG1pblNpemVYIDogMixcbiAgICBtaW5TaXplWSA6IDIsXG4gICAgcm93OiAwLFxuICAgIGNvbDogMixcbiAgICBcInRpdGxlXCIgOiBcIkxhc3QgMjQgaG91cnNcIixcbiAgICBcInR5cGVcIiA6IFwiYmFyY2hhcnRcIixcbiAgICBcImRhdGFcIiA6IFwiXCIsXG4gICAgXCJ0aW1lc3RhbXBcIjogXCJcIixcbiAgICBcImNvbmZpZ1wiIDoge1xuICAgICAgICBcIm1ldHJpY1wiIDogXCJjYXRlZ29yeVwiLFxuICAgICAgICBcInR5cGVcIiA6IFwiYmFyY2hhcnRcIixcbiAgICAgICAgXCJwZXJpb2RcIiA6IDI0LFxuICAgICAgICBcIndpbmRvd1wiIDogNjAsXG4gICAgICAgIFwiYmVnaW50aW1lXCIgOiBcIlwiXG4gICAgfVxufSwge1xuICAgIFwidGl0bGVcIiA6IFwiVG9wIGV2ZW50cyBpbiAxIGhvdXJcIixcbiAgICBcInR5cGVcIiAgOiBcInRvcFwiLFxuICAgIFwiY29uZmlnXCIgOiB7XG4gICAgICAgIFwicGVyaW9kXCIgOiAxLFxuICAgICAgICBcImJlZ2ludGltZVwiIDogXCJcIlxuICAgIH1cbn1dOyovXG5cbiAgICAkc2NvcGUuJG9uKCdhZGRJdGVtJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBpdGVtID0ge1xuICAgICAgICAgICAgXCJ0aXRsZVwiIDogXCJOZXcgYm94XCIsXG4gICAgICAgICAgICBcImxvYWRpbmdcIiA6IGZhbHNlLFxuICAgICAgICAgICAgc2l6ZVg6IDEsXG4gICAgICAgICAgICBzaXplWTogMSxcbiAgICAgICAgICAgIC8vcm93IDogcm93LFxuICAgICAgICAgICAgLy9jb2wgOiBjb2xcbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5pdGVtcy5wdXNoKGl0ZW0pXG4gICAgfSk7XG5cblxufSlcblxuXG5hcHAuZGlyZWN0aXZlKCdncmlkc3RlckR5bmFtaWNIZWlnaHQnLCBmdW5jdGlvbiAoJHRpbWVvdXQpIHtcblxuICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICBpdGVtOiBcIj1cIiAvL2dyaWRzdGVyIGl0ZW1cbiAgICAgICAgfSxcbiAgICAgICAgbGluazogbGluayxcbiAgICAgICAgcmVzdHJpY3Q6ICdBJ1xuICAgIH07XG4gICAgcmV0dXJuIGRpcmVjdGl2ZTtcblxuICAgIGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICAgIHNjb3BlLiR3YXRjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBlbGVtZW50WzBdLnNjcm9sbEhlaWdodDtcbiAgICAgICAgfSxcbiAgICAgICAgZnVuY3Rpb24obmV3VmFsLCBvbGRWYWwpIHsgXG4gICAgICAgICAgICB2YXIgcm93SGVpZ2h0T3B0aW9uID0gMjcwOyAvLyBDaGFuZ2UgdGhpcyB2YWx1ZSB3aXRoIHlvdXIgb3duIHJvd0hlaWdodCBvcHRpb25cbiAgICAgICAgICAgIHZhciBoZWlnaHQgPSByb3dIZWlnaHRPcHRpb24gKiBzY29wZS5pdGVtLnNpemVZO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhzY29wZS5pdGVtLnRpdGxlKTtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJuZXdWYWw6IFwiICsgbmV3VmFsICsgXCIgICAgIGhlaWdodDogXCIgKyBoZWlnaHQpXG4gICAgICAgICAgICBpZihuZXdWYWwgPiBoZWlnaHQpe1xuICAgICAgICAgICAgICAgIHZhciBkaXYgPSBNYXRoLmZsb29yKG5ld1ZhbCAvIHJvd0hlaWdodE9wdGlvbik7XG4gICAgICAgICAgICAgICAgLy9kaXYrKztcbiAgICAgICAgICAgICAgICBzY29wZS5pdGVtLnNpemVZID0gZGl2OyBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICB9XG59KTtcbiIsIlxuY29uZmlnLiRpbmplY3QgPSBbXCIkcm91dGVQcm92aWRlclwiLCBcIiRtZFRoZW1pbmdQcm92aWRlclwiLCBcIiRodHRwUHJvdmlkZXJcIiwgXCIkbG9jYWxTdG9yYWdlUHJvdmlkZXJcIl07XG50b3BCYXJDdHJsLiRpbmplY3QgPSBbXCIkbWREaWFsb2dcIiwgXCIkbG9jYXRpb25cIiwgXCIkbWRTaWRlbmF2XCJdO3ZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnZ3VpJywgWyduZ01hdGVyaWFsJywgJ25nUm91dGUnLCAnbmdNZXNzYWdlcycsICdudmQzJywgJ25nU3RvcmFnZScsICduZ01hcCcsICdncmlkc3RlciddKTtcblxuYXBwLmNvbmZpZyhjb25maWcpO1xuXG5mdW5jdGlvbiBjb25maWcoJHJvdXRlUHJvdmlkZXIsICRtZFRoZW1pbmdQcm92aWRlciwgJGh0dHBQcm92aWRlciwgJGxvY2FsU3RvcmFnZVByb3ZpZGVyKSB7XG5cdCRyb3V0ZVByb3ZpZGVyXG5cdFx0LndoZW4oJy9sb2dpbicsIHtcblx0XHRcdGNvbnRyb2xsZXI6ICdsb2dpbkNvbnRyb2xsZXInLFxuXHRcdFx0dGVtcGxhdGVVcmw6ICd2aWV3cy9sb2dpbi5odG1sJyxcblx0XHR9KVxuXHRcdC53aGVuKCcvJywge1xuXHRcdFx0Y29udHJvbGxlcjogJ2hvbWVDb250cm9sbGVyJyxcblx0XHRcdHRlbXBsYXRlVXJsOiAndmlld3MvaG9tZS5odG1sJyxcblx0XHR9KVxuXHRcdC53aGVuKCcvdXNlcicsIHtcblx0XHRcdGNvbnRyb2xsZXI6ICd1c2VyQ29udHJvbGxlcicsXG5cdFx0XHR0ZW1wbGF0ZVVybDogJ3ZpZXdzL2xvZ2luLmh0bWwnLFxuXHRcdH0pXG4gICAgICAgIC53aGVuKCcvZXZlbnRzJywge1xuICAgICAgICAgICAgY29udHJvbGxlciA6ICdldmVudHNDb250cm9sbGVyJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsIDogJ3ZpZXdzL2V2ZW50cy5odG1sJyxcbiAgICAgICAgICAgIHJlbG9hZE9uU2VhcmNoIDogZmFsc2VcbiAgICAgICAgfSlcbiAgICAgICAgLndoZW4oJy9ldmVudHMvOmlkJywge1xuICAgICAgICAgICAgY29udHJvbGxlcjogJ2V2ZW50Q29udHJvbGxlcicsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybCA6ICd2aWV3cy9ldmVudC5odG1sJ1xuICAgICAgICB9KVxuICAgICAgICAud2hlbignL3Byb2ZpbGUnLCB7XG4gICAgICAgICAgICBjb250cm9sbGVyIDogJ3Byb2ZpbGVDb250cm9sbGVyJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsIDogJ3ZpZXdzL3Byb2ZpbGUuaHRtbCdcbiAgICAgICAgfSlcblx0XHQub3RoZXJ3aXNlKHtcblx0XHRcdHJlZGlyZWN0VG86ICcvbG9naW4nXG5cdFx0fSk7XG5cbiAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKS5wcmltYXJ5UGFsZXR0ZSgnbGlnaHQtYmx1ZScpLmFjY2VudFBhbGV0dGUoJ29yYW5nZScpO1xuXG4gICAgJGh0dHBQcm92aWRlci5pbnRlcmNlcHRvcnMucHVzaCgnbm90QWxsb3dlZEludGVyY2VwdG9yJyk7XG4gICAgJGxvY2FsU3RvcmFnZVByb3ZpZGVyXG4gICAgICAgIC5zZXRLZXlQcmVmaXgoJ25kLScpO1xuXHQvLyBsb2NhbFN0b3JhZ2VTZXJ2aWNlUHJvdmlkZXJcblx0Ly8gXHQuc2V0UHJlZml4KCduZW1lYS1kYXNoYm9hcmQnKVxuXHQvLyBcdC8vUFJPRFVDVElPTlxuXHQvLyBcdC8vLnNldFN0b3JhZ2VDb29raWVEb21haW4od2luZG93LmxvY2F0aW9uKVxuXHQvLyBcdC8vREVWXG5cdC8vIFx0LnNldFN0b3JhZ2VDb29raWVEb21haW4oJycpXG5cdC8vIFx0O1xuXG4vL1x0JGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xufTtcblxuLy90YWtlIGFsbCB3aGl0ZXNwYWNlIG91dCBvZiBzdHJpbmdcbmFwcC5maWx0ZXIoJ25vc3BhY2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiAoIXZhbHVlKSA/ICcnIDogdmFsdWUucmVwbGFjZSgvIC9nLCAnJyk7XG4gICAgICB9O1xuICAgIH0pO1xuXG4vLyBBbHdheXMgY2hlY2sgZm9yIGEgSldUXG5hcHAucnVuKFtcInVzZXJcIiwgXCIkbG9jYWxTdG9yYWdlXCIsIFwiJGxvY2F0aW9uXCIsIFwiJHJvb3RTY29wZVwiLCBcIiRsb2dcIiwgZnVuY3Rpb24odXNlciwgJGxvY2FsU3RvcmFnZSwgJGxvY2F0aW9uLCAkcm9vdFNjb3BlLCAkbG9nKSB7XG5cdCRyb290U2NvcGUuJG9uKFwiJGxvY2F0aW9uQ2hhbmdlU3RhcnRcIiwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgaWYgKCRsb2NhbFN0b3JhZ2VbXCJ0b2tlblwiXSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICRsb2cuaW5mbyhcIm5vIHRva2VuIGZvdW5kLCByZWRpcmVjdGluZyB0byAvbG9naW5cIilcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2xvZ2luXCIpO1xuICAgICAgICB9XG4gICAgfSlcbn1dKVxuXG4vLyBIVFRQIGludGVyY2VwdG9yIGluamVjdGVkIGluIGNvbmZpZ1xuYXBwLmZhY3RvcnkoJ25vdEFsbG93ZWRJbnRlcmNlcHRvcicsIFtcIiRsb2dcIiwgXCIkbG9jYWxTdG9yYWdlXCIsIFwiJGxvY2F0aW9uXCIsIFwiJGluamVjdG9yXCIsIFwiJHFcIiwgZnVuY3Rpb24oJGxvZywgJGxvY2FsU3RvcmFnZSwgJGxvY2F0aW9uLCAkaW5qZWN0b3IsICRxKSB7XG4gICAgdmFyIG5vdEFsbG93ZWRJbnRlcmNlcHRvciA9IHtcbiAgICAgICAgLy8gSW50ZXJjZXB0ICRodHRwIGVycm9yc1xuICAgICAgICByZXNwb25zZUVycm9yIDogZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIC8vIENoZWNrIGZvciA0MDEgZXJyb3JcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT0gNDAxKSB7XG4gICAgICAgICAgICAgICAgJGxvZy5lcnJvcignWW91IGFyZSBub3QgYWxsb3dlZCB0byBhY2Nlc3MsIHJlZGlyZWN0aW5nIHRvIC9sb2dpbicpO1xuICAgICAgICAgICAgICAgIC8vIERlbGV0ZSBleGlzaXRpbmcgSldUIGZyb20gbG9jYWxTdG9yYWdlIFxuICAgICAgICAgICAgICAgIGRlbGV0ZSAkbG9jYWxTdG9yYWdlW1widG9rZW5cIl07XG4gICAgICAgICAgICAgICAgLy8gUmVkaXJlY3QgdG8gbG9naW5cbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2xvZ2luJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBSZXR1cm4gcHJvbWlzZSBzbyB3ZSBjYW4gaGFuZGxlIHRoZSBlcnJvciBmdXJ0aGVyXG4gICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KHJlc3BvbnNlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbm90QWxsb3dlZEludGVyY2VwdG9yO1xufV0pXG5cbmFwcC5jb25zdGFudCgnQVVUSF9FVkVOVFMnLCB7XG4gIGxvZ2luU3VjY2VzczogJ2F1dGgtbG9naW4tc3VjY2VzcycsXG4gIGxvZ2luRmFpbGVkOiAnYXV0aC1sb2dpbi1mYWlsZWQnLFxuICBsb2dvdXRTdWNjZXNzOiAnYXV0aC1sb2dvdXQtc3VjY2VzcycsXG4gIHNlc3Npb25UaW1lb3V0OiAnYXV0aC1zZXNzaW9uLXRpbWVvdXQnLFxuICBub3RBdXRoZW50aWNhdGVkOiAnYXV0aC1ub3QtYXV0aGVudGljYXRlZCcsXG4gIG5vdEF1dGhvcml6ZWQ6ICdhdXRoLW5vdC1hdXRob3JpemVkJ1xufSk7XG5cbmFwcC5jb25zdGFudCgnQ0FURUdPUklFUycsIFsgXCJhbnlcIiwgXCJSZWNvbi5TY2FubmluZ1wiLCBcIkF0dGVtcHQuTG9naW5cIiwgXCJBdmFpbGFiaWxpdHkuRG9TXCIgXSk7XG5hcHAuY29uc3RhbnQoJ1BST1RPQ09MUycsIFsgXCJ0Y3BcIiwgXCJkbnNcIiwgXCJ1ZHBcIiBdKTtcbmFwcC5jb25zdGFudCgnVFlQRVMnLCBbXCJiYXJjaGFydFwiLCBcInBpZWNoYXJ0XCIsIFwidG9wXCIsIFwic3VtXCJdKVxuXG5hcHAuY29uc3RhbnQoJ1BJRUNIQVJUJywgeyBcbiAgICBvcHRpb25zOiB7XG4gICAgICAgIGNoYXJ0OiB7XG4gICAgICAgICAgICB0eXBlOiAncGllQ2hhcnQnLFxuICAgICAgICAgICAgaGVpZ2h0OiA0NTAsXG4gICAgICAgICAgICB4OiBmdW5jdGlvbihkKXtyZXR1cm4gZC5rZXlbMF07fSxcbiAgICAgICAgICAgIHk6IGZ1bmN0aW9uKGQpe3JldHVybiBkLng7fSxcbiAgICAgICAgICAgIHNob3dMYWJlbHM6IHRydWUsXG4gICAgICAgICAgICBkb251dCA6IHRydWUsXG4gICAgICAgICAgICBwYWRBbmdsZSA6IDAuMDAsXG4gICAgICAgICAgICBjb3JuZXJSYWRpdXMgOiAxLFxuICAgICAgICAgICAgdHJhbnNpdGlvbkR1cmF0aW9uOiA1MDAsXG4gICAgICAgICAgICBsYWJlbFRocmVzaG9sZDogMCxcbiAgICAgICAgICAgIC8vY29sb3I6IFtcIiMwZWM0ZjRcIiwgXCIjNjMxRkY2XCIsIFwiI0ZGREMwNlwiLCBcIiNGRjg0MDZcIiwgXCIjYjU2OTY5XCIsIFwiI2U2Y2Y4YlwiXSxcbiAgICAgICAgICAgIGxlZ2VuZDoge1xuICAgICAgICAgICAgICAgIG1hcmdpbjoge1xuICAgICAgICAgICAgICAgICAgICB0b3A6IDUsXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0OiAwLFxuICAgICAgICAgICAgICAgICAgICBib3R0b206IDAsXG4gICAgICAgICAgICAgICAgICAgIGxlZnQ6IDBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdG9vbHRpcENvbnRlbnQgOiBmdW5jdGlvbihrZXksIHgsIHksIGUsIGdyYXBoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGtleSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZ3JhcGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ09sYWxhbGEhJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHBpZSA6IHtcbiAgICAgICAgICAgICAgICBkaXNwYXRjaDoge1xuICAgICAgICAgICAgICAgICAgICAvL2NoYXJ0Q2xpY2s6IGZ1bmN0aW9uKGUpIHtjb25zb2xlLmxvZyhlKX0sXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnRDbGljazogZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGUuc2V0VGltZShkYXRlLmdldFRpbWUoKSAtIDEwMDAqNjAqNjAqMjQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZS5zZXRIb3VycygwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGUuc2V0TWludXRlcygwKVxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uID0gJyMvZXZlbnRzP2ZpbHRlciZkYXRlPScgKyBkYXRlLnRvSVNPU3RyaW5nKCkgKyAnJmZyb209JyArIG5ldyBEYXRlKCkuZ2V0SG91cnMoKSArICc6JyArIG5ldyBEYXRlKCkuZ2V0TWludXRlcygpICsgJyZjYXRlZ29yeT0nICsgZS5kYXRhLmtleVswXX0sXG4gICAgICAgICAgICAgICAgICAgIC8vZWxlbWVudERibENsaWNrOiBmdW5jdGlvbihlKSB7Y29uc29sZS5sb2coXCJlbGVtZW50IGRvdWJsZSBjbGlja1wiKX0sXG4gICAgICAgICAgICAgICAgICAgIC8vZWxlbWVudE1vdXNlb3ZlcjogZnVuY3Rpb24oZSkge2NvbnNvbGUubG9nKFwiZWxlbWVudCBtb3VzZW92ZXJcIil9LFxuICAgICAgICAgICAgICAgICAgICAvL2VsZW1lbnRNb3VzZW91dDogZnVuY3Rpb24oZSkge2NvbnNvbGUubG9nKFwiZWxlbWVudCBtb3VzZSBvdXRcIil9ICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBsYWJlbFR5cGUgOiBcInBlcmNlbnRcIixcbiAgICAgICAgICAgICAgICBsYWJlbHNPdXRzaWRlIDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAvL3N0YXJ0QW5nbGUgOiBmdW5jdGlvbihkKSB7IHJldHVybiBkLnN0YXJ0QW5nbGUvMiAtTWF0aC5QSS8yIH0sXG4gICAgICAgICAgICAgICAgLy9lbmRBbmdsZSA6IGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuZW5kQW5nbGUvMiAtTWF0aC5QSS8yIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0pO1xuXG5cbmFwcC5jb25zdGFudCgnQVJFQScsIHtcbiAgICBvcHRpb25zIDoge1xuICAgICAgICBjaGFydDoge1xuICAgICAgICAgICAgdHlwZTogJ211bHRpQmFyQ2hhcnQnLFxuICAgICAgICAgICAgaGVpZ2h0OiA0NTAsXG4gICAgICAgICAgICBtYXJnaW4gOiB7XG4gICAgICAgICAgICAgICAgdG9wOiAzMCxcbiAgICAgICAgICAgICAgICByaWdodDogMjAsXG4gICAgICAgICAgICAgICAgYm90dG9tOiAxMDAsXG4gICAgICAgICAgICAgICAgbGVmdDogNTBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB4OiBmdW5jdGlvbihkKSB7IHJldHVybiBkLnggfSxcbiAgICAgICAgICAgIHk6IGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuQ291bnQgfSxcbiAgICAgICAgICAgIHVzZVZvcm9ub2k6IGZhbHNlLFxuICAgICAgICAgICAgY2xpcEVkZ2U6IHRydWUsXG4gICAgICAgICAgICBkdXJhdGlvbjogMTAwLFxuICAgICAgICAgICAgdXNlSW50ZXJhY3RpdmVHdWlkZWxpbmU6IHRydWUsXG4gICAgICAgICAgICB4QXhpczoge1xuICAgICAgICAgICAgICAgIHNob3dNYXhNaW46IGZhbHNlLFxuICAgICAgICAgICAgICAgIHRpY2tGb3JtYXQ6IGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQzLnRpbWUuZm9ybWF0KCclbS8lZCAlSDolTScpKG5ldyBEYXRlKGQpKVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcm90YXRlTGFiZWxzIDogLTQ1LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHlBeGlzOiB7XG4gICAgICAgICAgICAgICAgdGlja0Zvcm1hdDogZnVuY3Rpb24oZCl7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkMy5mb3JtYXQoJywuMGYnKShkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgem9vbToge1xuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgLy9zY2FsZUV4dGVudDogWzEsIDEwXSxcbiAgICAgICAgICAgICAgICB1c2VGaXhlZERvbWFpbjogZmFsc2UsXG4gICAgICAgICAgICAgICAgdXNlTmljZVNjYWxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBob3Jpem9udGFsT2ZmOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB2ZXJ0aWNhbE9mZjogdHJ1ZSxcbiAgICAgICAgICAgICAgICB1bnpvb21FdmVudFR5cGU6ICdkYmxjbGljay56b29tJ1xuICAgICAgICAgICAgfSwgXG4gICAgICAgICAgICBkaXNwYXRjaDoge1xuICAgICAgICAgICAgICAgIHN0YXRlQ2hhbmdlOiBmdW5jdGlvbihlKXsgY29uc29sZS5sb2coXCJzdGF0ZUNoYW5nZVwiKTsgfSxcbiAgICAgICAgICAgICAgICBjaGFuZ2VTdGF0ZTogZnVuY3Rpb24oZSl7IGNvbnNvbGUubG9nKFwiY2hhbmdlU3RhdGVcIik7IH0sXG4gICAgICAgICAgICAgICAgdG9vbHRpcFNob3c6IGZ1bmN0aW9uKGUpeyBjb25zb2xlLmxvZyhcInRvb2x0aXBTaG93XCIpOyB9LFxuICAgICAgICAgICAgICAgIHRvb2x0aXBIaWRlOiBmdW5jdGlvbihlKXsgY29uc29sZS5sb2coXCJ0b29sdGlwSGlkZVwiKTsgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG11bHRpYmFyOiB7XG4gICAgICAgICAgICAgICAgZGlzcGF0Y2ggOiB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnRDbGljazogZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZShlLmRhdGEueCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRlKVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhvdXJzID0gZGF0ZS5nZXRIb3VycygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1pbnV0ZXMgPSBkYXRlLmdldE1pbnV0ZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGUuc2V0SG91cnMoMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlLnNldE1pbnV0ZXMoMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24gPSAnIy9ldmVudHM/ZmlsdGVyJmRhdGU9JyArIGRhdGUudG9JU09TdHJpbmcoKSArICcmZnJvbT0nICsgKFwiMFwiICsgaG91cnMpLnNsaWNlKC0yKSArICc6JyArIChcIjBcIiArIG1pbnV0ZXMpLnNsaWNlKC0yKSArICcmY2F0ZWdvcnk9JyArIGUuZGF0YS5rZXk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGUuZGF0YS5rZXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhlLmRhdGEueCk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuXG5cbmFwcC5jb25zdGFudChcIk1FTlVcIiwgW1xuXHR7XG5cdFx0XCJ0aXRsZVwiIDogXCJEYXNoYm9hcmRcIixcbiAgICAgICAgXCJsaW5rXCIgOiBcIiMvXCJcblx0XHQvKlwiaXRlbXNcIiA6IFtcblx0XHRcdHtcblx0XHRcdFx0XCJ0aXRsZVwiIDogXCJVc2Vyc1wiLFxuXHRcdFx0XHRcImxpbmtcIlx0OiBcInVzZXJcIlxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0XCJ0aXRsZVwiIDogXCJNeSBwcm9maWxlXCJcblx0XHRcdH1cblx0XHRdKi9cblx0fSxcblx0e1xuXHRcdFwidGl0bGVcIiA6IFwiRXZlbnRzXCIsXG5cdFx0XCJsaW5rXCIgXHQ6IFwiIy9ldmVudHNcIlxuXHR9LFxuXHQvKntcblx0XHRcInRpdGxlXCIgOiBcIkFuYWx5dGljczIzXCIsXG5cdFx0XCJpdGVtc1wiIDogW1xuXHRcdFx0e1xuXHRcdFx0XHRcInRpdGxlXCIgOiBcIlVzZXJzXCIsXG5cdFx0XHRcdFwibGlua1wiIFx0OiBcInNldHRpbmdzXCJcblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdFwidGl0bGVcIiA6IFwiTXkgcHJvZmlsZVwiLFxuXHRcdFx0XHRcImxpbmtcIlx0OiBcInByb2ZpbGVcIlxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0XCJ0aXRsZVwiIDogXCJNeSBwcm9maWxlXCIsXG5cdFx0XHRcdFwibGlua1wiXHQ6IFwicHJvZmlsZVwiXG5cdFx0XHR9XG5cdFx0XVxuXG5cdH0sXG5cdHtcblx0XHRcInRpdGxlXCIgOiBcIkFuYWx5dGljczEyM1wiLFxuXHRcdFwibGlua1wiIFx0OiBcImxvZ2luXCJcblx0fSwqL1xuXHR7XG5cdFx0XCJ0aXRsZVwiIDogXCJTZXR0aW5nc1wiLFxuXHRcdFwiaXRlbXNcIiA6IFtcbiAgICAgICAgICAgIHtcblx0XHRcdFx0XCJ0aXRsZVwiIDogXCJNeSBwcm9maWxlXCIsXG5cdFx0XHRcdFwibGlua1wiXHQ6IFwiIy9wcm9maWxlXCJcblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdFwidGl0bGVcIiA6IFwiVXNlcnNcIixcblx0XHRcdFx0XCJsaW5rXCIgXHQ6IFwiL3NldHRpbmdzXCJcblx0XHRcdH0sXG5cdFx0XVxuXHR9XG5dKTtcblxuYXBwLnNlcnZpY2UoJ2FwaScsIFtcIiRodHRwXCIsIFwiJGxvZ1wiLCBcIiRtZFRvYXN0XCIsIFwiJGxvY2FsU3RvcmFnZVwiLCBcIlBJRUNIQVJUXCIsIFwiQ09ORklHXCIsIGZ1bmN0aW9uKCRodHRwLCAkbG9nLCAkbWRUb2FzdCwgJGxvY2FsU3RvcmFnZSwgUElFQ0hBUlQsIENPTkZJRykge1xuXG5cdHZhciBhZGRyID0gQ09ORklHW1wiaG9zdFwiXSArIFwiOlwiICsgQ09ORklHW1wicG9ydFwiXSArIFwiL1wiICsgQ09ORklHW1widmVyc2lvblwiXSArIFwiL2V2ZW50cy9cIjtcblxuICAgIHRoaXMuYXV0aCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gJGxvY2FsU3RvcmFnZVtcInRva2VuXCJdO1xuICAgIH1cblxuICAgIHRoaXMuY29uZmlnID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICRodHRwLmdldCgnaHR0cDovL2JlbmVmaXppby5saWJlcm91dGVyLm9yZzo1NTU1L2NvbmZpZycpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgdGhpcy5hZGRyID0gZGF0YS5ob3N0ICsgJzonICsgZGF0YS5wb3J0ICsgZGF0YS5ldmVudHM7XG4gICAgICAgICAgICAkbG9jYWxTdG9yYWdlWydjb25maWcnXSA9IGRhdGE7XG4gICAgICAgICAgICBhbGVydChkYXRhKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgdGhpcy5nZXQgPSBmdW5jdGlvbih1cmwsIHBhcmFtcywgaW5mbykge1xuXHRcdHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICB1cmwgOiBhZGRyICsgdXJsLFxuICAgICAgICAgICAgbWV0aG9kIDogXCJHRVRcIixcbiAgICAgICAgICAgIHBhcmFtcyA6IHBhcmFtcyxcbiAgICAgICAgICAgIGhlYWRlcnMgOiB7XG4gICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nIDogdGhpcy5hdXRoKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgaWYgKGluZm8gIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgJG1kVG9hc3Quc2hvdyhcbiAgICAgICAgICAgICAgICAgICAgJG1kVG9hc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zaW1wbGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRleHRDb250ZW50KCdEYXRhIHN1Y2Nlc3N1bGx5IGxvYWRlZCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAucG9zaXRpb24oXCJ0b3AgcmlnaHRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoMzAwMClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVtZShcInN1Y2Nlc3MtdG9hc3RcIilcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgfSlcbiAgICAgICAgLmVycm9yKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJGxvZy5lcnJvcignQ2Fubm90IGZldGNoIGRhdGEnKTtcbiAgICAgICAgICAgICRtZFRvYXN0LnNob3coXG4gICAgICAgICAgICAgICAgJG1kVG9hc3Quc2ltcGxlKClcbiAgICAgICAgICAgICAgICAgICAgLnRleHRDb250ZW50KCdTb21ldGhpbmcgd2VudCB3cm9uZycpXG4gICAgICAgICAgICAgICAgICAgIC5wb3NpdGlvbihcInRvcCByaWdodFwiKVxuICAgICAgICAgICAgICAgICAgICAuaGlkZURlbGF5KDMwMDApXG4gICAgICAgICAgICAgICAgICAgIC50aGVtZShcImVycm9yLXRvYXN0XCIpXG4gICAgICAgICAgICApO1xuXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHRoaXMucG9zdCA9IGZ1bmN0aW9uKHVybCwgZGF0YSwgaW5mbykge1xuICAgICAgICByZXR1cm4gJGh0dHAucG9zdChhZGRyICsgdXJsLCBKU09OLnN0cmluZ2lmeShkYXRhKSlcbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBpZiAoaW5mbykge1xuICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxuICAgICAgICAgICAgICAgICAgICAgICAgJG1kVG9hc3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2ltcGxlKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQoJ0RhdGEgc3VjY2Vzc2Z1bGx5IGxvYWRlZCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnBvc2l0aW9uKFwidG9wIHJpZ2h0XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmhpZGVEZWxheSgzMDAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVtZShcInN1Y2Nlc3MtdG9hc3RcIilcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7ICAgICAgICBcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcdCRsb2cuZXJyb3IoJ0Nhbm5vdCBmZXRjaCBkYXRhJyk7XG4gICAgICAgICAgICAgICAgJG1kVG9hc3Quc2hvdyhcbiAgICAgICAgICAgICAgICAgICAgJG1kVG9hc3Quc2ltcGxlKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0Q29udGVudCgnU29tZXRoaW5nIHdlbnQgd3JvbmcnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnBvc2l0aW9uKFwidG9wIHJpZ2h0XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuaGlkZURlbGF5KDMwMDApXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbWUoXCJlcnJvci10b2FzdFwiKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KVxuICAgIH1cblxuICAgIHRoaXMucHV0ID0gZnVuY3Rpb24odXJsLCBkYXRhLCBpbmZvKSB7XG4gICAgICAgIHJldHVybiAkaHR0cC5wdXQoYWRkciArIHVybCwgSlNPTi5zdHJpbmdpZnkoZGF0YSkpXG4gICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKGluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgJG1kVG9hc3Quc2hvdyhcbiAgICAgICAgICAgICAgICAgICAgICAgICRtZFRvYXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNpbXBsZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRleHRDb250ZW50KCdEYXRhIHN1Y2Nlc3NmdWxseSBsb2FkZWQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5wb3NpdGlvbihcInRvcCByaWdodFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoMzAwMClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbWUoXCJzdWNjZXNzLXRvYXN0XCIpXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhOyAgICAgICAgXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgXHQkbG9nLmVycm9yKCdDYW5ub3QgZmV0Y2ggZGF0YScpO1xuICAgICAgICAgICAgICAgICRtZFRvYXN0LnNob3coXG4gICAgICAgICAgICAgICAgICAgICRtZFRvYXN0LnNpbXBsZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQoJ1NvbWV0aGluZyB3ZW50IHdyb25nJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wb3NpdGlvbihcInRvcCByaWdodFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmhpZGVEZWxheSgzMDAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW1lKFwiZXJyb3ItdG9hc3RcIilcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSlcbiAgICB9XG5cblxufV0pO1xuXG5cblxuYXBwLmZhY3RvcnkoJ21lbnUnLCBbJyRodHRwJywgZnVuY3Rpb24oJGh0dHApIHtcblx0cmV0dXJuICRodHRwLmdldCgnanNvbi9tZW51Lmpzb24nKVxuXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRcdHJldHVybiBkYXRhO1xuXHRcdH0pO1xuXHQvL1x0LmVycm9yKGNvbnNvbGUubG9nKCdDYW5ub3QgcmV0cmlldmUgZGF0YScpKTtcbn1dKTtcblxuYXBwLmZhY3RvcnkoJ2pzb25kYXRhJywgWyckaHR0cCcsIGZ1bmN0aW9uKCRodHRwKSB7XG5cdHJldHVybiAkaHR0cC5nZXQoJ2pzb24vdGVzdGZpbGVfMTAwLmpzb24nKVxuXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRcdHJldHVybiBkYXRhO1xuXHRcdH0pO1xuXHQvL1x0LmVycm9yKGNvbnNvbGUubG9nKCdDYW5ub3QgcmV0cmlldmUgZGF0YScpKTtcbn1dKTtcblxuYXBwLmRpcmVjdGl2ZShcInNpZGViYXJNZW51XCIsIGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4ge1xuICAgICAgICBzY29wZToge1xuXHRcdFx0c2VjdGlvbjogJz0nXG5cdFx0fSxcblx0XHR0ZW1wbGF0ZVVybDogJ3BhcnRpYWxzL3NpZGViYXItbWVudS5odG1sJyxcbiAgICAgICAgY29udHJvbGxlcjogW1wiJHNjb3BlXCIsIFwiJG1kU2lkZW5hdlwiLCBcIiRsb2NhdGlvblwiLCBcIk1FTlVcIiwgXCJ1c2VyXCIsIGZ1bmN0aW9uKCRzY29wZSwgJG1kU2lkZW5hdiwgJGxvY2F0aW9uLCBNRU5VLCB1c2VyKSB7XG4gICAgICAgICAgICAkc2NvcGUubWVudSA9IE1FTlU7XG5cbiAgICAgICAgICAgICRzY29wZS5pc0FjdGl2ZSA9IGZ1bmN0aW9uKGN1cnJlbnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4oJGxvY2F0aW9uLnBhdGgoKSA9PSBjdXJyZW50KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJHNjb3BlLmNoYW5nZU1vZGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuJGVtaXQoJ3JlcUNoYW5nZU1vZGUnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJHNjb3BlLmVuYWJsZSA9IHRydWU7XG5cbiAgICAgICAgICAgICRzY29wZS50b2dnbGVJdGVtID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZUJ0biA9IFwidG9nZ2xlZFwiO1xuICAgICAgICAgICAgfTtcblxuXG4gICAgICAgICAgICAkc2NvcGUuY2xvc2VMZWZ0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJG1kU2lkZW5hdignbGVmdCcpLnRvZ2dsZSgpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgJHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHVzZXIubG9nb3V0KCk7XG4gICAgICAgICAgICB9XG4gICAgXG4gXG4gICAgICAgIH1dXG5cdH07XG59KTtcblxuYXBwLmRpcmVjdGl2ZShcInRvcGJhck1lbnVcIiwgZnVuY3Rpb24oKSB7XG5cdHJldHVybiB7XG5cdFx0c2NvcGU6IHtcblx0XHRcdHNlY3Rpb246ICc9J1xuXHRcdH0sXG5cdFx0dGVtcGxhdGVVcmw6ICdwYXJ0aWFscy90b3BiYXItbWVudS5odG1sJyxcbiAgICAgICAgY29udHJvbGxlciA6IFtcIiRzY29wZVwiLCBcIiRtZFNpZGVuYXZcIiwgZnVuY3Rpb24oJHNjb3BlLCAkbWRTaWRlbmF2KSB7XG4gICAgICAgICAgICAkc2NvcGUudG9nZ2xlTGVmdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICRtZFNpZGVuYXYoJ2xlZnQnKS50b2dnbGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfV1cblx0fTtcbn0pO1xuXG5cbmFwcC5jb250cm9sbGVyKCd0b3BCYXInLCB0b3BCYXJDdHJsKTtcblxuZnVuY3Rpb24gdG9wQmFyQ3RybCgkbWREaWFsb2csICRsb2NhdGlvbiwgJG1kU2lkZW5hdil7XG4gICAgdGhpcy50b2dnbGVMZWZ0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICRtZFNpZGVuYXYoJ2xlZnQnKS50b2dnbGUoKTtcbiAgICB9O1xufTtcblxuYXBwLmRpcmVjdGl2ZShcImJveGVzXCIsIGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4ge1xuXHRcdHNjb3BlOiB7XG5cdFx0XHRzZWN0aW9uOiAnPSdcblx0XHR9LFxuXHRcdHRlbXBsYXRlVXJsOiAncGFydGlhbHMvYm94ZXMuaHRtbCdcblx0fTtcbn0pO1xuXG5cbmFwcC5kaXJlY3RpdmUoJ2NsaWNrRWRpdCcsIGZ1bmN0aW9uKCkge1xuXHR2YXIgdGVtcGxhdGUgPSAnPGRpdj48aDIgbmctc2hvdz1cInZpZXcuc2hvd1RpdGxlXCIgbmctY2xpY2s9XCJlZGl0VGl0bGUoKVwiPnt7Ym94LnRpdGxlfX08L2gyPicgK1xuXHRcdFx0XHQnPG1kLWlucHV0LWNvbnRhaW5lciBuZy1oaWRlPVwic2hvd1RpdGxlXCI+JyArXG5cdFx0XHRcdFx0JzxpbnB1dCB0eXBlPVwidGV4dFwiIHZhbHVlPVwie3tib3gudGl0bGV9fVwiIG5nLWJsdXI9XCJlZGl0VGl0bGUoYm94LnRpdGxlKVwiIG5nLW1vZGVsPVwiYm94LnRpdGxlXCIgY2xhc3M9XCJmb2N1c1RpdGxlXCIgYXJpYS1sYWJlbD1cIkVkaXQgVGl0bGVcIj4nICtcblx0XHRcdFx0JzwvbWQtaW5wdXQtY29udGFpbmVyPjwvZGl2Pic7XG5cblx0cmV0dXJuIHtcblx0XHRyZXN0cmljdCBcdDogXCJBXCIsXG5cdFx0cmVwbGFjZVx0XHQ6IHRydWUsXG5cdFx0dGVtcGxhdGUgXHQ6IHRlbXBsYXRlLFxuXHRcdHNjb3BlXHRcdDoge1xuXHRcdFx0dmFsdWU6IFwiPWNsaWNrRWRpdFwiXG5cdFx0fSxcblx0XHRjb250cm9sbGVyXHQ6IFtcIiRzY29wZVwiLCBcImlucHV0VGV4dFwiLCBcIiR0aW1lb3V0XCIsIGZ1bmN0aW9uKCRzY29wZSwgaW5wdXRUZXh0LCAkdGltZW91dCkge1xuXHRcdFx0JHNjb3BlLnZpZXcuc2hvd1RpdGxlID0gdHJ1ZTtcblxuXHRcdFx0aWYgKCRzY29wZS5zaG93VGl0bGUgPSB0cnVlKSB7XG5cdFx0ICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0ICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJy5mb2N1c1RpdGxlJykudHJpZ2dlcignZm9jdXMnKTtcblx0XHQgICAgICAgIGNvbnNvbGUubG9nKFwidHJpZ2dlclwiKTtcblx0XHQgICAgICB9LCAxMDApO1xuXHRcdCAgICB9O1xuXG5cdFx0ICAgICRzY29wZS5lZGl0VGl0bGUgPSBmdW5jdGlvbigpIHtcblx0XHQgICAgXHQkc2NvcGUudmlldy5zaG93VGl0bGUgPSAhJHNjb3BlLnZpZXcuc2hvd1RpdGxlO1xuXHRcdCAgICB9O1xuXHRcdH1dXG5cdH07XG59KTtcblxuYXBwLmRpcmVjdGl2ZShcImNsaWNrVG9FZGl0XCIsIGZ1bmN0aW9uKCkge1xuICAgIHZhciBlZGl0b3JUZW1wbGF0ZSA9ICc8ZGl2IGNsYXNzPVwiY2xpY2stdG8tZWRpdFwiPicgK1xuICAgICAgICAnPGRpdiBuZy1oaWRlPVwidmlldy5lZGl0b3JFbmFibGVkXCIgbmctY2xpY2s9XCJlbmFibGVFZGl0b3IoKVwiPicgK1xuICAgICAgICAgICAgJzxhIG5nLWNsaWNrPVwiZW5hYmxlRWRpdG9yKClcIj48bWQtaWNvbiBtZC1zdmctc3JjPVwiaW1nL2ljb25zL2VkaXQuc3ZnXCI+PC9tZC1pY29uPjwvYT4nICtcbiAgICAgICAgICAgICd7e3ZhbHVlfX0gJyArXG4gICAgICAgICc8L2Rpdj4nICtcbiAgICAgICAgJzxtZC1pbnB1dC1jb250YWluZXIgbmctc2hvdz1cInZpZXcuZWRpdG9yRW5hYmxlZFwiPicgK1xuXHQgICAgICAgICc8ZGl2PicgK1xuXHQgICAgICAgICAgICAnPGlucHV0IG5nLW1vZGVsPVwidmlldy5lZGl0YWJsZVZhbHVlXCIgY2xhc3M9XCJmb2N1c1RpdGxlXCIgYXJpYS1sYWJlbD1cIlRpdGxlXCI+JyArXG5cdCAgICAgICAgICAgICc8c3BhbiBuZy1jbGljaz1cInNhdmUoKVwiPlNhdmU8L3NwYW4+JyArXG5cdCAgICAgICAgICAgICcgb3IgJyArXG5cdCAgICAgICAgICAgICc8YSBuZy1jbGljaz1cImRpc2FibGVFZGl0b3IoKVwiPmNhbmNlbDwvYT4uJyArXG5cdCAgICAgICAgJzwvZGl2PicgK1xuXHQgICAgJzwvbWQtaW5wdXQtY29udGFpbmVyPicgK1xuICAgICc8L2Rpdj4nO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6IFwiQVwiLFxuICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICB0ZW1wbGF0ZTogZWRpdG9yVGVtcGxhdGUsXG4gICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICB2YWx1ZTogXCI9Y2xpY2tUb0VkaXRcIixcbiAgICAgICAgfSxcbiAgICAgICAgY29udHJvbGxlcjogW1wiJHNjb3BlXCIsIFwiJHRpbWVvdXRcIiwgZnVuY3Rpb24oJHNjb3BlLCAkdGltZW91dCkge1xuICAgICAgICAgICAgJHNjb3BlLnZpZXcgPSB7XG4gICAgICAgICAgICAgICAgZWRpdGFibGVWYWx1ZTogJHNjb3BlLnZhbHVlLFxuICAgICAgICAgICAgICAgIGVkaXRvckVuYWJsZWQ6IGZhbHNlXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAkc2NvcGUuZW5hYmxlRWRpdG9yID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnZpZXcuZWRpdG9yRW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnZpZXcuZWRpdGFibGVWYWx1ZSA9ICRzY29wZS52YWx1ZTtcblxuICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdCAgICAgICAgYW5ndWxhci5lbGVtZW50KCcuZm9jdXNUaXRsZScpLnRyaWdnZXIoJ2ZvY3VzJyk7XG5cdFx0ICAgICAgICBjb25zb2xlLmxvZyhcInRyaWdnZXJcIik7XG5cdFx0ICAgICAgfSwgMTAwKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICRzY29wZS5kaXNhYmxlRWRpdG9yID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnZpZXcuZWRpdG9yRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUudmFsdWUgPSAkc2NvcGUudmlldy5lZGl0YWJsZVZhbHVlO1xuICAgICAgICAgICAgICAgICRzY29wZS5kaXNhYmxlRWRpdG9yKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XVxuICAgIH07XG59KTtcblxuYXBwLnNlcnZpY2UoJ3VzZXInLCBbXCIkbG9jYWxTdG9yYWdlXCIsIFwiJGh0dHBcIiwgXCIkbWRUb2FzdFwiLCBcIiRsb2NhdGlvblwiLCBcIkNPTkZJR1wiLCBmdW5jdGlvbigkbG9jYWxTdG9yYWdlLCAkaHR0cCwgJG1kVG9hc3QsICRsb2NhdGlvbiwgQ09ORklHKXtcbiAgICB2YXIgY2FjaGUgPSBudWxsO1xuXG4gICAgdmFyIGRhc2hib2FyZCA9IFtdO1xuXG5cdHZhciBhZGRyID0gQ09ORklHW1wiaG9zdFwiXSArIFwiOlwiICsgQ09ORklHW1wicG9ydFwiXSArIFwiL1wiICsgQ09ORklHW1widmVyc2lvblwiXSArIFwiL3VzZXJzL1wiO1xuXG4gICAgdGhpcy5jb25maWcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICRsb2NhbFN0b3JhZ2VbXCJkYXNoYm9hcmRcIl07XG4gICAgfVxuXG4gICAgdGhpcy5qd3QgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICRsb2NhbFN0b3JhZ2VbXCJqd3RcIl07XG4gICAgfVxuXG4gICAgdGhpcy5hdXRoID0gZnVuY3Rpb24odXNlcikge1xuICAgICAgICByZXR1cm4gJGh0dHAucG9zdChhZGRyICsgXCJhdXRoXCIsIGFuZ3VsYXIudG9Kc29uKHVzZXIpKVxuICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAkbG9jYWxTdG9yYWdlW1widG9rZW5cIl0gPSBkYXRhW1wiand0XCJdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBUT0RPOiBkaWZmZXJlbnRpYXRlIGJldHdlZW4gY29uZmlnIGFuZCBqd3QgPj4gZHVwbGljaXR5XG4gICAgICAgICAgICBkZWxldGUgJGxvY2FsU3RvcmFnZVtcImRhc2hib2FyZFwiXTtcbiAgICAgICAgICAgICRsb2NhbFN0b3JhZ2VbXCJkYXNoYm9hcmRcIl0gPSBkYXRhW1wic2V0dGluZ3NcIl07XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0pXG4gICAgICAgIC5lcnJvcihmdW5jdGlvbihlcnJvciwgc3RhdHVzKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzdGF0dXMpXG4gICAgICAgICAgICAvLyBMZXQgaXQgYmUgaGFuZGxlZCBieSBjb250cm9sbGVyXG4gICAgICAgICAgICByZXR1cm4gZXJyb3I7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgdGhpcy5wdXQgPSBmdW5jdGlvbihkYXRhLCBpbmZvKSB7XG4gICAgICAgIHJldHVybiAkaHR0cCh7XG4gICAgICAgICAgICB1cmwgOiBhZGRyLCBcbiAgICAgICAgICAgIG1ldGhvZCA6IFwiUFVUXCIsXG4gICAgICAgICAgICBkYXRhIDogYW5ndWxhci50b0pzb24oZGF0YSksXG4gICAgICAgICAgICBoZWFkZXJzIDoge1xuICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJyA6ICRsb2NhbFN0b3JhZ2VbXCJ0b2tlblwiXVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBpZiAoaW5mbykge1xuICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxuICAgICAgICAgICAgICAgICAgICAgICAgJG1kVG9hc3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2ltcGxlKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQoJ1VzZXIgc2V0dGluZ3MgdXBkYXRlZCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnBvc2l0aW9uKFwidG9wIHJpZ2h0XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmhpZGVEZWxheSgzMDAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVtZShcInN1Y2Nlc3MtdG9hc3RcIilcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7ICAgICAgICBcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24obXNnLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIFx0JGxvZy5lcnJvcignU29tZXRoaW5nIHdlbnQgd3Jvbmcgc2VuZGluZyB1c2VyIGRhdGEnKTtcbiAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxuICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaW1wbGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRleHRDb250ZW50KCdTb21ldGhpbmcgd2VudCB3cm9uZycpXG4gICAgICAgICAgICAgICAgICAgICAgICAucG9zaXRpb24oXCJ0b3AgcmlnaHRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoMzAwMClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVtZShcImVycm9yLXRvYXN0XCIpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pXG4gICAgfVxuICAgIFxuICAgIC8vIExvZ291dCB1c2VyXG4gICAgLy8gUmVtb3ZlIEpXVCBmcm9tIGxvY2FsU3RvcmFnZSBhbmQgZGVsZXRlIHNlc3Npb24gb24gc2VydmVyXG4gICAgdGhpcy5sb2dvdXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHVzZXIgPSAkbG9jYWxTdG9yYWdlW1widG9rZW5cIl07XG5cbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIHVybCA6IGFkZHIgKyBcImxvZ291dFwiLFxuICAgICAgICAgICAgbWV0aG9kIDogXCJERUxFVEVcIixcbiAgICAgICAgICAgIGhlYWRlcnMgOiB7XG4gICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nIDogJGxvY2FsU3RvcmFnZVtcInRva2VuXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9sb2dpblwiKTtcbiAgICAgICAgICAgICAgICBkZWxldGUgJGxvY2FsU3RvcmFnZVtcInRva2VuXCJdO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSAkbG9jYWxTdG9yYWdlW1wiZGFzaGJvYXJkXCJdO1xuICAgICAgICAgICAgICAgICRtZFRvYXN0LnNob3coXG4gICAgICAgICAgICAgICAgICAgICRtZFRvYXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAuc2ltcGxlKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0Q29udGVudCgnTG9nb3V0IHN1Y2Nlc3NmdWxsJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wb3NpdGlvbihcInRvcCByaWdodFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmhpZGVEZWxheSgzMDAwKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgcmV0dXJuOyAgICAgICAgXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGVycm9yLCBtc2cpIHtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9sb2dpblwiKTtcbiAgICAgICAgICAgICAgICBkZWxldGUgJGxvY2FsU3RvcmFnZVtcInRva2VuXCJdO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSAkbG9jYWxTdG9yYWdlW1wiZGFzaGJvYXJkXCJdO1xuICAgICAgICAgICAgICAgICRtZFRvYXN0LnNob3coXG4gICAgICAgICAgICAgICAgICAgICRtZFRvYXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAuc2ltcGxlKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0Q29udGVudCgnTG9nb3V0IGZhaWxlZCBvbiBzZXJ2ZXIgc2lkZSwgYnV0IHlvdSBhcmUgbG9nZ2VkIG91dCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAucG9zaXRpb24oXCJ0b3AgcmlnaHRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoMzAwMClcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG59XSk7XG5cbmFwcC5jb250cm9sbGVyKCdldmVudENvbnRyb2xsZXInLCBbXCIkc2NvcGVcIiwgXCIkcm91dGVQYXJhbXNcIiwgXCIkaHR0cFwiLCBcImFwaVwiLCBmdW5jdGlvbigkc2NvcGUsICRyb3V0ZVBhcmFtcywgJGh0dHAsIGFwaSkge1xuXG4gICAgICAgICRzY29wZS5pZCA9ICRyb3V0ZVBhcmFtcztcblxuICAgICAgICAkc2NvcGUuZ2VvID0gW107XG5cbiAgICAgICAgJHNjb3BlLmJhY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHdpbmRvdy5oaXN0b3J5LmJhY2soKVxuICAgICAgICB9XG5cbiAgICAgICAgYXBpLmdldCgnaWQvJyArICRyb3V0ZVBhcmFtc1snaWQnXSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YSA9IGRhdGE7XG5cbiAgICAgICAgICAgIC8vdmFyIGJvdW5kcyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmdCb3VuZHMoKTtcblxuICAgICAgICAgICAgaWYgKCgkc2NvcGUuZGF0YS5Tb3VyY2UgIT0gdW5kZWZpbmVkICYmICRzY29wZS5kYXRhLlRhcmdldCAhPSB1bmRlZmluZWQpICYmIFxuICAgICAgICAgICAgICAgICgkc2NvcGUuZGF0YS5Tb3VyY2VbMF0uSVA0ICYmICRzY29wZS5kYXRhLlRhcmdldFswXS5JUDQpKSB7XG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KCdodHRwOi8vZnJlZWdlb2lwLm5ldC9qc29uLycgKyAkc2NvcGUuZGF0YS5UYXJnZXRbMF0uSVA0WzBdKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGRhdGFbJ3R5cGUnXSA9IFwiVGFyZ2V0XCI7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nZW8ucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgLy92YXIgbGF0bG5nID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhkYXRhLmxhdGl0dWRlLCBkYXRhLmxvbmdpdHVkZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vYm91bmRzLmV4dGVuZChsYXRsbmcpO1xuXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQoJ2h0dHA6Ly9mcmVlZ2VvaXAubmV0L2pzb24vJyArICRzY29wZS5kYXRhLlNvdXJjZVswXS5JUDRbMF0pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBkYXRhWyd0eXBlJ10gPSBcIlNvdXJjZVwiO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2VvLnB1c2goZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIC8vdmFyIGxhdGxuZyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoZGF0YS5sYXRpdHVkZSwgZGF0YS5sb25naXR1ZGUpO1xuICAgICAgICAgICAgICAgICAgICAvL2JvdW5kcy5leHRlbmQobGF0bG5nKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoJHNjb3BlLmRhdGEuU291cmNlID09IHVuZGVmaW5lZCB8fCAkc2NvcGUuZGF0YS5Tb3VyY2VbMF0uSVA0ID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICRodHRwLmdldCgnaHR0cDovL2ZyZWVnZW9pcC5uZXQvanNvbi8nICsgJHNjb3BlLmRhdGEuVGFyZ2V0WzBdLklQNFswXSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGFbJ3R5cGUnXSA9IFwiVGFyZ2V0XCI7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nZW8ucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQoJ2h0dHA6Ly9mcmVlZ2VvaXAubmV0L2pzb24vJyArICRzY29wZS5kYXRhLlNvdXJjZVswXS5JUDRbMF0pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBkYXRhWyd0eXBlJ10gPSBcIlNvdXJjZVwiO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2VvLnB1c2goZGF0YSk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgXG5cbn1dKTtcblxuYXBwLmZpbHRlcignanNvbjJodG1sJywgW1wiJHNjZVwiLCBcIiRmaWx0ZXJcIiwgZnVuY3Rpb24oJHNjZSwgJGZpbHRlcikge1xuICAgIHJldHVybiBmdW5jdGlvbihpbnB1dCkge1xuICAgICAgICB2YXIgaHRtbCA9IFwiXCJcbiAgICAgICAgYW5ndWxhci5mb3JFYWNoKGlucHV0LCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgICAgICAgICBodG1sID0gaHRtbCArIFwiPGRpdj5cIjtcblxuICAgICAgICAgICAgLy8gVGhlIHR1cGxlIGlzIG5lc3RlZFxuICAgICAgICAgICAgaWYgKCh0eXBlb2YgdmFsdWUpID09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgaWYgKCh0eXBlb2Yga2V5KSAhPSAnbnVtYmVyJyAmJiBrZXkgIT0gXCIkZGF0ZVwiKVxuICAgICAgICAgICAgICAgICAgICBodG1sID0gaHRtbCArIFwiPGVtPlwiICsga2V5ICsgXCI8L2VtPjogXCI7XG4gICAgICAgICAgICAgICAgaHRtbCA9IGh0bWwgKyBcIjxkaXYgY2xhc3M9XFxcInN1YlxcXCI+XCIgKyAkZmlsdGVyKCdqc29uMmh0bWwnKSh2YWx1ZSkgKyBcIjwvZGl2PlwiO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoKHR5cGVvZiBrZXkgIT0gJ251bWJlcicpICYmIGtleSAhPSBcIiRkYXRlXCIpXG4gICAgICAgICAgICAgICAgICAgIGh0bWwgPSBodG1sICsgXCI8ZW0+XCIgKyBrZXkgKyBcIjwvZW0+OiBcIjtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBpdCBpcyBkYXRlIChJIGtub3csIGl0IGlzIHNvb29vbyBkaXJ0eSlcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgPiAxMDAwMDAwMDAwMDAwKVxuICAgICAgICAgICAgICAgICAgICBodG1sID0gaHRtbCArIFwiPHNwYW4+XCIgKyAkZmlsdGVyKCdkYXRlJykodmFsdWUsJ3l5eXkvTU0vZGQgSDptbTpzcycpICsgXCI8L3NwYW4+XCI7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBodG1sID0gaHRtbCArIFwiPHNwYW4+XCIgKyB2YWx1ZSArIFwiPC9zcGFuPlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaHRtbCA9IGh0bWwgKyBcIjwvZGl2PlwiO1xuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gJHNjZS50cnVzdEFzKCdodG1sJywgaHRtbCk7XG4gICAgfSAgICAgXG59XSk7XG5cbi8vIEZpbHRlciB0byBjb252ZXJ0IElERUEgZm9ybWF0IGZyb20gTW9uZ29EQiB0byBzdGFuZGFyZGl6ZWQgSURFQSBmb3JtYXRcbmFwcC5maWx0ZXIoJ2lkZWEnLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oaW5wdXQpIHtcbiAgICAgICAgdmFyIHJlcyA9IHt9O1xuXG4gICAgICAgIGFuZ3VsYXIuZm9yRWFjaChpbnB1dCwgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAgICAgICAgaWYgKGtleSAhPSAnX2lkJykge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZVsnJGRhdGUnXSkge1xuICAgICAgICAgICAgICAgICAgICByZXNba2V5XSA9IG5ldyBEYXRlKHZhbHVlWyckZGF0ZSddKS50b0lTT1N0cmluZygpLnNsaWNlKDAsMTkpICsgJ1onO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbn0pO1xuXG5hcHAuY29udHJvbGxlcignZXZlbnRzQ29udHJvbGxlcicsIFtcIiRzY29wZVwiLCBcIiRodHRwXCIsIFwiJGxvY2F0aW9uXCIsIFwiYXBpXCIsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRsb2NhdGlvbiwgYXBpKSB7XG4gICAgJHNjb3BlLmZpbHRlciA9IHtcbiAgICAgICAgXCJjYXRlZ29yeVwiIDogXCJcIiwgICAgLy8gQ2F0ZWdvcnlcbiAgICAgICAgXCJzcmNfaXBcIiA6IFwiXCIsICAgICAgLy8gU291cmNlIElQXG4gICAgICAgIFwidHJ0X2lwXCIgOiBcIlwiLCAgICAgIC8vIFRhcmdldCBJUFxuICAgICAgICBcImRlc2NcIiA6IFwiXCIsICAgICAgICAvLyBEZXNjcmlwdGlvblxuICAgICAgICBcImZsb3dzX2Zyb21cIiA6IFwiXCIsICAvLyBGbG93Q291bnRcbiAgICAgICAgXCJmbG93c190b1wiIDogXCJcIiwgICAgLy8gRmxvd0NvdW50XG4gICAgICAgIFwiaXRlbXNcIiA6IDEwMCwgICAgICAvLyBMaW1pdCBudW1iZXIgb2YgZGlzcGxheWVkIGl0ZW1zXG4gICAgfTtcbiAgICAkc2NvcGUucXVlcnkgPSB7XG4gICAgICAgIFwiZnJvbVwiIDogXCJcIixcbiAgICAgICAgXCJ0b1wiIDogXCJcIixcbiAgICAgICAgXCJkYXRlXCIgOiBuZXcgRGF0ZSgpLFxuICAgICAgICBcImRlc2NyaXB0aW9uXCIgOiBcIlwiLFxuICAgICAgICBcImNhdGVnb3J5XCIgOiBcIlwiLFxuICAgICAgICBcImxpbWl0XCIgOiAxMDBcbiAgICB9XG5cbiAgICAkc2NvcGUuZGF0YSA9IFtdO1xuICAgICRzY29wZS5sb2FkYnRuID0gXCJMb2FkXCI7XG4gICAgY29uc29sZS5sb2coJHNjb3BlLnF1ZXJ5LmRhdGUpXG5cbiAgICAkc2NvcGUubG9hZEl0ZW1zID0gZnVuY3Rpb24ocXVlcnkpIHtcbiAgICAgICAgJHNjb3BlLmxvYWRidG4gPSBcIkxvYWRpbmcuLi5cIjtcbiAgICAgICAgdmFyIGZyb20gPSBxdWVyeS5mcm9tLnNwbGl0KCc6Jyk7XG4gICAgICAgIHZhciBmcm9tX2RhdGUgPSBuZXcgRGF0ZShxdWVyeS5kYXRlKTtcbiAgICAgICAgZnJvbV9kYXRlLnNldEhvdXJzKGZyb21fZGF0ZS5nZXRIb3VycygpICsgZnJvbVswXSk7XG4gICAgICAgIGZyb21fZGF0ZS5zZXRNaW51dGVzKGZyb21bMV0pO1xuICAgICAgICBcbiAgICAgICAgJGxvY2F0aW9uLnNlYXJjaCgnZmlsdGVyJywgdHJ1ZSk7XG4gICAgICAgICRsb2NhdGlvbi5zZWFyY2goJ2Zyb20nLCBxdWVyeS5mcm9tKTtcbiAgICAgICAgJGxvY2F0aW9uLnNlYXJjaCgnZGF0ZScsIHF1ZXJ5LmRhdGUpO1xuICAgICAgICAkbG9jYXRpb24uc2VhcmNoKCdsaW1pdCcsIHF1ZXJ5LmxpbWl0KTtcbiAgICAgICAgXG5cbiAgICAgICAgaWYgKHF1ZXJ5LnRvKSB7XG4gICAgICAgICAgICB2YXIgdG8gPSBxdWVyeS50by5zcGxpdCgnOicpO1xuICAgICAgICAgICAgdmFyIHRvX2RhdGUgPSBuZXcgRGF0ZShxdWVyeS5kYXRlKTtcbiAgICAgICAgICAgIHRvX2RhdGUuc2V0SG91cnModG9fZGF0ZS5nZXRIb3VycygpICsgdG9bMF0pO1xuICAgICAgICAgICAgdG9fZGF0ZS5zZXRNaW51dGVzKHRvWzFdKTtcbiAgICAgICAgICAgICRsb2NhdGlvbi5zZWFyY2goJ3RvJywgcXVlcnkudG8pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIHRvX2RhdGUgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAocXVlcnkuZGVzY3JpcHRpb24gIT0gXCJcIikge1xuICAgICAgICAgICAgJGxvY2F0aW9uLnNlYXJjaCgnZGVzY3JpcHRpb24nLCBxdWVyeS5kZXNjcmlwdGlvbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBxdWVyeS5kZXNjcmlwdGlvbiA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocXVlcnkuY2F0ZWdvcnkgIT0gXCJcIikge1xuICAgICAgICAgICAgJGxvY2F0aW9uLnNlYXJjaCgnY2F0ZWdvcnknLCBxdWVyeS5jYXRlZ29yeSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBxdWVyeS5jYXRlZ29yeSA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc2VuZCA9IHtcbiAgICAgICAgICAgIFwiZnJvbVwiIDogZnJvbV9kYXRlLFxuICAgICAgICAgICAgXCJ0b1wiIDogdG9fZGF0ZSxcbiAgICAgICAgICAgIFwiY2F0ZWdvcnlcIiA6IHF1ZXJ5LmNhdGVnb3J5LFxuICAgICAgICAgICAgXCJkZXNjcmlwdGlvblwiIDogcXVlcnkuZGVzY3JpcHRpb24sXG4gICAgICAgICAgICBcImxpbWl0XCIgOiBxdWVyeS5saW1pdFxuICAgICAgICB9XG4gICAgICAgIGFwaS5nZXQoJ3F1ZXJ5Jywgc2VuZCwgdHJ1ZSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG5cdFx0XHQkc2NvcGUuZGF0YSA9IGRhdGE7XG4gICAgICAgICAgICAkc2NvcGUubG9hZGJ0biA9IFwiTG9hZFwiXG5cdCAgICB9KS5lcnJvcihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRzY29wZS5sb2FkYnRuID0gXCJMb2FkXCI7ICAgIFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgaWYgKCRsb2NhdGlvbi5zZWFyY2goKS5maWx0ZXIpIHtcbiAgICAgICAgJHNjb3BlLnF1ZXJ5ID0gJGxvY2F0aW9uLnNlYXJjaCgpO1xuICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUucXVlcnkuZGF0ZSlcbiAgICAgICAgJHNjb3BlLnF1ZXJ5LmRhdGUgPSBuZXcgRGF0ZSgkc2NvcGUucXVlcnkuZGF0ZSk7XG4gICAgICAgICRzY29wZS5sb2FkSXRlbXMoJHNjb3BlLnF1ZXJ5KTtcbiAgICB9IGVsc2Uge1xuXG4gICAgICAgIGFwaS5nZXQoXCIxMDBcIikuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAkc2NvcGUuZGF0YSA9IGRhdGE7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgICRzY29wZS5ldmVudHMgPSBmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgIHZhciByZXMgPSBbXTtcbiAgICAgICAgaWYgKCRzY29wZS5maWx0ZXIuc3JjX2lwICE9IFwiXCIpe1xuICAgICAgICAgICAgaWYgKFwiU291cmNlXCIgaW4gaXRlbSkge1xuICAgICAgICAgICAgICAgIGlmIChcIklQNFwiIGluIGl0ZW0uU291cmNlWzBdICYmIGl0ZW0uU291cmNlWzBdLklQNFswXS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJHNjb3BlLmZpbHRlci5zcmNfaXAudG9Mb3dlckNhc2UoKSkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXMucHVzaCgxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICByZXMucHVzaCgwKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzLnB1c2goMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoJHNjb3BlLmZpbHRlci50cnRfaXAgIT0gXCJcIil7XG4gICAgICAgICAgICBpZiAoXCJUYXJnZXRcIiBpbiBpdGVtKSB7XG4gICAgICAgICAgICAgICAgaWYgKFwiSVA0XCIgaW4gaXRlbS5UYXJnZXRbMF0gJiYgaXRlbS5UYXJnZXRbMF0uSVA0WzBdLnRvTG93ZXJDYXNlKCkuaW5kZXhPZigkc2NvcGUuZmlsdGVyLnRydF9pcC50b0xvd2VyQ2FzZSgpKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlcy5wdXNoKDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHJlcy5wdXNoKDApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXMucHVzaCgwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoJHNjb3BlLmZpbHRlci5jYXRlZ29yeSAhPSBcIlwiKSB7XG4gICAgICAgICAgICBpZiAoaXRlbS5DYXRlZ29yeVswXS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJHNjb3BlLmZpbHRlci5jYXRlZ29yeS50b0xvd2VyQ2FzZSgpKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgcmVzLnB1c2goMSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlcy5wdXNoKDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCRzY29wZS5maWx0ZXIuZGVzYyAhPSBcIlwiKSB7XG4gICAgICAgICAgICBpZiAoaXRlbS5EZXNjcmlwdGlvbi50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJHNjb3BlLmZpbHRlci5kZXNjLnRvTG93ZXJDYXNlKCkpID4gLTEpXG4gICAgICAgICAgICAgICAgcmVzLnB1c2goMSk7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgcmVzLnB1c2goMCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoJHNjb3BlLmZpbHRlci5mbG93c19mcm9tICE9IFwiXCIpIHtcbiAgICAgICAgICAgIGlmIChpdGVtLkZsb3dDb3VudCA+IE51bWJlcigkc2NvcGUuZmlsdGVyLmZsb3dzX2Zyb20pKVxuICAgICAgICAgICAgICAgIHJlcy5wdXNoKDEpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHJlcy5wdXNoKDApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCRzY29wZS5maWx0ZXIuZmxvd3NfdG8gIT0gXCJcIikge1xuICAgICAgICAgICAgaWYgKGl0ZW0uRmxvd0NvdW50IDwgTnVtYmVyKCRzY29wZS5maWx0ZXIuZmxvd3NfdG8pKVxuICAgICAgICAgICAgICAgIHJlcy5wdXNoKDEpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHJlcy5wdXNoKDApO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGxvZ2ljdmFsdWUgPSAxO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbG9naWN2YWx1ZSA9IGxvZ2ljdmFsdWUgKiByZXNbaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxvZ2ljdmFsdWUgPT0gMSA/IHRydWUgOiBmYWxzZTtcblxuICAgIH1cblxufV0pO1xuXG5hcHAuZGlyZWN0aXZlKCd2YWxpZGF0ZUhvdXJzJywgZnVuY3Rpb24oKSB7XG4gICAgdmFyIHRvID0gW107XG4gICAgdmFyIGZyb20gPSBbXTtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXF1aXJlOiAnbmdNb2RlbCcsXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycywgY3RybCkge1xuICAgICAgICAgICAgY3RybC4kdmFsaWRhdG9ycy50aW1lID0gZnVuY3Rpb24obW9kZWxWYWx1ZSwgdmlld1ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGF0dHJzLm5nTW9kZWwgPT0gXCJxdWVyeS5mcm9tXCIgJiYgdmlld1ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGZyb20gPSB2aWV3VmFsdWUuc3BsaXQoJzonKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHZpZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB0byA9IHZpZXdWYWx1ZS5zcGxpdCgnOicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGZyb20pXG4gICAgICAgICAgICBjb25zb2xlLmxvZyh0bykgXG4gICAgICAgICAgICBpZiAodG8ubGVuZ3RoID09IDIgfHwgZnJvbS5sZW5ndGggPT0gMikge1xuICAgICAgICAgICAgICAgIGlmICh0b1swXSA8IGZyb21bMF0gfHwgKHRvWzBdIDw9IGZyb21bMF0gJiYgdG9bMV0gPCBmcm9tWzFdKSB8fFxuICAgICAgICAgICAgICAgICAgICB0b1swXSA8IDAgfHwgdG9bMF0gPiAyMyB8fCB0b1sxXSA8IDAgfHwgdG9bMV0gPiA1OSB8fCBmcm9tWzBdIDwgMCB8fCBmcm9tWzBdID4gMjMgfHwgZnJvbVsxXSA8IDAgfHwgZnJvbVsxXSA+IDU5XG4gICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSk7XG5cbmFwcC52YWx1ZSgnYm94ZXNfYXJyJywgW1xuICB7IFxuICAgIFwicm93XCIgICA6IDAsXG4gICAgXCJoZWlnaHRcIiA6IFwiXCIsXG4gICAgXCJpdGVtc1wiIDogW1xuICAgICAge1xuICAgICAgICBcInRpdGxlXCIgICA6IFwiRXZlbnRzIHNoYXJlc1wiLFxuICAgICAgICBcInR5cGVcIiAgICA6IFwicGllY2hhcnRcIixcbiAgICAgICAgXCJjb250ZW50XCIgOiBcIlwiLFxuICAgICAgICBcImNvbmZpZ1wiICA6IHtcbiAgICAgICAgICAgIFwibWV0cmljXCIgICAgOiBcImNhdGVnb3J5XCIsXG4gICAgICAgICAgICBcInR5cGVcIiAgICAgIDogXCJwaWVjaGFydFwiLFxuICAgICAgICAgICAgXCJwZXJpb2RcIiAgICA6IFwiMjRcIixcbiAgICAgICAgICAgIFwiYmVnaW50aW1lXCIgOiBcIlwiXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIFwidGl0bGVcIiAgIDogXCJMYXN0IDI0IGhvdXJzXCIsXG4gICAgICAgIFwidHlwZVwiICAgIDogXCJiYXJjaGFydFwiLFxuICAgICAgICBcImRhdGFcIiAgICA6IFwiXCIsXG4gICAgICAgIFwidGltZXN0YW1wXCI6IFwiXCIsXG4gICAgICAgIFwiY29uZmlnXCIgOiB7XG4gICAgICAgICAgICBcIm1ldHJpY1wiIDogXCJjYXRlZ29yeVwiLFxuICAgICAgICAgICAgXCJ0eXBlXCIgOiBcImJhcmNoYXJ0XCIsXG4gICAgICAgICAgICBcInBlcmlvZFwiIDogMjQsXG4gICAgICAgICAgICBcIndpbmRvd1wiIDogNjAsXG4gICAgICAgICAgICBcImJlZ2ludGltZVwiIDogXCJcIlxuICAgICAgICB9XG4gICAgICB9XG4gICAgXVxuICB9LFxuICB7IFxuICAgIFwicm93XCIgICA6IDEsXG4gICAgXCJpdGVtc1wiIDogW1xuICAgICAge1xuICAgICAgICBcInRpdGxlXCIgOiBcIlRvcCBldmVudHMgaW4gMSBob3VyXCIsXG4gICAgICAgIFwidHlwZVwiICA6IFwidG9wXCIsXG4gICAgICAgIFwiY29uZmlnXCIgOiB7XG4gICAgICAgICAgICBcInBlcmlvZFwiIDogMSxcbiAgICAgICAgICAgIFwiYmVnaW50aW1lXCIgOiBcIlwiXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBcInRpdGxlXCI6IFwiMlwiLFxuICAgICAgICBcInR5cGVcIiAgICA6IFwiaW5jaWRlbnRcIlxuICAgICAgfSxcbiAgICBdXG4gIH0sXG4gIF0pO1xuXG5cbmFwcC5jb250cm9sbGVyKCdob21lQ29udHJvbGxlcicsIFtcIiRzY29wZVwiLCBcIiRsb2dcIiwgXCJhcGlcIiwgXCJib3hlc19hcnJcIiwgXCIkaHR0cFwiLCBcIiRsb2NhbFN0b3JhZ2VcIiwgXCJ1c2VyXCIsIGZ1bmN0aW9uKCRzY29wZSwgJGxvZywgYXBpLCBib3hlc19hcnIsICRodHRwLCAkbG9jYWxTdG9yYWdlLCB1c2VyKSB7XG4gICAgJHNjb3BlLmFjdGl2ZUdyaWQgPSBmYWxzZTsgXG4gICAgJHNjb3BlLm9wZW5NZW51ID0gZnVuY3Rpb24oJG1kT3Blbk1lbnUsIGV2KSB7XG4gICAgICAgIG9yaWdpbmF0b3JFdiA9IGV2O1xuICAgICAgICAkbWRPcGVuTWVudShldik7XG4gICAgfTtcblxuICAgICRzY29wZS5hZGRJdGVtID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICRzY29wZS4kYnJvYWRjYXN0KCdhZGRJdGVtJyk7XG4gICAgfVxuXG4gICAgJHNjb3BlLmVuYWJsZUdyaWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ0VuYWJsZSBncmlkJylcbiAgICAgICAgJHNjb3BlLiRicm9hZGNhc3QoJ2VuYWJsZUdyaWQnKTtcbiAgICAgICAgJHNjb3BlLmFjdGl2ZUdyaWQgPSAhJHNjb3BlLmFjdGl2ZUdyaWQ7XG4gICAgfVxuXG5cbn1dKTtcblxuYXBwLmNvbnRyb2xsZXIoJ3RvcEJhcicsIHRvcEJhckN0cmwpO1xuXG5mdW5jdGlvbiB0b3BCYXJDdHJsKCRtZERpYWxvZywgJGxvY2F0aW9uLCAkbWRTaWRlbmF2KXtcblxuXHR0aGlzLnVzZXIgPSBcIlBldHJcIlxuXG4gIHRoaXMudG9nZ2xlTGVmdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgJG1kU2lkZW5hdignbGVmdCcpLnRvZ2dsZSgpO1xuICAgIH07XG4gIFx0XG4gIHRoaXMubG9nb3V0ID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNvbmZpcm0gPSAkbWREaWFsb2cuY29uZmlybSgpXG5cdCAgICAgICAgLnRpdGxlKCdBcmUgeW91IHN1cmU/Jylcblx0ICAgICAgICAuY29udGVudCgnWW91IGFyZSBhYm91dCB0byBiZSBsb2dnZWQgb3V0LiBBbGwgdW5zYXZlZCBjaGFuZ2VzIHdpbGwgYmUgbG9zdCBpbiB0aGUgdm9pZCEnKVxuXHQgICAgICAgIC5vaygnTG9nIG1lIG91dCcpXG5cdCAgICAgICAgLmNhbmNlbCgnS2VlcCBtZSBoZXJlJylcbiAgICAkbWREaWFsb2cuc2hvdyhjb25maXJtKS50aGVuKFxuICAgIFx0ZnVuY3Rpb24oKSB7XG4gICAgXHRcdCRsb2NhdGlvbi5wYXRoKCcvbG9naW4nKTtcbiAgICBcdH0pO1xuICB9O1xuXG4gIFxufTtcblxuYXBwLmNvbnRyb2xsZXIoJ3JvdycsIFtcIiRzY29wZVwiLCBcIiR0aW1lb3V0XCIsIGZ1bmN0aW9uKCRzY29wZSwgJHRpbWVvdXQpe1xuICAkc2NvcGUuJG9uKCdyZXF1ZXN0UmVkcmF3JywgZnVuY3Rpb24oZSkge1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICBjb25zb2xlLmxvZyhcInJlcXVlc3QgYWNjZXB0ZWRcIik7XG4gICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3Jlc2l6ZScpKTtcbiAgICB9LCAxMCk7XG4gIH0pO1xufV0pO1xuXG5hcHAuY29udHJvbGxlcignYm94JywgW1wiJHNjb3BlXCIsIFwiJGxvZ1wiLCBcImJveGVzX2FyclwiLCBcIiR0aW1lb3V0XCIsIFwiJGVsZW1lbnRcIiwgXCIkbWREaWFsb2dcIiwgXCJQUk9UT0NPTFNcIiwgXCJUWVBFU1wiLCBcIkNBVEVHT1JJRVNcIiwgXCIkaHR0cFwiLCBcIlBJRUNIQVJUXCIsIFwiQVJFQVwiLCBcImFwaVwiLCBcIiRsb2NhdGlvblwiLCBcInVzZXJcIiwgZnVuY3Rpb24oJHNjb3BlLCAkbG9nLCBib3hlc19hcnIsICR0aW1lb3V0LCAkZWxlbWVudCwgJG1kRGlhbG9nLCBQUk9UT0NPTFMsIFRZUEVTLCBDQVRFR09SSUVTLCAkaHR0cCwgUElFQ0hBUlQsIEFSRUEsIGFwaSwgJGxvY2F0aW9uLCB1c2VyKXtcbiAgICBcbiAgICBmdW5jdGlvbiB0aW1lU2hpZnQoKSB7ICAgIFxuICAgICAgICBpZiAoJHNjb3BlLmJveCAhPSB1bmRlZmluZWQgJiYgKCRzY29wZS5ib3gudHlwZSA9PSBcInBpZWNoYXJ0XCIgfHwgJHNjb3BlLmJveC50eXBlID09IFwiYmFyY2hhcnRcIiB8fCAkc2NvcGUuYm94LnR5cGUgPT0gJ3RvcCcgfHwgJHNjb3BlLmJveC50eXBlID09IFwic3VtXCIgKSkge1xuICAgICAgICAgICAgJHNjb3BlLmJveC5jb25maWcuYmVnaW50aW1lID0gKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgICAgIG5vdy5zZXRIb3Vycyhub3cuZ2V0SG91cnMoKSAtICRzY29wZS5ib3guY29uZmlnLnBlcmlvZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vdztcbiAgICAgICAgICAgIH0pKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0aW1lU2hpZnQoKTtcblxuICAgICRzY29wZS5ib3gubG9hZGluZyA9IHRydWU7XG4gICAgICAgIFxuICAgICRzY29wZS5vcGVuTWVudSA9IGZ1bmN0aW9uKCRtZE9wZW5NZW51LCBldikge1xuICAgICAgICBvcmlnaW5hdG9yRXYgPSBldjtcbiAgICAgICAgJG1kT3Blbk1lbnUoZXYpO1xuICAgIH07XG5cbiAgICAkc2NvcGUuZWRpdE1vZGUgPSBmYWxzZTtcbiAgICAkc2NvcGUuYmFja3VwTW9kZWwgPSB7fTtcblxuICAgICRzY29wZS5wcm90b2NvbCA9IFBST1RPQ09MUztcbiAgICAkc2NvcGUudHlwZXMgPSBUWVBFUztcbiAgICAkc2NvcGUuY2F0ZWdvcmllcyA9IENBVEVHT1JJRVM7XG5cblxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAvLyBFZGl0IG1vZGUgaGFuZGxpbmdcbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAvLyBUcmlnZ2VyIGVkaXRpbmcgbW9kZSBhbmQgc2F2ZSBjdXJyZW50IHN0YXRlXG4gICAgJHNjb3BlLmVkaXQgPSBmdW5jdGlvbihib3gpIHtcbiAgICAgICAgJHNjb3BlLmVkaXRNb2RlID0gdHJ1ZTtcbiAgICAgICAgJHNjb3BlLmJhY2t1cE1vZGVsID0gYW5ndWxhci5jb3B5KGJveCk7XG4gICAgICAgICRzY29wZS4kZW1pdChcInN3aXRjaC1kcmFnXCIpO1xuICAgIH1cblxuICAgIC8vIFNhdmUgY2hhbmdlcyBhbmQgZGlzYWJsZSBlZGl0IG1vZGVcbiAgICAkc2NvcGUuc2F2ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAkc2NvcGUudXNlcigpO1xuICAgICAgICBpZiAoJHNjb3BlLmJveC50eXBlID09ICdwaWVjaGFydCcpIHtcbiAgICAgICAgICAgICRzY29wZS5ib3gub3B0aW9ucyA9IFBJRUNIQVJULm9wdGlvbnM7XG4gICAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBpZiAoJHNjb3BlLmJveC50eXBlID09ICdiYXJjaGFydCcpXG4gICAgICAgICAgICAkc2NvcGUuYm94Lm9wdGlvbnMgPSBBUkVBLm9wdGlvbnM7XG4gICAgICAgIFxuXG4gICAgICAgICRzY29wZS5iYWNrdXBNb2RlbCA9IHt9O1xuXG4gICAgICAgICRzY29wZS5ib3guY29uZmlnLnR5cGUgPSAkc2NvcGUuYm94LnR5cGU7XG4gICAgICAgIFxuICAgICAgICAvLyBEaXNhYmxlIGVkaXQgbW9kZVxuICAgICAgICAkc2NvcGUuZWRpdE1vZGUgPSBmYWxzZTtcblxuICAgICAgICAvLyBTaG93IGxvYWRpbmcgaW5kaWNhdG9yXG4gICAgICAgICRzY29wZS5ib3gubG9hZGluZyA9IHRydWU7XG5cbiAgICAgICAgLy8gU2hpZnQgdGltZSBmb3IgcXVlcnlcbiAgICAgICAgdGltZVNoaWZ0KCk7XG5cbiAgICAgICAgJHNjb3BlLiRlbWl0KFwic3dpdGNoLWRyYWdcIik7XG4gICAgICAgIC8vIEdldCByZXF1aXJlZCBkYXRhXG4gICAgICAgIGlmICgkc2NvcGUuYm94LnR5cGUgPT0gJ3BpZWNoYXJ0JyB8fCAkc2NvcGUuYm94LnR5cGUgPT0gJ2JhcmNoYXJ0Jykge1xuICAgICAgICAgICAgYXBpLmdldCgnYWdnJywgJHNjb3BlLmJveC5jb25maWcsIHRydWUpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5ib3gubG9hZGluZyA9IGZhbHNlOyAgICBcbiAgICAgICAgICAgICAgICAkc2NvcGUuYm94LmRhdGEgPSBkYXRhO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBlbHNlIGlmICgkc2NvcGUuYm94LnR5cGUgPT0gJ3RvcCcpIHtcbiAgICAgICAgICAgIGFwaS5nZXQoJ3RvcCcsICRzY29wZS5ib3guY29uZmlnLCB0cnVlKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYm94LmxvYWRpbmcgPSBmYWxzZTsgICAgXG4gICAgICAgICAgICAgICAgJHNjb3BlLmJveC5kYXRhID0gZGF0YTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSBpZiAoJHNjb3BlLmJveC50eXBlID09ICdzdW0nKSB7XG4gICAgICAgICAgICBhcGkuZ2V0KCdjb3VudCcsICRzY29wZS5ib3guY29uZmlnKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYm94LmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYm94LmRhdGEgPSBkYXRhO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIFJldmVydCB0byBvcmlnaW5hbCBhbmQgZGlzYWJsZSBlZGl0IG1vZGVcbiAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24oYm94KSB7XG4gICAgICAgICRzY29wZS5ib3ggPSBhbmd1bGFyLmNvcHkoJHNjb3BlLmJhY2t1cE1vZGVsKTtcbiAgICAgICAgJHNjb3BlLmJhY2t1cE1vZGVsID0ge307XG4gICAgICAgICRzY29wZS5lZGl0TW9kZSA9IGZhbHNlO1xuICAgICAgICAkc2NvcGUuJGVtaXQoXCJzd2l0Y2gtZHJhZ1wiKTtcbiAgICB9XG4gICAgXG4gICAgJHNjb3BlLnRvcCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aW1lU2hpZnQoKVxuICAgICAgICBhcGkuZ2V0KCd0b3AnLCAkc2NvcGUuYm94LmNvbmZpZywgdHJ1ZSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICRzY29wZS5ib3guZGF0YSA9IGRhdGE7XG4gICAgICAgIH0pXG4gICAgfVxuICAgIFxuICAgIGlmICgkc2NvcGUuYm94ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAoJHNjb3BlLmJveC50eXBlID09IFwicGllY2hhcnRcIiB8fCAkc2NvcGUuYm94LnR5cGUgPT0gXCJiYXJjaGFydFwiKSB7XG4gICAgICAgICAgICBpZiAoJHNjb3BlLmJveC50eXBlID09ICdwaWVjaGFydCcpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuYm94Lm9wdGlvbnMgPSBQSUVDSEFSVC5vcHRpb25zO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCRzY29wZS5ib3gudHlwZSA9PSAnYmFyY2hhcnQnKVxuICAgICAgICAgICAgICAgICRzY29wZS5ib3gub3B0aW9ucyA9IEFSRUEub3B0aW9ucztcbiAgICAgICAgICAgXG4gICAgICAgICAgICAkc2NvcGUuYm94LmNvbmZpZy50eXBlID0gJHNjb3BlLmJveC50eXBlO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBhcGkuZ2V0KCdhZ2cnLCAkc2NvcGUuYm94LmNvbmZpZykuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmJveC5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmJveC5kYXRhID0gZGF0YTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBTdW0gYWxsIGV2ZW50c1xuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuYm94LnR5cGUgPT0gJ3BpZWNoYXJ0Jykge1xuICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgJHNjb3BlLmJveC5kYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudG90YWwgPSAkc2NvcGUudG90YWwgKyBOdW1iZXIoJHNjb3BlLmJveC5kYXRhW2ldLngpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoJHNjb3BlLmJveC50eXBlID09ICd0b3AnKSB7XG4gICAgICAgICAgICBhcGkuZ2V0KCd0b3AnLCAkc2NvcGUuYm94LmNvbmZpZykuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmJveC5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmJveC5kYXRhID0gZGF0YTsgICAgICAgIFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBlbHNlIGlmICgkc2NvcGUuYm94LnR5cGUgPT0gJ3N1bScpIHtcbiAgICAgICAgICAgIGFwaS5nZXQoJ2NvdW50JywgJHNjb3BlLmJveC5jb25maWcpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICRzY29wZS5ib3gubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICRzY29wZS5ib3guZGF0YSA9IGRhdGE7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgJHNjb3BlLnVzZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNldHRpbmdzID0gYW5ndWxhci5jb3B5KCRzY29wZS5pdGVtcyk7XG4gICAgICAgIGNvbnNvbGUubG9nKHNldHRpbmdzKVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNldHRpbmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHNldHRpbmdzW2ldW1wiZGF0YVwiXTtcbiAgICAgICAgICAgICAgICBkZWxldGUgc2V0dGluZ3NbaV1bXCJvcHRpb25zXCJdO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB2YXIgcXVlcnkgPSB7XG4gICAgICAgICAgICBcImp3dFwiIDogdXNlci5qd3QoKSxcbiAgICAgICAgICAgIFwic2V0dGluZ3NcIiA6IHNldHRpbmdzXG4gICAgICAgIH1cblxuICAgICAgICAkbG9nLmluZm8ocXVlcnkpXG4gICAgICAgIHVzZXIucHV0KHF1ZXJ5KVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRGF0YVwiKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICAgICAgJGxvZy5lcnJvcihkYXRhKVxuICAgICAgICAgICAgfSlcbiAgICB9XG5cbiAgICAkc2NvcGUuJG9uKCdzYXZlVXNlcicsIGZ1bmN0aW9uKCkgeyRzY29wZS51c2VyKCl9KTtcblxuICAgICRzY29wZS4kb24oJ2dyaWRzdGVyLWl0ZW0tcmVzaXplZCcsIGZ1bmN0aW9uKGdyaWRzdGVyKSB7XG4gICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVxdWVzdCBhY2NlcHRlZFwiKTtcbiAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3Jlc2l6ZScpKTtcbiAgICAgICAgfSwgMTAwKTtcbiAgICB9KVxuXG4gIFxufV0pO1xuXG5hcHAuY29udHJvbGxlcignZ3JpZCcsIFtcIiRzY29wZVwiLCBcIiR0aW1lb3V0XCIsIFwiJGxvZ1wiLCBcInVzZXJcIiwgZnVuY3Rpb24oJHNjb3BlLCAkdGltZW91dCwgJGxvZy8qLCAkbWRNZWRpYSwgJHdpbmRvdyovLCB1c2VyKSB7XG4kc2NvcGUub3B0ID0ge1xuICAgIG91dGVyTWFyZ2luOiBmYWxzZSxcbiAgICBjb2x1bW5zOiA2LFxuICAgIHB1c2hpbmc6IHRydWUsXG4gICAgcm93SGVpZ2h0OiAyNTAgKyAxMCxcbiAgICBjb2xXaWR0aCA6ICdhdXRvJyxcbiAgICBmbG9hdGluZzogdHJ1ZSxcbiAgICBzd2FwcGluZzogdHJ1ZSxcbiAgICBtb2JpbGVCcmVha1BvaW50OiA5MzMsXG4gICAgZHJhZ2dhYmxlOiB7XG4gICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgIH0sXG4gICAgcmVzaXphYmxlOiB7XG4gICAgICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICBoYW5kbGVzOiBbJ24nLCAnZScsICdzJywgJ3cnLCAnc2UnLCAnc3cnXSxcbiAgICAgICAgc3RvcDogZnVuY3Rpb24oZXZlbnQsICRlbGVtZW50LCB3aWRnZXQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVzaXplIGVuZFwiKTtcbiAgICAgICAgICAgICRzY29wZS4kZW1pdCgncmVxdWVzdFJlZHJhdycpO1xuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicmVxdWVzdCBhY2NlcHRlZFwiKTtcbiAgICAgICAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdyZXNpemUnKSk7XG4gICAgICAgICAgICB9LCAxMDApO1xuXG4gICAgICAgIH1cbiAgICB9XG59XG4vKnZhciB3ID0gYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpO1xudy5iaW5kKCdyZXNpemUnLCBmdW5jdGlvbigpIHtcbiAgICAvLyRzY29wZS5vcHQubW9iaWxlTW9kZUVuYWJsZSA9ICRtZE1lZGlhKCdndC1tZCcpO1xuICAgICRzY29wZS5vcHQuaXNNb2JpbGUgPSAhJG1kTWVkaWEoJ2d0LW1kJyk7XG59KTsqL1xuXG5jb25zb2xlLmxvZyh1c2VyLmNvbmZpZygpKVxuXG5cbiRzY29wZS4kb24oJ2VuYWJsZUdyaWQnLCBmdW5jdGlvbigpIHtcbiAgICBpZiAoJHNjb3BlLm9wdC5yZXNpemFibGUuZW5hYmxlZCA9PSB0cnVlKSB7XG4gICAgICAgICRzY29wZS4kYnJvYWRjYXN0KCdzYXZlVXNlcicpO1xuICAgIH1cbiAgICBcbiAgICAkc2NvcGUub3B0LnJlc2l6YWJsZS5lbmFibGVkID0gISRzY29wZS5vcHQucmVzaXphYmxlLmVuYWJsZWQ7IFxuICAgICRzY29wZS5vcHQuZHJhZ2dhYmxlLmVuYWJsZWQgPSAhJHNjb3BlLm9wdC5kcmFnZ2FibGUuZW5hYmxlZDsgXG59KVxuXG4kc2NvcGUucmVtb3ZlID0gZnVuY3Rpb24oYm94KSB7XG5cbiAgICB2YXIgdG1wID0gJHNjb3BlLml0ZW1zLnNwbGljZSgkc2NvcGUuaXRlbXMuaW5kZXhPZihib3gpLCAxKTtcblxuICB9O1xuXG4kc2NvcGUuaXRlbXMgPSB1c2VyLmNvbmZpZygpO1xuLyokc2NvcGUuaXRlbXMgPSBbe1xuICAgIHNpemVYOiAyLFxuICAgIHNpemVZOiAyLFxuICAgIHJvdzogMCxcbiAgICBjb2w6IDAsXG4gICAgXCJ0aXRsZVwiICAgOiBcIkV2ZW50cyBzaGFyZXNcIixcbiAgICBcInR5cGVcIiAgICA6IFwicGllY2hhcnRcIixcbiAgICBcImNvbnRlbnRcIiA6IFwiXCIsXG4gICAgXCJjb25maWdcIiAgOiB7XG4gICAgICAgIFwibWV0cmljXCIgICAgOiBcImNhdGVnb3J5XCIsXG4gICAgICAgIFwidHlwZVwiICAgICAgOiBcInBpZWNoYXJ0XCIsXG4gICAgICAgIFwicGVyaW9kXCIgICAgOiBcIjI0XCIsXG4gICAgICAgIFwiYmVnaW50aW1lXCIgOiBcIlwiXG4gICAgfVxufSwge1xuICAgIHNpemVYOiAyLFxuICAgIHNpemVZOiAyLFxuICAgIG1pblNpemVYIDogMixcbiAgICBtaW5TaXplWSA6IDIsXG4gICAgcm93OiAwLFxuICAgIGNvbDogMixcbiAgICBcInRpdGxlXCIgOiBcIkxhc3QgMjQgaG91cnNcIixcbiAgICBcInR5cGVcIiA6IFwiYmFyY2hhcnRcIixcbiAgICBcImRhdGFcIiA6IFwiXCIsXG4gICAgXCJ0aW1lc3RhbXBcIjogXCJcIixcbiAgICBcImNvbmZpZ1wiIDoge1xuICAgICAgICBcIm1ldHJpY1wiIDogXCJjYXRlZ29yeVwiLFxuICAgICAgICBcInR5cGVcIiA6IFwiYmFyY2hhcnRcIixcbiAgICAgICAgXCJwZXJpb2RcIiA6IDI0LFxuICAgICAgICBcIndpbmRvd1wiIDogNjAsXG4gICAgICAgIFwiYmVnaW50aW1lXCIgOiBcIlwiXG4gICAgfVxufSwge1xuICAgIFwidGl0bGVcIiA6IFwiVG9wIGV2ZW50cyBpbiAxIGhvdXJcIixcbiAgICBcInR5cGVcIiAgOiBcInRvcFwiLFxuICAgIFwiY29uZmlnXCIgOiB7XG4gICAgICAgIFwicGVyaW9kXCIgOiAxLFxuICAgICAgICBcImJlZ2ludGltZVwiIDogXCJcIlxuICAgIH1cbn1dOyovXG5cbiAgICAkc2NvcGUuJG9uKCdhZGRJdGVtJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBpdGVtID0ge1xuICAgICAgICAgICAgXCJ0aXRsZVwiIDogXCJOZXcgYm94XCIsXG4gICAgICAgICAgICBcImxvYWRpbmdcIiA6IGZhbHNlLFxuICAgICAgICAgICAgc2l6ZVg6IDEsXG4gICAgICAgICAgICBzaXplWTogMSxcbiAgICAgICAgICAgIC8vcm93IDogcm93LFxuICAgICAgICAgICAgLy9jb2wgOiBjb2xcbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5pdGVtcy5wdXNoKGl0ZW0pXG4gICAgfSk7XG5cblxufV0pXG5cblxuYXBwLmRpcmVjdGl2ZSgnZ3JpZHN0ZXJEeW5hbWljSGVpZ2h0JywgW1wiJHRpbWVvdXRcIiwgZnVuY3Rpb24gKCR0aW1lb3V0KSB7XG5cbiAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgaXRlbTogXCI9XCIgLy9ncmlkc3RlciBpdGVtXG4gICAgICAgIH0sXG4gICAgICAgIGxpbms6IGxpbmssXG4gICAgICAgIHJlc3RyaWN0OiAnQSdcbiAgICB9O1xuICAgIHJldHVybiBkaXJlY3RpdmU7XG5cbiAgICBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICBzY29wZS4kd2F0Y2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudFswXS5zY3JvbGxIZWlnaHQ7XG4gICAgICAgIH0sXG4gICAgICAgIGZ1bmN0aW9uKG5ld1ZhbCwgb2xkVmFsKSB7IFxuICAgICAgICAgICAgdmFyIHJvd0hlaWdodE9wdGlvbiA9IDI3MDsgLy8gQ2hhbmdlIHRoaXMgdmFsdWUgd2l0aCB5b3VyIG93biByb3dIZWlnaHQgb3B0aW9uXG4gICAgICAgICAgICB2YXIgaGVpZ2h0ID0gcm93SGVpZ2h0T3B0aW9uICogc2NvcGUuaXRlbS5zaXplWTtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coc2NvcGUuaXRlbS50aXRsZSk7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwibmV3VmFsOiBcIiArIG5ld1ZhbCArIFwiICAgICBoZWlnaHQ6IFwiICsgaGVpZ2h0KVxuICAgICAgICAgICAgaWYobmV3VmFsID4gaGVpZ2h0KXtcbiAgICAgICAgICAgICAgICB2YXIgZGl2ID0gTWF0aC5mbG9vcihuZXdWYWwgLyByb3dIZWlnaHRPcHRpb24pO1xuICAgICAgICAgICAgICAgIC8vZGl2Kys7XG4gICAgICAgICAgICAgICAgc2NvcGUuaXRlbS5zaXplWSA9IGRpdjsgXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgfVxufV0pO1xuXG5hcHAuY29udHJvbGxlcignbG9naW5Db250cm9sbGVyJywgW1wiJHNjb3BlXCIsIFwiJGxvY2F0aW9uXCIsIFwiJGxvZ1wiLCBcInVzZXJcIiwgZnVuY3Rpb24oJHNjb3BlLCAkbG9jYXRpb24sICRsb2csIHVzZXIpIHtcblx0JHNjb3BlLnRpdGxlID0gXCJMb2dpbiB0byBOZW1lYSBEYXNoYm9hcmRcIjtcblx0JHNjb3BlLmxvZ2luQnRuID0gXCJMb2dpblwiO1xuICAgIFxuICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbihjcmVkKSB7XG5cdFx0JHNjb3BlLmxvZ2luQnRuID0gXCJBdXRoZW50aWNhdGluZy4uLlwiO1xuICAgICAgICAkc2NvcGUubG9naW5CdG5EaXNhYmxlZCA9IHRydWU7XG5cbiAgICAgICAgdXNlci5hdXRoKGNyZWQpXG4gICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7ICAgIFxuICAgICAgICB9KVxuICAgICAgICAuZXJyb3IoZnVuY3Rpb24obXNnKSB7XG4gICAgICAgICAgICAkc2NvcGUuZXJyb3JfbWVzID0gbXNnO1xuICAgICAgICAgICAgJHNjb3BlLmxvZ2luQnRuID0gXCJMb2dpblwiXG4gICAgICAgICAgICAkc2NvcGUubG9naW5CdG5EaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICB9KVxuICAgIH1cblxuXHRcdFxuXHRcdC8qbG9naW5BdXRoLmZldGNoVXNlcih1c2VyKVxuXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcblxuXHRcdFx0JGxvZy5pbmZvKGRhdGEpO1xuXG5cdFx0XHRpZiAoZGF0YVtcInN1Y2Nlc3NcIl0gPT0gdHJ1ZSkge1xuXHRcdFx0XHQvLyRsb2cuaW5mbyhkYXRhKTtcdFxuXHRcdFx0XHQkc2NvcGUubG9naW5CdG4gPSBcIlN1Y2Nlc3NcIjtcblx0XHRcdFx0JGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuXHRcdFx0XHRsb2NhbFN0b3JhZ2VTZXJ2aWNlLnNldCgnbG9nZ2VkSW4nLCB0cnVlKTtcblx0XHRcdFx0bG9jYWxTdG9yYWdlU2VydmljZS5zZXQoJ2xvZ2dlZEluLnB3Jywgc2hhMjU2X2RpZ2VzdChkYXRhLnBhc3N3b3JkKSk7XHRcblx0XHRcdH1cblx0XHRcdGVsc2Uge1xuXHRcdFx0XHQkbG9nLmVycm9yKFwiZXJyb3IgLSBiYWQgcGFzc3dvcmRcIik7XG5cdFx0XHRcdCRzY29wZS5lcnJvcl9tZXMgPSBcIkJhZCBwYXNzd29yZFwiO1xuXHRcdFx0XHQkc2NvcGUubG9naW5CdG4gPSBcIkxvZ2luXCI7XG5cdFx0XHRcdGxvZ2luQ29ycmVjdCA9IGZhbHNlO1xuXHRcdFx0XHRsb2NhbFN0b3JhZ2VTZXJ2aWNlLnNldCgnbG9nZ2VkSW4nLCBmYWxzZSk7XHRcblx0XHRcdH1cblx0XHR9KTsqL1xufV0pO1xuXG5cblxuYXBwLmNvbnRyb2xsZXIoJ3Byb2ZpbGVDb250cm9sbGVyJywgW1wiJHNjb3BlXCIsIFwidXNlclwiLCBcImFwaVwiLCBmdW5jdGlvbigkc2NvcGUsIHVzZXIsIGFwaSkge1xuICAgICRzY29wZS51c2VyID0gdXNlci5jb25maWcoKTtcblxuICAgICRzY29wZS5lZGl0VXNlciA9IGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgY29uc29sZS5sb2codXNlcik7XG4gICAgfVxufV0pXG4iLCJhcHAuY29uc3RhbnQoJ0FVVEhfRVZFTlRTJywge1xuICBsb2dpblN1Y2Nlc3M6ICdhdXRoLWxvZ2luLXN1Y2Nlc3MnLFxuICBsb2dpbkZhaWxlZDogJ2F1dGgtbG9naW4tZmFpbGVkJyxcbiAgbG9nb3V0U3VjY2VzczogJ2F1dGgtbG9nb3V0LXN1Y2Nlc3MnLFxuICBzZXNzaW9uVGltZW91dDogJ2F1dGgtc2Vzc2lvbi10aW1lb3V0JyxcbiAgbm90QXV0aGVudGljYXRlZDogJ2F1dGgtbm90LWF1dGhlbnRpY2F0ZWQnLFxuICBub3RBdXRob3JpemVkOiAnYXV0aC1ub3QtYXV0aG9yaXplZCdcbn0pO1xuXG5hcHAuY29uc3RhbnQoJ0NBVEVHT1JJRVMnLCBbIFwiYW55XCIsIFwiUmVjb24uU2Nhbm5pbmdcIiwgXCJBdHRlbXB0LkxvZ2luXCIsIFwiQXZhaWxhYmlsaXR5LkRvU1wiIF0pO1xuYXBwLmNvbnN0YW50KCdQUk9UT0NPTFMnLCBbIFwidGNwXCIsIFwiZG5zXCIsIFwidWRwXCIgXSk7XG5hcHAuY29uc3RhbnQoJ1RZUEVTJywgW1wiYmFyY2hhcnRcIiwgXCJwaWVjaGFydFwiLCBcInRvcFwiLCBcInN1bVwiXSlcblxuYXBwLmNvbnN0YW50KCdQSUVDSEFSVCcsIHsgXG4gICAgb3B0aW9uczoge1xuICAgICAgICBjaGFydDoge1xuICAgICAgICAgICAgdHlwZTogJ3BpZUNoYXJ0JyxcbiAgICAgICAgICAgIGhlaWdodDogNDUwLFxuICAgICAgICAgICAgeDogZnVuY3Rpb24oZCl7cmV0dXJuIGQua2V5WzBdO30sXG4gICAgICAgICAgICB5OiBmdW5jdGlvbihkKXtyZXR1cm4gZC54O30sXG4gICAgICAgICAgICBzaG93TGFiZWxzOiB0cnVlLFxuICAgICAgICAgICAgZG9udXQgOiB0cnVlLFxuICAgICAgICAgICAgcGFkQW5nbGUgOiAwLjAwLFxuICAgICAgICAgICAgY29ybmVyUmFkaXVzIDogMSxcbiAgICAgICAgICAgIHRyYW5zaXRpb25EdXJhdGlvbjogNTAwLFxuICAgICAgICAgICAgbGFiZWxUaHJlc2hvbGQ6IDAsXG4gICAgICAgICAgICAvL2NvbG9yOiBbXCIjMGVjNGY0XCIsIFwiIzYzMUZGNlwiLCBcIiNGRkRDMDZcIiwgXCIjRkY4NDA2XCIsIFwiI2I1Njk2OVwiLCBcIiNlNmNmOGJcIl0sXG4gICAgICAgICAgICBsZWdlbmQ6IHtcbiAgICAgICAgICAgICAgICBtYXJnaW46IHtcbiAgICAgICAgICAgICAgICAgICAgdG9wOiA1LFxuICAgICAgICAgICAgICAgICAgICByaWdodDogMCxcbiAgICAgICAgICAgICAgICAgICAgYm90dG9tOiAwLFxuICAgICAgICAgICAgICAgICAgICBsZWZ0OiAwXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRvb2x0aXBDb250ZW50IDogZnVuY3Rpb24oa2V5LCB4LCB5LCBlLCBncmFwaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhrZXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGdyYXBoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdPbGFsYWxhISc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwaWUgOiB7XG4gICAgICAgICAgICAgICAgZGlzcGF0Y2g6IHtcbiAgICAgICAgICAgICAgICAgICAgLy9jaGFydENsaWNrOiBmdW5jdGlvbihlKSB7Y29uc29sZS5sb2coZSl9LFxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50Q2xpY2s6IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlLnNldFRpbWUoZGF0ZS5nZXRUaW1lKCkgLSAxMDAwKjYwKjYwKjI0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGUuc2V0SG91cnMoMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlLnNldE1pbnV0ZXMoMClcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9ICcjL2V2ZW50cz9maWx0ZXImZGF0ZT0nICsgZGF0ZS50b0lTT1N0cmluZygpICsgJyZmcm9tPScgKyBuZXcgRGF0ZSgpLmdldEhvdXJzKCkgKyAnOicgKyBuZXcgRGF0ZSgpLmdldE1pbnV0ZXMoKSArICcmY2F0ZWdvcnk9JyArIGUuZGF0YS5rZXlbMF19LFxuICAgICAgICAgICAgICAgICAgICAvL2VsZW1lbnREYmxDbGljazogZnVuY3Rpb24oZSkge2NvbnNvbGUubG9nKFwiZWxlbWVudCBkb3VibGUgY2xpY2tcIil9LFxuICAgICAgICAgICAgICAgICAgICAvL2VsZW1lbnRNb3VzZW92ZXI6IGZ1bmN0aW9uKGUpIHtjb25zb2xlLmxvZyhcImVsZW1lbnQgbW91c2VvdmVyXCIpfSxcbiAgICAgICAgICAgICAgICAgICAgLy9lbGVtZW50TW91c2VvdXQ6IGZ1bmN0aW9uKGUpIHtjb25zb2xlLmxvZyhcImVsZW1lbnQgbW91c2Ugb3V0XCIpfSAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbGFiZWxUeXBlIDogXCJwZXJjZW50XCIsXG4gICAgICAgICAgICAgICAgbGFiZWxzT3V0c2lkZSA6IHRydWUsXG4gICAgICAgICAgICAgICAgLy9zdGFydEFuZ2xlIDogZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5zdGFydEFuZ2xlLzIgLU1hdGguUEkvMiB9LFxuICAgICAgICAgICAgICAgIC8vZW5kQW5nbGUgOiBmdW5jdGlvbihkKSB7IHJldHVybiBkLmVuZEFuZ2xlLzIgLU1hdGguUEkvMiB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuXG5hcHAuY29uc3RhbnQoJ0FSRUEnLCB7XG4gICAgb3B0aW9ucyA6IHtcbiAgICAgICAgY2hhcnQ6IHtcbiAgICAgICAgICAgIHR5cGU6ICdtdWx0aUJhckNoYXJ0JyxcbiAgICAgICAgICAgIGhlaWdodDogNDUwLFxuICAgICAgICAgICAgbWFyZ2luIDoge1xuICAgICAgICAgICAgICAgIHRvcDogMzAsXG4gICAgICAgICAgICAgICAgcmlnaHQ6IDIwLFxuICAgICAgICAgICAgICAgIGJvdHRvbTogMTAwLFxuICAgICAgICAgICAgICAgIGxlZnQ6IDUwXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgeDogZnVuY3Rpb24oZCkgeyByZXR1cm4gZC54IH0sXG4gICAgICAgICAgICB5OiBmdW5jdGlvbihkKSB7IHJldHVybiBkLkNvdW50IH0sXG4gICAgICAgICAgICB1c2VWb3Jvbm9pOiBmYWxzZSxcbiAgICAgICAgICAgIGNsaXBFZGdlOiB0cnVlLFxuICAgICAgICAgICAgZHVyYXRpb246IDEwMCxcbiAgICAgICAgICAgIHVzZUludGVyYWN0aXZlR3VpZGVsaW5lOiB0cnVlLFxuICAgICAgICAgICAgeEF4aXM6IHtcbiAgICAgICAgICAgICAgICBzaG93TWF4TWluOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB0aWNrRm9ybWF0OiBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkMy50aW1lLmZvcm1hdCgnJW0vJWQgJUg6JU0nKShuZXcgRGF0ZShkKSlcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHJvdGF0ZUxhYmVscyA6IC00NSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB5QXhpczoge1xuICAgICAgICAgICAgICAgIHRpY2tGb3JtYXQ6IGZ1bmN0aW9uKGQpe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZDMuZm9ybWF0KCcsLjBmJykoZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHpvb206IHtcbiAgICAgICAgICAgICAgICBlbmFibGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIC8vc2NhbGVFeHRlbnQ6IFsxLCAxMF0sXG4gICAgICAgICAgICAgICAgdXNlRml4ZWREb21haW46IGZhbHNlLFxuICAgICAgICAgICAgICAgIHVzZU5pY2VTY2FsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgaG9yaXpvbnRhbE9mZjogZmFsc2UsXG4gICAgICAgICAgICAgICAgdmVydGljYWxPZmY6IHRydWUsXG4gICAgICAgICAgICAgICAgdW56b29tRXZlbnRUeXBlOiAnZGJsY2xpY2suem9vbSdcbiAgICAgICAgICAgIH0sIFxuICAgICAgICAgICAgZGlzcGF0Y2g6IHtcbiAgICAgICAgICAgICAgICBzdGF0ZUNoYW5nZTogZnVuY3Rpb24oZSl7IGNvbnNvbGUubG9nKFwic3RhdGVDaGFuZ2VcIik7IH0sXG4gICAgICAgICAgICAgICAgY2hhbmdlU3RhdGU6IGZ1bmN0aW9uKGUpeyBjb25zb2xlLmxvZyhcImNoYW5nZVN0YXRlXCIpOyB9LFxuICAgICAgICAgICAgICAgIHRvb2x0aXBTaG93OiBmdW5jdGlvbihlKXsgY29uc29sZS5sb2coXCJ0b29sdGlwU2hvd1wiKTsgfSxcbiAgICAgICAgICAgICAgICB0b29sdGlwSGlkZTogZnVuY3Rpb24oZSl7IGNvbnNvbGUubG9nKFwidG9vbHRpcEhpZGVcIik7IH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtdWx0aWJhcjoge1xuICAgICAgICAgICAgICAgIGRpc3BhdGNoIDoge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50Q2xpY2s6IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoZS5kYXRhLngpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBob3VycyA9IGRhdGUuZ2V0SG91cnMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtaW51dGVzID0gZGF0ZS5nZXRNaW51dGVzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlLnNldEhvdXJzKDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZS5zZXRNaW51dGVzKDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uID0gJyMvZXZlbnRzP2ZpbHRlciZkYXRlPScgKyBkYXRlLnRvSVNPU3RyaW5nKCkgKyAnJmZyb209JyArIChcIjBcIiArIGhvdXJzKS5zbGljZSgtMikgKyAnOicgKyAoXCIwXCIgKyBtaW51dGVzKS5zbGljZSgtMikgKyAnJmNhdGVnb3J5PScgKyBlLmRhdGEua2V5O1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhlLmRhdGEua2V5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coZS5kYXRhLngpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSk7XG5cblxuXG5hcHAuY29uc3RhbnQoXCJNRU5VXCIsIFtcblx0e1xuXHRcdFwidGl0bGVcIiA6IFwiRGFzaGJvYXJkXCIsXG4gICAgICAgIFwibGlua1wiIDogXCIjL1wiXG5cdFx0LypcIml0ZW1zXCIgOiBbXG5cdFx0XHR7XG5cdFx0XHRcdFwidGl0bGVcIiA6IFwiVXNlcnNcIixcblx0XHRcdFx0XCJsaW5rXCJcdDogXCJ1c2VyXCJcblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdFwidGl0bGVcIiA6IFwiTXkgcHJvZmlsZVwiXG5cdFx0XHR9XG5cdFx0XSovXG5cdH0sXG5cdHtcblx0XHRcInRpdGxlXCIgOiBcIkV2ZW50c1wiLFxuXHRcdFwibGlua1wiIFx0OiBcIiMvZXZlbnRzXCJcblx0fSxcblx0Lyp7XG5cdFx0XCJ0aXRsZVwiIDogXCJBbmFseXRpY3MyM1wiLFxuXHRcdFwiaXRlbXNcIiA6IFtcblx0XHRcdHtcblx0XHRcdFx0XCJ0aXRsZVwiIDogXCJVc2Vyc1wiLFxuXHRcdFx0XHRcImxpbmtcIiBcdDogXCJzZXR0aW5nc1wiXG5cdFx0XHR9LFxuXHRcdFx0e1xuXHRcdFx0XHRcInRpdGxlXCIgOiBcIk15IHByb2ZpbGVcIixcblx0XHRcdFx0XCJsaW5rXCJcdDogXCJwcm9maWxlXCJcblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdFwidGl0bGVcIiA6IFwiTXkgcHJvZmlsZVwiLFxuXHRcdFx0XHRcImxpbmtcIlx0OiBcInByb2ZpbGVcIlxuXHRcdFx0fVxuXHRcdF1cblxuXHR9LFxuXHR7XG5cdFx0XCJ0aXRsZVwiIDogXCJBbmFseXRpY3MxMjNcIixcblx0XHRcImxpbmtcIiBcdDogXCJsb2dpblwiXG5cdH0sKi9cblx0e1xuXHRcdFwidGl0bGVcIiA6IFwiU2V0dGluZ3NcIixcblx0XHRcIml0ZW1zXCIgOiBbXG4gICAgICAgICAgICB7XG5cdFx0XHRcdFwidGl0bGVcIiA6IFwiTXkgcHJvZmlsZVwiLFxuXHRcdFx0XHRcImxpbmtcIlx0OiBcIiMvcHJvZmlsZVwiXG5cdFx0XHR9LFxuXHRcdFx0e1xuXHRcdFx0XHRcInRpdGxlXCIgOiBcIlVzZXJzXCIsXG5cdFx0XHRcdFwibGlua1wiIFx0OiBcIi9zZXR0aW5nc1wiXG5cdFx0XHR9LFxuXHRcdF1cblx0fVxuXSk7XG4iLCJhcHAuc2VydmljZSgnYXBpJywgZnVuY3Rpb24oJGh0dHAsICRsb2csICRtZFRvYXN0LCAkbG9jYWxTdG9yYWdlLCBQSUVDSEFSVCwgQ09ORklHKSB7XG5cblx0dmFyIGFkZHIgPSBDT05GSUdbXCJob3N0XCJdICsgXCI6XCIgKyBDT05GSUdbXCJwb3J0XCJdICsgXCIvXCIgKyBDT05GSUdbXCJ2ZXJzaW9uXCJdICsgXCIvZXZlbnRzL1wiO1xuXG4gICAgdGhpcy5hdXRoID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAkbG9jYWxTdG9yYWdlW1widG9rZW5cIl07XG4gICAgfVxuXG4gICAgdGhpcy5jb25maWcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgJGh0dHAuZ2V0KCdodHRwOi8vYmVuZWZpemlvLmxpYmVyb3V0ZXIub3JnOjU1NTUvY29uZmlnJykuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICB0aGlzLmFkZHIgPSBkYXRhLmhvc3QgKyAnOicgKyBkYXRhLnBvcnQgKyBkYXRhLmV2ZW50cztcbiAgICAgICAgICAgICRsb2NhbFN0b3JhZ2VbJ2NvbmZpZyddID0gZGF0YTtcbiAgICAgICAgICAgIGFsZXJ0KGRhdGEpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICB0aGlzLmdldCA9IGZ1bmN0aW9uKHVybCwgcGFyYW1zLCBpbmZvKSB7XG5cdFx0cmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIHVybCA6IGFkZHIgKyB1cmwsXG4gICAgICAgICAgICBtZXRob2QgOiBcIkdFVFwiLFxuICAgICAgICAgICAgcGFyYW1zIDogcGFyYW1zLFxuICAgICAgICAgICAgaGVhZGVycyA6IHtcbiAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbicgOiB0aGlzLmF1dGgoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICBpZiAoaW5mbyAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxuICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdFxuICAgICAgICAgICAgICAgICAgICAgICAgLnNpbXBsZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQoJ0RhdGEgc3VjY2Vzc3VsbHkgbG9hZGVkJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wb3NpdGlvbihcInRvcCByaWdodFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmhpZGVEZWxheSgzMDAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW1lKFwic3VjY2Vzcy10b2FzdFwiKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICB9KVxuICAgICAgICAuZXJyb3IoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkbG9nLmVycm9yKCdDYW5ub3QgZmV0Y2ggZGF0YScpO1xuICAgICAgICAgICAgJG1kVG9hc3Quc2hvdyhcbiAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaW1wbGUoKVxuICAgICAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQoJ1NvbWV0aGluZyB3ZW50IHdyb25nJylcbiAgICAgICAgICAgICAgICAgICAgLnBvc2l0aW9uKFwidG9wIHJpZ2h0XCIpXG4gICAgICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoMzAwMClcbiAgICAgICAgICAgICAgICAgICAgLnRoZW1lKFwiZXJyb3ItdG9hc3RcIilcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgdGhpcy5wb3N0ID0gZnVuY3Rpb24odXJsLCBkYXRhLCBpbmZvKSB7XG4gICAgICAgIHJldHVybiAkaHR0cC5wb3N0KGFkZHIgKyB1cmwsIEpTT04uc3RyaW5naWZ5KGRhdGEpKVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmIChpbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgICRtZFRvYXN0LnNob3coXG4gICAgICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zaW1wbGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0Q29udGVudCgnRGF0YSBzdWNjZXNzZnVsbHkgbG9hZGVkJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucG9zaXRpb24oXCJ0b3AgcmlnaHRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaGlkZURlbGF5KDMwMDApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW1lKFwic3VjY2Vzcy10b2FzdFwiKVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTsgICAgICAgIFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIFx0JGxvZy5lcnJvcignQ2Fubm90IGZldGNoIGRhdGEnKTtcbiAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxuICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaW1wbGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRleHRDb250ZW50KCdTb21ldGhpbmcgd2VudCB3cm9uZycpXG4gICAgICAgICAgICAgICAgICAgICAgICAucG9zaXRpb24oXCJ0b3AgcmlnaHRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoMzAwMClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVtZShcImVycm9yLXRvYXN0XCIpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pXG4gICAgfVxuXG4gICAgdGhpcy5wdXQgPSBmdW5jdGlvbih1cmwsIGRhdGEsIGluZm8pIHtcbiAgICAgICAgcmV0dXJuICRodHRwLnB1dChhZGRyICsgdXJsLCBKU09OLnN0cmluZ2lmeShkYXRhKSlcbiAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBpZiAoaW5mbykge1xuICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxuICAgICAgICAgICAgICAgICAgICAgICAgJG1kVG9hc3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2ltcGxlKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQoJ0RhdGEgc3VjY2Vzc2Z1bGx5IGxvYWRlZCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnBvc2l0aW9uKFwidG9wIHJpZ2h0XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmhpZGVEZWxheSgzMDAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVtZShcInN1Y2Nlc3MtdG9hc3RcIilcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7ICAgICAgICBcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBcdCRsb2cuZXJyb3IoJ0Nhbm5vdCBmZXRjaCBkYXRhJyk7XG4gICAgICAgICAgICAgICAgJG1kVG9hc3Quc2hvdyhcbiAgICAgICAgICAgICAgICAgICAgJG1kVG9hc3Quc2ltcGxlKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0Q29udGVudCgnU29tZXRoaW5nIHdlbnQgd3JvbmcnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnBvc2l0aW9uKFwidG9wIHJpZ2h0XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuaGlkZURlbGF5KDMwMDApXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbWUoXCJlcnJvci10b2FzdFwiKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KVxuICAgIH1cblxuXG59KTtcblxuXG4iLCJhcHAuc2VydmljZSgndXNlcicsIGZ1bmN0aW9uKCRsb2NhbFN0b3JhZ2UsICRodHRwLCAkbWRUb2FzdCwgJGxvY2F0aW9uLCBDT05GSUcpe1xuICAgIHZhciBjYWNoZSA9IG51bGw7XG5cbiAgICB2YXIgZGFzaGJvYXJkID0gW107XG5cblx0dmFyIGFkZHIgPSBDT05GSUdbXCJob3N0XCJdICsgXCI6XCIgKyBDT05GSUdbXCJwb3J0XCJdICsgXCIvXCIgKyBDT05GSUdbXCJ2ZXJzaW9uXCJdICsgXCIvdXNlcnMvXCI7XG5cbiAgICB0aGlzLmNvbmZpZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gJGxvY2FsU3RvcmFnZVtcImRhc2hib2FyZFwiXTtcbiAgICB9XG5cbiAgICB0aGlzLmp3dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gJGxvY2FsU3RvcmFnZVtcImp3dFwiXTtcbiAgICB9XG5cbiAgICB0aGlzLmF1dGggPSBmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgIHJldHVybiAkaHR0cC5wb3N0KGFkZHIgKyBcImF1dGhcIiwgYW5ndWxhci50b0pzb24odXNlcikpXG4gICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICRsb2NhbFN0b3JhZ2VbXCJ0b2tlblwiXSA9IGRhdGFbXCJqd3RcIl07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFRPRE86IGRpZmZlcmVudGlhdGUgYmV0d2VlbiBjb25maWcgYW5kIGp3dCA+PiBkdXBsaWNpdHlcbiAgICAgICAgICAgIGRlbGV0ZSAkbG9jYWxTdG9yYWdlW1wiZGFzaGJvYXJkXCJdO1xuICAgICAgICAgICAgJGxvY2FsU3RvcmFnZVtcImRhc2hib2FyZFwiXSA9IGRhdGFbXCJzZXR0aW5nc1wiXTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSlcbiAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGVycm9yLCBzdGF0dXMpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHN0YXR1cylcbiAgICAgICAgICAgIC8vIExldCBpdCBiZSBoYW5kbGVkIGJ5IGNvbnRyb2xsZXJcbiAgICAgICAgICAgIHJldHVybiBlcnJvcjtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICB0aGlzLnB1dCA9IGZ1bmN0aW9uKGRhdGEsIGluZm8pIHtcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIHVybCA6IGFkZHIsIFxuICAgICAgICAgICAgbWV0aG9kIDogXCJQVVRcIixcbiAgICAgICAgICAgIGRhdGEgOiBhbmd1bGFyLnRvSnNvbihkYXRhKSxcbiAgICAgICAgICAgIGhlYWRlcnMgOiB7XG4gICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nIDogJGxvY2FsU3RvcmFnZVtcInRva2VuXCJdXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmIChpbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgICRtZFRvYXN0LnNob3coXG4gICAgICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zaW1wbGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0Q29udGVudCgnVXNlciBzZXR0aW5ncyB1cGRhdGVkJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucG9zaXRpb24oXCJ0b3AgcmlnaHRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaGlkZURlbGF5KDMwMDApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW1lKFwic3VjY2Vzcy10b2FzdFwiKVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTsgICAgICAgIFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihtc2csIHN0YXR1cykge1xuICAgICAgICAgICAgXHQkbG9nLmVycm9yKCdTb21ldGhpbmcgd2VudCB3cm9uZyBzZW5kaW5nIHVzZXIgZGF0YScpO1xuICAgICAgICAgICAgICAgICRtZFRvYXN0LnNob3coXG4gICAgICAgICAgICAgICAgICAgICRtZFRvYXN0LnNpbXBsZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQoJ1NvbWV0aGluZyB3ZW50IHdyb25nJylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wb3NpdGlvbihcInRvcCByaWdodFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmhpZGVEZWxheSgzMDAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW1lKFwiZXJyb3ItdG9hc3RcIilcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSlcbiAgICB9XG4gICAgXG4gICAgLy8gTG9nb3V0IHVzZXJcbiAgICAvLyBSZW1vdmUgSldUIGZyb20gbG9jYWxTdG9yYWdlIGFuZCBkZWxldGUgc2Vzc2lvbiBvbiBzZXJ2ZXJcbiAgICB0aGlzLmxvZ291dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdXNlciA9ICRsb2NhbFN0b3JhZ2VbXCJ0b2tlblwiXTtcblxuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgdXJsIDogYWRkciArIFwibG9nb3V0XCIsXG4gICAgICAgICAgICBtZXRob2QgOiBcIkRFTEVURVwiLFxuICAgICAgICAgICAgaGVhZGVycyA6IHtcbiAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbicgOiAkbG9jYWxTdG9yYWdlW1widG9rZW5cIl1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2xvZ2luXCIpO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSAkbG9jYWxTdG9yYWdlW1widG9rZW5cIl07XG4gICAgICAgICAgICAgICAgZGVsZXRlICRsb2NhbFN0b3JhZ2VbXCJkYXNoYm9hcmRcIl07XG4gICAgICAgICAgICAgICAgJG1kVG9hc3Quc2hvdyhcbiAgICAgICAgICAgICAgICAgICAgJG1kVG9hc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zaW1wbGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRleHRDb250ZW50KCdMb2dvdXQgc3VjY2Vzc2Z1bGwnKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnBvc2l0aW9uKFwidG9wIHJpZ2h0XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuaGlkZURlbGF5KDMwMDApXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICByZXR1cm47ICAgICAgICBcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZXJyb3IsIG1zZykge1xuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKFwiL2xvZ2luXCIpO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSAkbG9jYWxTdG9yYWdlW1widG9rZW5cIl07XG4gICAgICAgICAgICAgICAgZGVsZXRlICRsb2NhbFN0b3JhZ2VbXCJkYXNoYm9hcmRcIl07XG4gICAgICAgICAgICAgICAgJG1kVG9hc3Quc2hvdyhcbiAgICAgICAgICAgICAgICAgICAgJG1kVG9hc3RcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zaW1wbGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRleHRDb250ZW50KCdMb2dvdXQgZmFpbGVkIG9uIHNlcnZlciBzaWRlLCBidXQgeW91IGFyZSBsb2dnZWQgb3V0JylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wb3NpdGlvbihcInRvcCByaWdodFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmhpZGVEZWxheSgzMDAwKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbn0pO1xuIiwiYXBwLmNvbnRyb2xsZXIoJ2V2ZW50Q29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJHJvdXRlUGFyYW1zLCAkaHR0cCwgYXBpKSB7XG5cbiAgICAgICAgJHNjb3BlLmlkID0gJHJvdXRlUGFyYW1zO1xuXG4gICAgICAgICRzY29wZS5nZW8gPSBbXTtcblxuICAgICAgICAkc2NvcGUuYmFjayA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgd2luZG93Lmhpc3RvcnkuYmFjaygpXG4gICAgICAgIH1cblxuICAgICAgICBhcGkuZ2V0KCdpZC8nICsgJHJvdXRlUGFyYW1zWydpZCddKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICRzY29wZS5kYXRhID0gZGF0YTtcblxuICAgICAgICAgICAgLy92YXIgYm91bmRzID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZ0JvdW5kcygpO1xuXG4gICAgICAgICAgICBpZiAoKCRzY29wZS5kYXRhLlNvdXJjZSAhPSB1bmRlZmluZWQgJiYgJHNjb3BlLmRhdGEuVGFyZ2V0ICE9IHVuZGVmaW5lZCkgJiYgXG4gICAgICAgICAgICAgICAgKCRzY29wZS5kYXRhLlNvdXJjZVswXS5JUDQgJiYgJHNjb3BlLmRhdGEuVGFyZ2V0WzBdLklQNCkpIHtcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQoJ2h0dHA6Ly9mcmVlZ2VvaXAubmV0L2pzb24vJyArICRzY29wZS5kYXRhLlRhcmdldFswXS5JUDRbMF0pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgZGF0YVsndHlwZSddID0gXCJUYXJnZXRcIjtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdlby5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAvL3ZhciBsYXRsbmcgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGRhdGEubGF0aXR1ZGUsIGRhdGEubG9uZ2l0dWRlKTtcbiAgICAgICAgICAgICAgICAgICAgLy9ib3VuZHMuZXh0ZW5kKGxhdGxuZyk7XG5cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICRodHRwLmdldCgnaHR0cDovL2ZyZWVnZW9pcC5uZXQvanNvbi8nICsgJHNjb3BlLmRhdGEuU291cmNlWzBdLklQNFswXSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGFbJ3R5cGUnXSA9IFwiU291cmNlXCI7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nZW8ucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgLy92YXIgbGF0bG5nID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhkYXRhLmxhdGl0dWRlLCBkYXRhLmxvbmdpdHVkZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vYm91bmRzLmV4dGVuZChsYXRsbmcpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICgkc2NvcGUuZGF0YS5Tb3VyY2UgPT0gdW5kZWZpbmVkIHx8ICRzY29wZS5kYXRhLlNvdXJjZVswXS5JUDQgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KCdodHRwOi8vZnJlZWdlb2lwLm5ldC9qc29uLycgKyAkc2NvcGUuZGF0YS5UYXJnZXRbMF0uSVA0WzBdKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YVsndHlwZSddID0gXCJUYXJnZXRcIjtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdlby5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRodHRwLmdldCgnaHR0cDovL2ZyZWVnZW9pcC5uZXQvanNvbi8nICsgJHNjb3BlLmRhdGEuU291cmNlWzBdLklQNFswXSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGFbJ3R5cGUnXSA9IFwiU291cmNlXCI7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nZW8ucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICBcblxufSk7XG5cbmFwcC5maWx0ZXIoJ2pzb24yaHRtbCcsIGZ1bmN0aW9uKCRzY2UsICRmaWx0ZXIpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oaW5wdXQpIHtcbiAgICAgICAgdmFyIGh0bWwgPSBcIlwiXG4gICAgICAgIGFuZ3VsYXIuZm9yRWFjaChpbnB1dCwgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAgICAgICAgaHRtbCA9IGh0bWwgKyBcIjxkaXY+XCI7XG5cbiAgICAgICAgICAgIC8vIFRoZSB0dXBsZSBpcyBuZXN0ZWRcbiAgICAgICAgICAgIGlmICgodHlwZW9mIHZhbHVlKSA9PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgIGlmICgodHlwZW9mIGtleSkgIT0gJ251bWJlcicgJiYga2V5ICE9IFwiJGRhdGVcIilcbiAgICAgICAgICAgICAgICAgICAgaHRtbCA9IGh0bWwgKyBcIjxlbT5cIiArIGtleSArIFwiPC9lbT46IFwiO1xuICAgICAgICAgICAgICAgIGh0bWwgPSBodG1sICsgXCI8ZGl2IGNsYXNzPVxcXCJzdWJcXFwiPlwiICsgJGZpbHRlcignanNvbjJodG1sJykodmFsdWUpICsgXCI8L2Rpdj5cIjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKCh0eXBlb2Yga2V5ICE9ICdudW1iZXInKSAmJiBrZXkgIT0gXCIkZGF0ZVwiKVxuICAgICAgICAgICAgICAgICAgICBodG1sID0gaHRtbCArIFwiPGVtPlwiICsga2V5ICsgXCI8L2VtPjogXCI7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgaXQgaXMgZGF0ZSAoSSBrbm93LCBpdCBpcyBzb29vb28gZGlydHkpXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlID4gMTAwMDAwMDAwMDAwMClcbiAgICAgICAgICAgICAgICAgICAgaHRtbCA9IGh0bWwgKyBcIjxzcGFuPlwiICsgJGZpbHRlcignZGF0ZScpKHZhbHVlLCd5eXl5L01NL2RkIEg6bW06c3MnKSArIFwiPC9zcGFuPlwiO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgaHRtbCA9IGh0bWwgKyBcIjxzcGFuPlwiICsgdmFsdWUgKyBcIjwvc3Bhbj5cIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGh0bWwgPSBodG1sICsgXCI8L2Rpdj5cIjtcbiAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuICRzY2UudHJ1c3RBcygnaHRtbCcsIGh0bWwpO1xuICAgIH0gICAgIFxufSk7XG5cbi8vIEZpbHRlciB0byBjb252ZXJ0IElERUEgZm9ybWF0IGZyb20gTW9uZ29EQiB0byBzdGFuZGFyZGl6ZWQgSURFQSBmb3JtYXRcbmFwcC5maWx0ZXIoJ2lkZWEnLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oaW5wdXQpIHtcbiAgICAgICAgdmFyIHJlcyA9IHt9O1xuXG4gICAgICAgIGFuZ3VsYXIuZm9yRWFjaChpbnB1dCwgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAgICAgICAgaWYgKGtleSAhPSAnX2lkJykge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZVsnJGRhdGUnXSkge1xuICAgICAgICAgICAgICAgICAgICByZXNba2V5XSA9IG5ldyBEYXRlKHZhbHVlWyckZGF0ZSddKS50b0lTT1N0cmluZygpLnNsaWNlKDAsMTkpICsgJ1onO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cbn0pO1xuIiwiYXBwLmNvbnRyb2xsZXIoJ2V2ZW50c0NvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkbG9jYXRpb24sIGFwaSkge1xuICAgICRzY29wZS5maWx0ZXIgPSB7XG4gICAgICAgIFwiY2F0ZWdvcnlcIiA6IFwiXCIsICAgIC8vIENhdGVnb3J5XG4gICAgICAgIFwic3JjX2lwXCIgOiBcIlwiLCAgICAgIC8vIFNvdXJjZSBJUFxuICAgICAgICBcInRydF9pcFwiIDogXCJcIiwgICAgICAvLyBUYXJnZXQgSVBcbiAgICAgICAgXCJkZXNjXCIgOiBcIlwiLCAgICAgICAgLy8gRGVzY3JpcHRpb25cbiAgICAgICAgXCJmbG93c19mcm9tXCIgOiBcIlwiLCAgLy8gRmxvd0NvdW50XG4gICAgICAgIFwiZmxvd3NfdG9cIiA6IFwiXCIsICAgIC8vIEZsb3dDb3VudFxuICAgICAgICBcIml0ZW1zXCIgOiAxMDAsICAgICAgLy8gTGltaXQgbnVtYmVyIG9mIGRpc3BsYXllZCBpdGVtc1xuICAgIH07XG4gICAgJHNjb3BlLnF1ZXJ5ID0ge1xuICAgICAgICBcImZyb21cIiA6IFwiXCIsXG4gICAgICAgIFwidG9cIiA6IFwiXCIsXG4gICAgICAgIFwiZGF0ZVwiIDogbmV3IERhdGUoKSxcbiAgICAgICAgXCJkZXNjcmlwdGlvblwiIDogXCJcIixcbiAgICAgICAgXCJjYXRlZ29yeVwiIDogXCJcIixcbiAgICAgICAgXCJsaW1pdFwiIDogMTAwXG4gICAgfVxuXG4gICAgJHNjb3BlLmRhdGEgPSBbXTtcbiAgICAkc2NvcGUubG9hZGJ0biA9IFwiTG9hZFwiO1xuICAgIGNvbnNvbGUubG9nKCRzY29wZS5xdWVyeS5kYXRlKVxuXG4gICAgJHNjb3BlLmxvYWRJdGVtcyA9IGZ1bmN0aW9uKHF1ZXJ5KSB7XG4gICAgICAgICRzY29wZS5sb2FkYnRuID0gXCJMb2FkaW5nLi4uXCI7XG4gICAgICAgIHZhciBmcm9tID0gcXVlcnkuZnJvbS5zcGxpdCgnOicpO1xuICAgICAgICB2YXIgZnJvbV9kYXRlID0gbmV3IERhdGUocXVlcnkuZGF0ZSk7XG4gICAgICAgIGZyb21fZGF0ZS5zZXRIb3Vycyhmcm9tX2RhdGUuZ2V0SG91cnMoKSArIGZyb21bMF0pO1xuICAgICAgICBmcm9tX2RhdGUuc2V0TWludXRlcyhmcm9tWzFdKTtcbiAgICAgICAgXG4gICAgICAgICRsb2NhdGlvbi5zZWFyY2goJ2ZpbHRlcicsIHRydWUpO1xuICAgICAgICAkbG9jYXRpb24uc2VhcmNoKCdmcm9tJywgcXVlcnkuZnJvbSk7XG4gICAgICAgICRsb2NhdGlvbi5zZWFyY2goJ2RhdGUnLCBxdWVyeS5kYXRlKTtcbiAgICAgICAgJGxvY2F0aW9uLnNlYXJjaCgnbGltaXQnLCBxdWVyeS5saW1pdCk7XG4gICAgICAgIFxuXG4gICAgICAgIGlmIChxdWVyeS50bykge1xuICAgICAgICAgICAgdmFyIHRvID0gcXVlcnkudG8uc3BsaXQoJzonKTtcbiAgICAgICAgICAgIHZhciB0b19kYXRlID0gbmV3IERhdGUocXVlcnkuZGF0ZSk7XG4gICAgICAgICAgICB0b19kYXRlLnNldEhvdXJzKHRvX2RhdGUuZ2V0SG91cnMoKSArIHRvWzBdKTtcbiAgICAgICAgICAgIHRvX2RhdGUuc2V0TWludXRlcyh0b1sxXSk7XG4gICAgICAgICAgICAkbG9jYXRpb24uc2VhcmNoKCd0bycsIHF1ZXJ5LnRvKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciB0b19kYXRlID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHF1ZXJ5LmRlc2NyaXB0aW9uICE9IFwiXCIpIHtcbiAgICAgICAgICAgICRsb2NhdGlvbi5zZWFyY2goJ2Rlc2NyaXB0aW9uJywgcXVlcnkuZGVzY3JpcHRpb24pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcXVlcnkuZGVzY3JpcHRpb24gPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHF1ZXJ5LmNhdGVnb3J5ICE9IFwiXCIpIHtcbiAgICAgICAgICAgICRsb2NhdGlvbi5zZWFyY2goJ2NhdGVnb3J5JywgcXVlcnkuY2F0ZWdvcnkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcXVlcnkuY2F0ZWdvcnkgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHNlbmQgPSB7XG4gICAgICAgICAgICBcImZyb21cIiA6IGZyb21fZGF0ZSxcbiAgICAgICAgICAgIFwidG9cIiA6IHRvX2RhdGUsXG4gICAgICAgICAgICBcImNhdGVnb3J5XCIgOiBxdWVyeS5jYXRlZ29yeSxcbiAgICAgICAgICAgIFwiZGVzY3JpcHRpb25cIiA6IHF1ZXJ5LmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgXCJsaW1pdFwiIDogcXVlcnkubGltaXRcbiAgICAgICAgfVxuICAgICAgICBhcGkuZ2V0KCdxdWVyeScsIHNlbmQsIHRydWUpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuXHRcdFx0JHNjb3BlLmRhdGEgPSBkYXRhO1xuICAgICAgICAgICAgJHNjb3BlLmxvYWRidG4gPSBcIkxvYWRcIlxuXHQgICAgfSkuZXJyb3IoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkc2NvcGUubG9hZGJ0biA9IFwiTG9hZFwiOyAgICBcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIGlmICgkbG9jYXRpb24uc2VhcmNoKCkuZmlsdGVyKSB7XG4gICAgICAgICRzY29wZS5xdWVyeSA9ICRsb2NhdGlvbi5zZWFyY2goKTtcbiAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLnF1ZXJ5LmRhdGUpXG4gICAgICAgICRzY29wZS5xdWVyeS5kYXRlID0gbmV3IERhdGUoJHNjb3BlLnF1ZXJ5LmRhdGUpO1xuICAgICAgICAkc2NvcGUubG9hZEl0ZW1zKCRzY29wZS5xdWVyeSk7XG4gICAgfSBlbHNlIHtcblxuICAgICAgICBhcGkuZ2V0KFwiMTAwXCIpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgJHNjb3BlLmRhdGEgPSBkYXRhO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAkc2NvcGUuZXZlbnRzID0gZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICB2YXIgcmVzID0gW107XG4gICAgICAgIGlmICgkc2NvcGUuZmlsdGVyLnNyY19pcCAhPSBcIlwiKXtcbiAgICAgICAgICAgIGlmIChcIlNvdXJjZVwiIGluIGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBpZiAoXCJJUDRcIiBpbiBpdGVtLlNvdXJjZVswXSAmJiBpdGVtLlNvdXJjZVswXS5JUDRbMF0udG9Mb3dlckNhc2UoKS5pbmRleE9mKCRzY29wZS5maWx0ZXIuc3JjX2lwLnRvTG93ZXJDYXNlKCkpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzLnB1c2goMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgcmVzLnB1c2goMCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlcy5wdXNoKDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCRzY29wZS5maWx0ZXIudHJ0X2lwICE9IFwiXCIpe1xuICAgICAgICAgICAgaWYgKFwiVGFyZ2V0XCIgaW4gaXRlbSkge1xuICAgICAgICAgICAgICAgIGlmIChcIklQNFwiIGluIGl0ZW0uVGFyZ2V0WzBdICYmIGl0ZW0uVGFyZ2V0WzBdLklQNFswXS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJHNjb3BlLmZpbHRlci50cnRfaXAudG9Mb3dlckNhc2UoKSkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXMucHVzaCgxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICByZXMucHVzaCgwKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzLnB1c2goMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCRzY29wZS5maWx0ZXIuY2F0ZWdvcnkgIT0gXCJcIikge1xuICAgICAgICAgICAgaWYgKGl0ZW0uQ2F0ZWdvcnlbMF0udG9Mb3dlckNhc2UoKS5pbmRleE9mKCRzY29wZS5maWx0ZXIuY2F0ZWdvcnkudG9Mb3dlckNhc2UoKSkgPiAtMSkge1xuICAgICAgICAgICAgICAgIHJlcy5wdXNoKDEpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXMucHVzaCgwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICgkc2NvcGUuZmlsdGVyLmRlc2MgIT0gXCJcIikge1xuICAgICAgICAgICAgaWYgKGl0ZW0uRGVzY3JpcHRpb24udG9Mb3dlckNhc2UoKS5pbmRleE9mKCRzY29wZS5maWx0ZXIuZGVzYy50b0xvd2VyQ2FzZSgpKSA+IC0xKVxuICAgICAgICAgICAgICAgIHJlcy5wdXNoKDEpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHJlcy5wdXNoKDApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCRzY29wZS5maWx0ZXIuZmxvd3NfZnJvbSAhPSBcIlwiKSB7XG4gICAgICAgICAgICBpZiAoaXRlbS5GbG93Q291bnQgPiBOdW1iZXIoJHNjb3BlLmZpbHRlci5mbG93c19mcm9tKSlcbiAgICAgICAgICAgICAgICByZXMucHVzaCgxKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICByZXMucHVzaCgwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICgkc2NvcGUuZmlsdGVyLmZsb3dzX3RvICE9IFwiXCIpIHtcbiAgICAgICAgICAgIGlmIChpdGVtLkZsb3dDb3VudCA8IE51bWJlcigkc2NvcGUuZmlsdGVyLmZsb3dzX3RvKSlcbiAgICAgICAgICAgICAgICByZXMucHVzaCgxKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICByZXMucHVzaCgwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBsb2dpY3ZhbHVlID0gMTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGxvZ2ljdmFsdWUgPSBsb2dpY3ZhbHVlICogcmVzW2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsb2dpY3ZhbHVlID09IDEgPyB0cnVlIDogZmFsc2U7XG5cbiAgICB9XG5cbn0pO1xuXG5hcHAuZGlyZWN0aXZlKCd2YWxpZGF0ZUhvdXJzJywgZnVuY3Rpb24oKSB7XG4gICAgdmFyIHRvID0gW107XG4gICAgdmFyIGZyb20gPSBbXTtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXF1aXJlOiAnbmdNb2RlbCcsXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycywgY3RybCkge1xuICAgICAgICAgICAgY3RybC4kdmFsaWRhdG9ycy50aW1lID0gZnVuY3Rpb24obW9kZWxWYWx1ZSwgdmlld1ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGF0dHJzLm5nTW9kZWwgPT0gXCJxdWVyeS5mcm9tXCIgJiYgdmlld1ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGZyb20gPSB2aWV3VmFsdWUuc3BsaXQoJzonKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHZpZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB0byA9IHZpZXdWYWx1ZS5zcGxpdCgnOicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGZyb20pXG4gICAgICAgICAgICBjb25zb2xlLmxvZyh0bykgXG4gICAgICAgICAgICBpZiAodG8ubGVuZ3RoID09IDIgfHwgZnJvbS5sZW5ndGggPT0gMikge1xuICAgICAgICAgICAgICAgIGlmICh0b1swXSA8IGZyb21bMF0gfHwgKHRvWzBdIDw9IGZyb21bMF0gJiYgdG9bMV0gPCBmcm9tWzFdKSB8fFxuICAgICAgICAgICAgICAgICAgICB0b1swXSA8IDAgfHwgdG9bMF0gPiAyMyB8fCB0b1sxXSA8IDAgfHwgdG9bMV0gPiA1OSB8fCBmcm9tWzBdIDwgMCB8fCBmcm9tWzBdID4gMjMgfHwgZnJvbVsxXSA8IDAgfHwgZnJvbVsxXSA+IDU5XG4gICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSk7XG4iLCJhcHAuY29udHJvbGxlcignbG9naW5Db250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCAkbG9jYXRpb24sICRsb2csIHVzZXIpIHtcblx0JHNjb3BlLnRpdGxlID0gXCJMb2dpbiB0byBOZW1lYSBEYXNoYm9hcmRcIjtcblx0JHNjb3BlLmxvZ2luQnRuID0gXCJMb2dpblwiO1xuICAgIFxuICAgICRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbihjcmVkKSB7XG5cdFx0JHNjb3BlLmxvZ2luQnRuID0gXCJBdXRoZW50aWNhdGluZy4uLlwiO1xuICAgICAgICAkc2NvcGUubG9naW5CdG5EaXNhYmxlZCA9IHRydWU7XG5cbiAgICAgICAgdXNlci5hdXRoKGNyZWQpXG4gICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7ICAgIFxuICAgICAgICB9KVxuICAgICAgICAuZXJyb3IoZnVuY3Rpb24obXNnKSB7XG4gICAgICAgICAgICAkc2NvcGUuZXJyb3JfbWVzID0gbXNnO1xuICAgICAgICAgICAgJHNjb3BlLmxvZ2luQnRuID0gXCJMb2dpblwiXG4gICAgICAgICAgICAkc2NvcGUubG9naW5CdG5EaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICB9KVxuICAgIH1cblxuXHRcdFxuXHRcdC8qbG9naW5BdXRoLmZldGNoVXNlcih1c2VyKVxuXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcblxuXHRcdFx0JGxvZy5pbmZvKGRhdGEpO1xuXG5cdFx0XHRpZiAoZGF0YVtcInN1Y2Nlc3NcIl0gPT0gdHJ1ZSkge1xuXHRcdFx0XHQvLyRsb2cuaW5mbyhkYXRhKTtcdFxuXHRcdFx0XHQkc2NvcGUubG9naW5CdG4gPSBcIlN1Y2Nlc3NcIjtcblx0XHRcdFx0JGxvY2F0aW9uLnBhdGgoXCIvXCIpO1xuXHRcdFx0XHRsb2NhbFN0b3JhZ2VTZXJ2aWNlLnNldCgnbG9nZ2VkSW4nLCB0cnVlKTtcblx0XHRcdFx0bG9jYWxTdG9yYWdlU2VydmljZS5zZXQoJ2xvZ2dlZEluLnB3Jywgc2hhMjU2X2RpZ2VzdChkYXRhLnBhc3N3b3JkKSk7XHRcblx0XHRcdH1cblx0XHRcdGVsc2Uge1xuXHRcdFx0XHQkbG9nLmVycm9yKFwiZXJyb3IgLSBiYWQgcGFzc3dvcmRcIik7XG5cdFx0XHRcdCRzY29wZS5lcnJvcl9tZXMgPSBcIkJhZCBwYXNzd29yZFwiO1xuXHRcdFx0XHQkc2NvcGUubG9naW5CdG4gPSBcIkxvZ2luXCI7XG5cdFx0XHRcdGxvZ2luQ29ycmVjdCA9IGZhbHNlO1xuXHRcdFx0XHRsb2NhbFN0b3JhZ2VTZXJ2aWNlLnNldCgnbG9nZ2VkSW4nLCBmYWxzZSk7XHRcblx0XHRcdH1cblx0XHR9KTsqL1xufSk7XG5cblxuIiwiYXBwLmNvbnRyb2xsZXIoJ3Byb2ZpbGVDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlLCB1c2VyLCBhcGkpIHtcbiAgICAkc2NvcGUudXNlciA9IHVzZXIuY29uZmlnKCk7XG5cbiAgICAkc2NvcGUuZWRpdFVzZXIgPSBmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKHVzZXIpO1xuICAgIH1cbn0pXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
